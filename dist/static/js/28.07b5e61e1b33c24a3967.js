webpackJsonp([28],{"4Ey6":function(t,e){},A3m0:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("wtEF");var i=a("mtWM"),o=a.n(i),n=(a("9igS"),{name:"customeraddorupdate",data:function(){return{activeName:"first",tableData:null,tableData2:null,cusaddOrUpdateData:{},myForm:{poolName:null,address:null},industryTypeList:null,enterpriseScaleList:null,companyTypeList:null,operatingStateList:null,financingStateList:null,listedList:null,distributorList:null,cuesList:null,levelList:null,subData:{},industryId:null,companyId:null,operatingStateId:null,enterpriseScaleId:null,financingStateId:null,mapJson:"../../../../dist/static/map.json",Provinces:[],Citys:[],block:[],cityList:[],areaList:[],countryid:null,cityid:null,areaid:null,page:1,limit:15,selectData:null,tableNumber:null,rules:{poolName:[{required:!0,message:"公司名称不能为空",trigger:"blur"}],contactsName:[{required:!0,message:"联系人名称不能为空",trigger:"blur"}],phone:[{required:!0,message:"电话不能为空",trigger:"blur"}],levelsid:[{required:!0,message:"请选择客户分类",trigger:"blur"}],customerStateid:[{required:!0,message:"请选择客户来源",trigger:"blur"}]},isDisable:!1}},mounted:function(){this.loadData(),this.loadTable(),this.loadCountry(),this.loadinfo(),this.loadTable2()},methods:{loadCountry:function(){var t=this,e=a("1nuA"),i={};this.cityid&&(i.id=this.cityid,o()({method:"post",url:t.$store.state.defaultHttp+"address/getAddress.do",data:e.stringify(i)}).then(function(e){t.areaList=e.data}).catch(function(t){})),this.countryid&&(i.id=this.countryid,o()({method:"post",url:t.$store.state.defaultHttp+"address/getAddress.do",data:e.stringify(i)}).then(function(e){t.cityList=e.data}).catch(function(t){})),i.id="",o()({method:"post",url:t.$store.state.defaultHttp+"address/getAddress.do",data:e.stringify(i)}).then(function(e){t.Provinces=e.data}).catch(function(t){})},loadTable:function(){var t=this,e=a("1nuA"),i={};i.page=this.page,i.limit=this.limit,o()({method:"post",url:t.$store.state.defaultHttp+"customerOne/query.do",data:e.stringify(i)}).then(function(e){t.tableData=e.data.rows,t.tableNumber=e.data.total}).catch(function(t){}),o()({method:"get",url:t.$store.state.defaultHttp+"typeInfo/getTypeInfoByType.do?cId="+t.$store.state.iscId}).then(function(e){t.cuesList=e.data.name3001,t.levelList=e.data.name4001}).catch(function(t){}),o()({method:"get",url:t.$store.state.defaultHttp+"distributor/selectDistributor.do?cId="+t.$store.state.iscId}).then(function(e){t.distributorList=e.data.map.distributors}).catch(function(t){})},loadData:function(){var t=this;this.cusaddOrUpdateData=this.$store.state.cusaddOrUpdateData,this.countryid=this.cusaddOrUpdateData.setForm.country,this.cityid=this.cusaddOrUpdateData.setForm.city,this.areaid=this.cusaddOrUpdateData.setForm.area,this.industryId=this.cusaddOrUpdateData.setForm.industryId,this.companyId=this.cusaddOrUpdateData.setForm.companyId,this.operatingStateId=this.cusaddOrUpdateData.setForm.operatingStateId,this.enterpriseScaleId=this.cusaddOrUpdateData.setForm.enterpriseScaleId,this.financingStateId=this.cusaddOrUpdateData.setForm.financingStateId;var e=this.cusaddOrUpdateData.createForm,a=this.cusaddOrUpdateData.assistForm,i=this.cusaddOrUpdateData.orderForm,o=this.cusaddOrUpdateData.setForm;o&&(e.forEach(function(e,a){e.type&&"select"==e.type?t.$set(t.myForm,e.inputModel,o[e.inputModel]):e.type&&"radio"==e.type?t.$set(t.myForm,e.inputModel,o[e.inputModel]):t.myForm[e.inputModel]=o[e.inputModel]}),a.forEach(function(e,a){e.type&&"select"==e.type?t.$set(t.myForm,e.inputModel,o[e.inputModel]):e.type&&"radio"==e.type?t.$set(t.myForm,e.inputModel,o[e.inputModel]):e.type&&"date"==e.type?t.$set(t.myForm,e.inputModel,o[e.inputModel]):t.myForm[e.inputModel]=o[e.inputModel]}),i.forEach(function(e,a){e.type&&"select"==e.type?t.$set(t.myForm,e.inputModel,o[e.inputModel]):t.myForm[e.inputModel]=o[e.inputModel]}),this.myForm.levelsid=o.levels,this.myForm.countryid=o.country,this.myForm.cityid=o.city,this.myForm.areaid=o.area,this.myForm.industryId=o.industryType,this.myForm.companyId=o.companyType,this.myForm.operatingStateId=o.operatingState,this.myForm.enterpriseScaleId=o.enterpriseScale,this.myForm.financingStateId=o.financingState,this.$emit("input",this.myForm))},loadTable2:function(){var t=this,e=a("1nuA"),i={};i.page=this.page,i.limit=99999999,o()({method:"post",url:t.$store.state.defaultHttp+"rightPoolName.do?cId="+t.$store.state.iscId,data:e.stringify(i)}).then(function(e){var a=e.data.map.success.customerTwos,i=e.data.map.success.customerpools;t.tableData2=a.concat(i)}).catch(function(t){})},handleInput:function(t,e){this.myForm[e]=t},handleoninput:function(t,e){var i=this;this.myForm[e]=t;var n=a("1nuA"),l={};l.page=this.page,l.limit=this.limit,l.keyword=t,o()({method:"post",url:i.$store.state.defaultHttp+"customerOne/query.do",data:n.stringify(l)}).then(function(t){i.tableData=t.data.rows,i.tableNumber=t.data.total}).catch(function(t){})},handleblur:function(t,e){var a=this,i=t.target.value;this.tableData2.forEach(function(t){i==t.name&&a.$message({message:"该公司已存在于线索或客户中",type:"error"})})},submit:function(){var t=this,e=a("1nuA"),i={};t.cusaddOrUpdateData.submitData&&(i.id=t.cusaddOrUpdateData.submitData.id,i.csId=t.cusaddOrUpdateData.submitData.csId);var n=t.cusaddOrUpdateData.createForm,l=t.cusaddOrUpdateData.assistForm,s=t.cusaddOrUpdateData.orderForm,r=!1;l.forEach(function(e){i[e.inputModel]=t.myForm[e.inputModel]}),s.forEach(function(e){i[e.inputModel]=t.myForm[e.inputModel]}),n.forEach(function(e){i[e.inputModel]=t.myForm[e.inputModel],"contactsName"!=e.inputModel||i[e.inputModel]||(t.$message({message:"联系人名称不能为空",type:"error"}),r=!0),"poolName"!=e.inputModel||i[e.inputModel]||(t.$message({message:"公司名称不能为空",type:"error"}),r=!0),"phone"!=e.inputModel||i[e.inputModel]||(t.$message({message:"手机号码不能为空",type:"error"}),r=!0),"levelsid"!=e.inputModel||i[e.inputModel]||(t.$message({message:"客户分类不能为空",type:"error"}),r=!0),"customerStateid"!=e.inputModel||i[e.inputModel]||(t.$message({message:"客户来源不能为空",type:"error"}),r=!0)}),r||(i.secondid=this.$store.state.deptid,i.deptid=this.$store.state.insid,this.isDisable=!0,o()({method:"post",url:t.cusaddOrUpdateData.submitURL,data:e.stringify(i)}).then(function(e){e.data.code&&"200"==e.data.code?(t.$message({message:"成功",type:"success"}),t.closeTag()):t.$message({message:e.data.msg,type:"error"}),t.isDisable=!1}).catch(function(e){t.$message.error("提交失败，请重新提交")}))},closeTag:function(){var t=this,e=void 0;this.$store.state.tagsList.forEach(function(a,i){a.name==t.$options.name&&(e=i)});var a=this.$store.state.tagsList.splice(e,1)[0];(this.$store.state.tagsList[e]?this.$store.state.tagsList[e]:this.$store.state.tagsList[e-1])?a.path===this.$route.fullPath&&this.$router.push("/customer"):this.$router.push("/index")},getRow:function(t,e){this.myForm.poolName=e.name,this.myForm.address=e.address,this.myForm.url=e.url,this.myForm.representative=e.representative,this.myForm.registrationAuthority=e.registrationAuthority,this.myForm.registrationNumber=e.registrationNumber,this.myForm.organizationCode=e.organizationCode,this.myForm.date=e.date,this.myForm.industryId=e.industryName,this.industryId=e.industryId,this.myForm.companyId=e.company,this.companyId=e.companyId,this.myForm.operatingStateId=e.ostate,this.operatingStateId=e.operatingStateId,this.myForm.capital=e.capital,this.myForm.financingState=e.financing,this.financingStateId=e.financingId,this.myForm.enterpriseScale=e.enterpriseScaleName,this.myForm.enterpriseScaleId=e.enterpriseScaleId,this.myForm.creditCode=e.creditCode,this.loadinfo()},choseProvince:function(t){this.myForm.cityid="",this.myForm.areaid="",this.countryid=t,this.$options.methods.loadCountry.bind(this)(!0)},choseCity:function(t){this.myForm.areaid="",this.cityid=t,this.$options.methods.loadCountry.bind(this)(!0)},choseBlock:function(t){this.E=t,this.areaid=t},loadinfo:function(){var t=this,e=a("1nuA"),i={comboType:"IndustryType"},n={comboType:"EnterpriseScale"},l={comboType:"CompanyType"},s={comboType:"OperatingState"},r={comboType:"FinancingState"},d={comboType:"Listed"};o()({method:"post",url:t.$store.state.defaultHttp+"search/find.do",data:e.stringify(i)}).then(function(e){t.industryTypeList=e.data,t.industryTypeList.forEach(function(e){t.industryId==e.id&&(t.myForm.industryId=e.id)})}).catch(function(t){}),o()({method:"post",url:t.$store.state.defaultHttp+"search/find.do",data:e.stringify(n)}).then(function(e){t.enterpriseScaleList=e.data,t.enterpriseScaleList.forEach(function(e){t.enterpriseScaleId==e.id&&(t.myForm.enterpriseScaleId=e.id)})}).catch(function(t){}),o()({method:"post",url:t.$store.state.defaultHttp+"search/find.do",data:e.stringify(l)}).then(function(e){t.companyTypeList=e.data,t.companyTypeList.forEach(function(e){t.companyId==e.id&&(t.myForm.companyId=e.id)})}).catch(function(t){}),o()({method:"post",url:t.$store.state.defaultHttp+"search/find.do",data:e.stringify(s)}).then(function(e){t.operatingStateList=e.data,t.operatingStateList.forEach(function(e){t.operatingStateId==e.id&&(t.myForm.operatingStateId=e.id)})}).catch(function(t){}),o()({method:"post",url:t.$store.state.defaultHttp+"search/find.do",data:e.stringify(r)}).then(function(e){t.financingStateList=e.data,t.financingStateList.forEach(function(e){t.financingStateId==e.id&&(t.myForm.financingStateId=e.id)})}).catch(function(t){}),o()({method:"post",url:t.$store.state.defaultHttp+"search/find.do",data:e.stringify(d)}).then(function(e){t.listedList=e.data}).catch(function(t){})}}}),l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"addorupdatecontent"},[a("el-tabs",{staticClass:"formtabs",attrs:{type:"card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"主要数据",name:"first"}},[a("el-form",{ref:"myForm",staticClass:"cusForm",attrs:{model:t.myForm,rules:t.rules}},t._l(t.cusaddOrUpdateData.createForm,function(e){return a("el-form-item",{key:e.inputModel,staticClass:"formitemcus",attrs:{"label-width":"100px",label:e.label,prop:e.inputModel}},[e.type&&"input"!=e.type?t._e():a("el-input",{staticStyle:{width:"90%"},attrs:{value:t.myForm[e.inputModel],placeholder:e.placeholder,"auto-complete":"off"},on:{input:function(a){t.handleInput(a,e.inputModel)}}}),t._v(" "),e.type&&"url"==e.type&&"url"==e.inputModel?a("el-input",{staticStyle:{width:"90%"},attrs:{value:t.myForm[e.inputModel],"auto-complete":"off",disabled:e.disabled},on:{input:function(a){t.handleInput(a,e.inputModel)}}},[a("template",{slot:"prepend"},[t._v("http://")])],2):t._e(),t._v(" "),"textarea"==e.type?a("el-input",{staticStyle:{width:"90%"},attrs:{type:"textarea",rows:"5",value:t.myForm[e.inputModel],"auto-complete":"off",disabled:e.disabled},on:{input:function(a){t.handleInput(a,e.inputModel)}}}):e.type&&"number"==e.type?a("el-input",{staticStyle:{width:"90%"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'')",value:t.myForm[e.inputModel],placeholder:e.placeholder,"auto-complete":"off"},on:{input:function(a){t.handleInput(a,e.inputModel)}}}):e.type&&"require"==e.type&&"poolName"==e.inputModel?a("el-input",{staticStyle:{width:"90%"},attrs:{value:t.myForm[e.inputModel],placeholder:e.placeholder,"auto-complete":"off"},on:{input:function(a){t.handleoninput(a,e.inputModel)},blur:function(a){t.handleblur(a,e.inputModel)}}}):"customerStateid"==e.inputModel?a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:e.placeholder},on:{change:function(a){t.handleInput(a,e.inputModel)}},model:{value:t.myForm[e.inputModel],callback:function(a){t.$set(t.myForm,e.inputModel,a)},expression:"myForm[item.inputModel]"}},t._l(t.cuesList,function(t){return a("el-option",{key:t.id,attrs:{label:t.typeName,value:t.id}})})):"levelsid"==e.inputModel?a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:e.placeholder},on:{change:function(a){t.handleInput(a,e.inputModel)}},model:{value:t.myForm[e.inputModel],callback:function(a){t.$set(t.myForm,e.inputModel,a)},expression:"myForm[item.inputModel]"}},t._l(t.levelList,function(t){return a("el-option",{key:t.id,attrs:{label:t.typeName,value:t.id}})})):"countryid"==e.inputModel?a("el-select",{staticStyle:{width:"28%"},attrs:{placeholder:e.placeholder},on:{change:t.choseProvince},model:{value:t.myForm[e.inputModel],callback:function(a){t.$set(t.myForm,e.inputModel,a)},expression:"myForm[item.inputModel]"}},t._l(t.Provinces,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):"cityid"==e.inputModel?a("el-select",{staticClass:"cityseat",staticStyle:{width:"28%"},attrs:{placeholder:e.placeholder},on:{change:t.choseCity},model:{value:t.myForm[e.inputModel],callback:function(a){t.$set(t.myForm,e.inputModel,a)},expression:"myForm[item.inputModel]"}},t._l(t.cityList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):"areaid"==e.inputModel?a("el-select",{staticClass:"areaseat",staticStyle:{width:"28%"},attrs:{placeholder:e.placeholder},on:{change:t.choseBlock},model:{value:t.myForm[e.inputModel],callback:function(a){t.$set(t.myForm,e.inputModel,a)},expression:"myForm[item.inputModel]"}},t._l(t.areaList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):e.type&&"radio"==e.type&&"sex"==e.inputModel?a("div",[a("el-radio",{attrs:{label:"男"},on:{input:function(a){t.handleInput(a,e.inputModel)}},model:{value:t.myForm[e.inputModel],callback:function(a){t.$set(t.myForm,e.inputModel,a)},expression:"myForm[item.inputModel]"}},[t._v("男")]),t._v(" "),a("el-radio",{attrs:{label:"女"},on:{input:function(a){t.handleInput(a,e.inputModel)}},model:{value:t.myForm[e.inputModel],callback:function(a){t.$set(t.myForm,e.inputModel,a)},expression:"myForm[item.inputModel]"}},[t._v("女")])],1):t._e()],1)}))],1),t._v(" "),a("el-tab-pane",{attrs:{label:"辅助资料",name:"second"}},[a("el-form",{ref:"myForm",staticClass:"cusForm",attrs:{model:t.myForm,rules:t.rules}},t._l(t.cusaddOrUpdateData.assistForm,function(e){return a("el-form-item",{key:e.inputModel,attrs:{"label-width":"130px",label:e.label,prop:e.inputModel}},[e.type&&"input"!=e.type?"capital"==e.inputModel?a("el-input",{staticStyle:{width:"90%"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'.')",value:t.myForm[e.inputModel],"auto-complete":"off"},on:{input:function(a){t.handleinput(a,e.inputModel)}}},[a("span",{staticStyle:{"margin-right":"20px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v("万元")])]):e.type&&"date"==e.type?a("el-date-picker",{staticStyle:{width:"90%"},attrs:{type:"date",placeholder:e.placeholder,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","auto-complete":"off"},on:{change:function(a){t.handleInput(a,e.inputModel)}},model:{value:t.myForm[e.inputModel],callback:function(a){t.$set(t.myForm,e.inputModel,a)},expression:"myForm[item.inputModel]"}}):e.type&&"select"==e.type&&"enterpriseScaleId"==e.inputModel?a("el-select",{staticStyle:{width:"90%"},attrs:{multiple:e.multiple,"collapse-tags":e.multiple,placeholder:e.placeholder},on:{select:function(a){t.handleInput(a,e.inputModel)}},model:{value:t.myForm[e.inputModel],callback:function(a){t.$set(t.myForm,e.inputModel,a)},expression:"myForm[item.inputModel]"}},t._l(t.enterpriseScaleList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):e.type&&"select"==e.type&&"financingStateId"==e.inputModel?a("el-select",{staticStyle:{width:"90%"},attrs:{multiple:e.multiple,"collapse-tags":e.multiple,placeholder:e.placeholder},on:{select:function(a){t.handleInput(a,e.inputModel)}},model:{value:t.myForm[e.inputModel],callback:function(a){t.$set(t.myForm,e.inputModel,a)},expression:"myForm[item.inputModel]"}},t._l(t.financingStateList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):e.type&&"select"==e.type&&"industryId"==e.inputModel?a("el-select",{staticStyle:{width:"90%"},attrs:{multiple:e.multiple,"collapse-tags":e.multiple,placeholder:e.placeholder},on:{select:function(a){t.handleInput(a,e.inputModel)}},model:{value:t.myForm[e.inputModel],callback:function(a){t.$set(t.myForm,e.inputModel,a)},expression:"myForm[item.inputModel]"}},t._l(t.industryTypeList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):e.type&&"select"==e.type&&"companyId"==e.inputModel?a("el-select",{staticStyle:{width:"90%"},attrs:{multiple:e.multiple,"collapse-tags":e.multiple,placeholder:e.placeholder},on:{select:function(a){t.handleInput(a,e.inputModel)}},model:{value:t.myForm[e.inputModel],callback:function(a){t.$set(t.myForm,e.inputModel,a)},expression:"myForm[item.inputModel]"}},t._l(t.companyTypeList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):e.type&&"select"==e.type&&"operatingStateId"==e.inputModel?a("el-select",{staticStyle:{width:"90%"},attrs:{multiple:e.multiple,"collapse-tags":e.multiple,placeholder:e.placeholder},on:{select:function(a){t.handleInput(a,e.inputModel)}},model:{value:t.myForm[e.inputModel],callback:function(a){t.$set(t.myForm,e.inputModel,a)},expression:"myForm[item.inputModel]"}},t._l(t.operatingStateList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):t._e():a("el-input",{staticStyle:{width:"90%"},attrs:{value:t.myForm[e.inputModel],"auto-complete":"off"},on:{input:function(a){t.handleInput(a,e.inputModel)}}})],1)}))],1),t._v(" "),a("el-tab-pane",{attrs:{label:"订货资料",name:"third"}},[a("el-form",{ref:"myForm",staticClass:"cusForm",attrs:{model:t.myForm,rules:t.rules}},t._l(t.cusaddOrUpdateData.orderForm,function(e){return a("el-form-item",{key:e.inputModel,attrs:{"label-width":"130px",label:e.label,prop:e.inputModel}},[e.type&&"input"!=e.type?"taxRate"==e.inputModel?a("el-input",{staticStyle:{width:"90%"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'.')",value:t.myForm[e.inputModel],"auto-complete":"off"},on:{input:function(a){t.handleinput(a,e.inputModel)}}},[a("span",{staticStyle:{"margin-right":"20px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v("%")])]):e.type&&"select"==e.type&&"distributorId"==e.inputModel?a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:e.placeholder},on:{change:function(a){t.handleInput(a,e.inputModel)}},model:{value:t.myForm[e.inputModel],callback:function(a){t.$set(t.myForm,e.inputModel,a)},expression:"myForm[item.inputModel]"}},t._l(t.distributorList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):t._e():a("el-input",{staticStyle:{width:"90%"},attrs:{value:t.myForm[e.inputModel],"auto-complete":"off"},on:{input:function(a){t.handleInput(a,e.inputModel)}}})],1)}))],1)],1),t._v(" "),a("div",{staticClass:"line",staticStyle:{height:"690px"}}),t._v(" "),a("div",{staticClass:"formlist"},[a("el-table",{attrs:{data:t.tableData,border:"",stripe:"","default-sort":{order:"ascending"},"max-height":"680"}},[a("el-table-column",{attrs:{"header-align":"center",align:"center",width:"35"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{width:"15px",height:"15px",padding:"0","border-radius":"50%"},on:{click:function(a){t.getRow(e.$index,e.row)}}},[t._v(" ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"name","min-width":"200",label:"公司名称",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"address","show-overflow-tooltip":"","min-width":"200",label:"公司地址",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"representative","min-width":"90",label:"法人",sortable:""}})],1)],1),t._v(" "),a("div",{staticClass:"submit_btn"},[a("el-button",{staticStyle:{"margin-right":"50px !important"},attrs:{type:"primary",disabled:t.isDisable},on:{click:t.submit}},[t._v("立即提交")]),t._v(" "),a("el-button",{on:{click:t.closeTag}},[t._v("取消")])],1)],1)},staticRenderFns:[]};var s=a("VU/8")(n,l,!1,function(t){a("4Ey6")},null,null);e.default=s.exports}});