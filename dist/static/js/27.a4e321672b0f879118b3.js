webpackJsonp([27],{"7zT3":function(e,t){},xzyn:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("wtEF"),n=a("mtWM"),i=a.n(n),o=(a("mw3O"),{name:"workOrder",store:s.a,computed:{tableData:function(){return s.a.state.workOrderList},tableNumber:function(){return s.a.state.workOrderListnumber}},data:function(){return{msg:"工单",page:1,limit:20,searchList:{searchName:null,label:1,time:null,keyType:null,woClass:null},pIdData:[{index:0,name:"全部"},{index:1,name:"我的"},{index:2,name:"本组"},{index:3,name:"本机构"}],timeData:[{index:1,name:"今天"},{index:2,name:"昨天"},{index:3,name:"本周"},{index:4,name:"本月"},{index:5,name:"上月"}],keyTypeData:[{index:1,name:"已解决"},{index:2,name:"未解决"},{index:3,name:"超过3天未解决"},{index:4,name:"超过7天未解决"},{index:5,name:"超过15天未解决"},{index:6,name:"超过一个月未解决"}],woClassData:[],woItemData:[],nullvalue:null,filterList:null,checklist:null}},mounted:function(){this.loadTable(),this.loadClass(),this.reloadData()},activated:function(){this.loadTable()},methods:{loadTable:function(){var e=this,t=a("1nuA"),s={};0==this.searchList.label?s.pId=e.nullvalue:1==this.searchList.label?s.pId=e.$store.state.ispId:2==this.searchList.label?s.secondid=e.$store.state.deptid:3==this.searchList.label?s.deptid=e.$store.state.insid:s.pId=e.$store.state.ispId,this.searchList.keyType!==this.nullvalue&&(s.keyType=this.searchList.keyType),s.page=this.page,s.limit=this.limit,s.example=this.searchList.time,s.searchName=this.searchList.searchName,s.type=this.searchList.woClass,i()({method:"post",url:e.$store.state.defaultHttp+"workOrder/queryForList.do?cId="+e.$store.state.iscId,data:t.stringify(s)}).then(function(t){var a=t.data.map.success;a.forEach(function(e){e.solution?e.solution&&(e.serviceState="待评价"):e.serviceState="待解决"}),e.$store.state.workOrderList=a,e.$store.state.workOrderListnumber=t.data.count}).catch(function(e){})},loadClass:function(){var e=this;i()({method:"get",url:e.$store.state.defaultHttp+"serviceType/getServiceTypeNodeTree.do?cId="+e.$store.state.iscId}).then(function(t){e.woClassData=t.data.map.success}).catch(function(e){})},loadItem:function(e){var t=this,s=a("1nuA"),n={};n.id=e,i()({method:"post",url:t.$store.state.defaultHttp+"serviceType/getServiceTypeByParentId.do?cId="+t.$store.state.iscId,data:s.stringify(n)}).then(function(e){t.woItemData=e.data,t.$options.methods.search.bind(t)()}).catch(function(e){})},reloadData:function(){var e=this,t=a("1nuA"),s={type:"工单"},n={type:"工单",state:1};i()({method:"post",url:e.$store.state.defaultHttp+"userPageInfo/getAllUserPage.do?cId="+e.$store.state.iscId+"&pId="+e.$store.state.ispId,data:t.stringify(s)}).then(function(t){e.filterList=t.data}).catch(function(e){}),i()({method:"post",url:e.$store.state.defaultHttp+"userPageInfo/getUserPage.do?cId="+e.$store.state.iscId+"&pId="+e.$store.state.ispId,data:t.stringify(n)}).then(function(t){e.checklist=t.data}).catch(function(e){})},openDetails:function(e,t){this.$store.state.workOrderdetaildsData={id:t.id},this.$router.push({path:"/workOrderDetail"})},handleEdit:function(e,t){var a={};a.setform=t,a.submitUrl=this.$store.state.defaultHttp+"workOrder/update.do?cId="+this.$store.state.iscId,this.$store.state.workOrderaddorUpdateData=a,this.$router.push({path:"/workOrderaddorupdate"})},handleDelete:function(e,t){var s=this,n=a("1nuA"),o=[];o.id=t.id,s.$confirm("确认删除 ["+t.problem+"] 这个问题吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(e){e.value;i()({method:"post",url:s.$store.state.defaultHttp+"workOrder/delete.do?cId="+s.$store.state.iscId,data:n.stringify(o)}).then(function(e){e.data.code&&200==e.data.code?(s.$message({message:"删除成功",type:"success"}),s.$options.methods.loadTable.bind(s)(!0)):e.data.msg&&"error"==e.data.msg?s.$message({message:"对不起，您没有该权限，请联系管理员开通",type:"error"}):s.$message({message:e.data.msg,type:"error"})}).catch(function(e){s.$message.error("删除失败,请重新删除")})})},hangleChange:function(e,t){var s=this,n=a("1nuA"),o={};o.pageInfoId=t.pageInfoId,o.state=1==e?1:0,i()({method:"post",url:s.$store.state.defaultHttp+"userPageInfo/updateUserPageByid.do?cId="+s.$store.state.iscId+"&pId="+s.$store.state.ispId,data:n.stringify(o)}).then(function(e){e.data&&"success"==e.data&&s.$options.methods.reloadData.bind(s)(!0)}).catch(function(e){})},search:function(){this.$options.methods.loadTable.bind(this)()},handleSizeChange:function(e){this.limit=e,this.$options.methods.loadTable.bind(this)()},handleCurrentChange:function(e){this.page=e,this.$options.methods.loadTable.bind(this)()}}}),r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"radioList"},[a("el-radio-group",{model:{value:e.searchList.label,callback:function(t){e.$set(e.searchList,"label",t)},expression:"searchList.label"}},[a("span",{staticClass:"nameList"},[e._v("数据授权：")]),e._v(" "),e._l(e.pIdData,function(t){return a("el-radio",{key:t.index,attrs:{label:t.index},on:{change:function(t){e.search()}}},[e._v(e._s(t.name))])})],2),e._v(" "),a("el-radio-group",{model:{value:e.searchList.time,callback:function(t){e.$set(e.searchList,"time",t)},expression:"searchList.time"}},[a("span",{staticClass:"nameList"},[e._v("反馈时间：")]),e._v(" "),a("el-radio",{attrs:{label:e.nullvalue},on:{change:function(t){e.search()}}},[e._v("全部")]),e._v(" "),e._l(e.timeData,function(t){return a("el-radio",{key:t.index,attrs:{label:t.index},on:{change:function(t){e.search()}}},[e._v(e._s(t.name))])})],2),e._v(" "),a("el-radio-group",{model:{value:e.searchList.keyType,callback:function(t){e.$set(e.searchList,"keyType",t)},expression:"searchList.keyType"}},[a("span",{staticClass:"nameList"},[e._v("工单状态：")]),e._v(" "),a("el-radio",{attrs:{label:e.nullvalue},on:{change:function(t){e.search()}}},[e._v("全部")]),e._v(" "),e._l(e.keyTypeData,function(t){return a("el-radio",{key:t.index,attrs:{label:t.index},on:{change:function(t){e.search()}}},[e._v(e._s(t.name))])})],2),e._v(" "),a("el-radio-group",{model:{value:e.searchList.woClass,callback:function(t){e.$set(e.searchList,"woClass",t)},expression:"searchList.woClass"}},[a("span",{staticClass:"nameList"},[e._v("工单分类：")]),e._v(" "),a("el-radio",{attrs:{label:e.nullvalue},on:{change:e.loadItem}},[e._v("全部")]),e._v(" "),e._l(e.woClassData,function(t){return a("el-radio",{key:t.id,attrs:{label:t.id},on:{change:e.loadItem}},[e._v(e._s(t.name))])})],2),e._v(" "),a("el-radio-group",{model:{value:e.searchList.woClass,callback:function(t){e.$set(e.searchList,"woClass",t)},expression:"searchList.woClass"}},e._l(e.woItemData,function(t){return a("el-radio",{key:t.id,attrs:{label:t.id},on:{change:function(t){e.search()}}},[e._v(e._s(t.name))])}))],1),e._v(" "),a("div",{staticClass:"searchList",staticStyle:{width:"100%"}},[a("span",{staticClass:"nameList"},[e._v("公司名称：")]),e._v(" "),a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入公司名称"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.search(t):null}},model:{value:e.searchList.searchName,callback:function(t){e.$set(e.searchList,"searchName",t)},expression:"searchList.searchName"}}),e._v("\n          \n        "),a("el-button",{attrs:{icon:"el-icon-search",type:"primary",size:"mini"},on:{click:function(t){e.search()}}},[e._v("查询")])],1),e._v(" "),a("div",{staticClass:"entry"},[a("div",{staticClass:"totalnum_head"},[e._v("共 "),a("span",{staticClass:"bold_span"},[e._v(e._s(e.tableNumber))]),e._v(" 条")]),e._v(" "),a("el-popover",{attrs:{placement:"bottom",width:"100",trigger:"click"}},[a("el-checkbox-group",{staticClass:"checklist",staticStyle:{"max-height":"600px","overflow-y":"overlay","overflow-x":"hidden"},model:{value:e.checklist,callback:function(t){e.checklist=t},expression:"checklist"}},e._l(e.filterList,function(t){return a("el-checkbox",{key:t.id,staticClass:"checkone",attrs:{label:t.name,value:t.state},on:{change:function(a){e.hangleChange(a,t)}}})})),e._v(" "),a("el-button",{staticClass:"info-btn screen",attrs:{slot:"reference",icon:"el-icon-more",type:"mini"},slot:"reference"})],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:""}},[a("el-table-column",{attrs:{"header-align":"center",fixed:"",align:"center",type:"index",width:"45"}}),e._v(" "),e._l(e.filterList,function(t,s){return a("div",{key:s},["workOrderNo"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"单号",prop:"workOrderNo",fixed:"","min-width":"150",sortable:""}}):e._e(),e._v(" "),"problem"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"问题",prop:"problem",fixed:"","min-width":"200","show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"hoverline",on:{click:function(a){e.openDetails(t.$index,t.row)}}},[e._v("\n                        "+e._s(t.row.problem)+"\n                    ")])]}}])}):e._e(),e._v(" "),"status"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"状态",prop:"serviceState","min-width":"90",sortable:""}}):e._e(),e._v(" "),"customerpool"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"公司名称",prop:"customerpool","min-width":"200",sortable:""}}):e._e(),e._v(" "),"contacts"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"联系人",prop:"contacts","min-width":"100",sortable:""}}):e._e(),e._v(" "),"phone"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"电话",prop:"phone","min-width":"110",sortable:""}}):e._e(),e._v(" "),"feedbackTime"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"反馈时间",prop:"feedbackTime","min-width":"150",sortable:""}}):e._e(),e._v(" "),"feedbackType"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"反馈方式",prop:"feedbackType","min-width":"110",sortable:""}}):e._e(),e._v(" "),"acceptance"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"受理人",prop:"acceptanceName","min-width":"100",sortable:""}}):e._e(),e._v(" "),"serviceType"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"工单类型",prop:"serviceTypeName","min-width":"110",sortable:""}}):e._e(),e._v(" "),"orderNo"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"销售单号",prop:"orderNo","min-width":"150",sortable:""}}):e._e(),e._v(" "),"pId"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"制单人",prop:"private_employee","min-width":"100",sortable:""}}):e._e(),e._v(" "),"ascriptionId"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"业务员",prop:"ascription","min-width":"100",sortable:""}}):e._e(),e._v(" "),"secondid"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"部门",prop:"deptname","min-width":"110",sortable:""}}):e._e(),e._v(" "),"deptid"==t.prop&&1==t.state?a("el-table-column",{attrs:{label:"机构",prop:"parentname","min-width":"110","show-overflow-tooltip":"",sortable:""}}):e._e()],1)}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],2),e._v(" "),a("div",{staticClass:"block numberPage"},[a("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[20,50,100,500],"page-size":20,layout:"total, sizes, prev, pager, next, jumper",total:e.tableNumber},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var l=a("VU/8")(o,r,!1,function(e){a("7zT3")},null,null);t.default=l.exports}});