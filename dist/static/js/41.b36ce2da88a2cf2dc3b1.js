webpackJsonp([41],{QXXM:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s,i=a("bOdI"),l=a.n(i),o=a("INCx"),n=a.n(o),r=a("wtEF"),c=a("mtWM"),d=a.n(c),u=(a("mw3O"),{name:"agreementDetails",store:r.a,filters:{commaing:function(t){if(t){var e=n()(t).toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"),a=".00",s=t.toString().split(".");return 2===s.length?1===(a=s[1].toString()).length?e+"."+a+"0":e+"."+a:e+a}}},data:function(){var t;return t={pickerOptions:{disabledDate:function(t){return t.getTime()<Date.now()-864e5}},planFieldData:[],backFieldData:[],detailData:null,searchList:{keyword:null},agreementdetail:{},fieldData:[],activeName2:"first",tableDatas:null,tableNumber:null,page:1,limit:20,thisshow:!0,idArr:{id:null},dataList:null,fileList:null,imgid:null,imgurl:null,dialogImageUrl:null,dialogVisible:!1,imgshow:!1,retracts:!0,examineList:[],hasCheck:null,hasRecheck:null,examineLog:[],dialogVisibleexa:!1,exaform:{status:null,remarks:null},moneyPlanList:[],dialogVisible3:!1,moneyPlan:{id:null,amount:null,restamount:null,date:null,price:null,back_plan_id:null,contract_id:null,customerpool_id:null,remarks:null,remind_date:null},moneyBackList:[],dialogVisible4:!1,moneyBack:{id:null,amount:null,restamount:null,createTime:null,price:null,stage:null,contract_id:null,customerpool_id:null,remarks:null,pay_type_id:null,backNo:null},payList:[],backamount:0,backrestamount:0,rules:{remarks:[{required:!0,message:"审核意见不能为空",trigger:"blur"}],stage:[{required:!0,message:"回款阶段不能为空",trigger:"blur"}],price:[{required:!0,message:"预计回款金额不能为空",trigger:"blur"}],date:[{required:!0,message:"预计回款时间不能为空",trigger:"blur"}],prices:[{required:!0,message:"回款金额不能为空",trigger:"blur"}],createTime:[{required:!0,message:"回款时间不能为空",trigger:"blur"}],pay_type_id:[{required:!0,message:"收款方式不能为空",trigger:"blur"}],back_plan_id:[{required:!0,message:"回款阶段不能为空",trigger:"blur"}],followContent:[{required:!0,message:"请输入跟进内容",trigger:"blur"}],contactsId:[{required:!0,message:"请选择联系人",trigger:"blur"}],followType:[{required:!0,message:"请选择联系方式",trigger:"blur"}]},auditing:this.$store.state.systemHttp+"/upload/staticImg/inaudit.png",audited:this.$store.state.systemHttp+"/upload/staticImg/examine.png",noaudit:this.$store.state.systemHttp+"/upload/staticImg/refuse.png",itemData:[{id:10,productImg:null,amountOfMoney:null,commitTime:null,brand:null,discount:null,discountAfter:null,discountAmount:null,tbGoods:{goodsName:"",describe:""},num:null,price:null,taxAfter:null,taxAmount:null,taxRate:null,unit:null,edit:!1,remarks1:null,remarks2:null}],list:null,selectData:[],scopeIndex:"",cusdiscount:null,custaxRate:null,OKdisabled:!0,classification_id:null,goodsName:null,dialogVisible1:!1,tableData:[],itemList:[],multipleSelection:[]},l()(t,"idArr",[]),l()(t,"datalist",[]),l()(t,"defaultProps",{label:"name",children:"next"}),l()(t,"defaultkeys",[1]),l()(t,"nodeChange",!1),l()(t,"updateData",[]),l()(t,"productData",[]),l()(t,"isDisable",!1),l()(t,"followform",{followType:"电话",contactTime:"",contactsId:"",followContent:"",imgName:null,enclosureName:null}),l()(t,"followTypes",[{label:"电话",value:"1"},{label:"微信",value:"2"},{label:"QQ",value:"3"},{label:"邮箱",value:"4"},{label:"拜访",value:"5"}]),l()(t,"fastcontactList",null),l()(t,"contactData",[]),l()(t,"files",null),l()(t,"filesName",null),l()(t,"imgfile",null),l()(t,"imgName",null),l()(t,"filesList",[]),l()(t,"imgList",[]),l()(t,"record",[]),l()(t,"dialogVisible2",!1),l()(t,"dialogImageUrl2",null),l()(t,"backMoneyData",{}),l()(t,"previewData",[]),l()(t,"deptData",[]),l()(t,"defaultProps",{label:"deptname",children:"next"}),l()(t,"userData",[]),l()(t,"doUpload",this.$store.state.defaultHttp+"workOrder/upload.do?cId="+this.$store.state.iscId),l()(t,"filterList",null),l()(t,"checklist",null),t},activated:function(){this.loadData(),this.loadIMG(),this.getList(),this.loadFieldHead(),this.loadUserandDept(),this.reloadData()},methods:(s={loadData:function(){var t=this,e=a("1nuA"),s={};s.page=this.page,s.limit=this.limit,s.searchName=this.searchList.keyword;var i={type:"收款方式"},l={type:"快捷方式"};d()({method:"post",url:t.$store.state.defaultHttp+"getContractAll.do?cId="+t.$store.state.iscId+"&pId="+t.$store.state.ispId,data:e.stringify(s)}).then(function(e){t.tableDatas=e.data.map.success,t.tableNumber=e.data.count}).catch(function(t){}),d()({method:"post",url:t.$store.state.defaultHttp+"typeInfo/getTypeInfoGroupByType.do?cId="+t.$store.state.iscId,data:e.stringify(i)}).then(function(e){t.payList=e.data}).catch(function(t){}),d()({method:"get",url:t.$store.state.defaultHttp+"classification/getClassificationNodeTree.do?cId="+t.$store.state.iscId}).then(function(e){t.datalist=e.data.map.success}).catch(function(t){}),d()({method:"post",url:t.$store.state.defaultHttp+"typeInfo/getTypeInfoGroupByType.do?cId="+t.$store.state.iscId,data:e.stringify(l)}).then(function(e){t.fastcontactList=e.data}).catch(function(t){})},loadIMG:function(){var t=this;this.detailData=this.$store.state.agreedetailsData.submitData,this.idArr.id=this.$store.state.agreedetailsData.submitData.id,t.fileList=[];var e=a("1nuA"),s={typetid:this.detailData.id,type:"合同",pId:this.$store.state.ispId,cId:this.$store.state.iscId},i={label:6,id:this.detailData.id};d()({method:"post",url:t.$store.state.defaultHttp+"imgInfo/getImgInfoByTypeid.do",data:e.stringify(s)}).then(function(e){t.dataList=e.data,t.dataList.forEach(function(e){t.imgid=e.id,t.imgurl=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.name,t.fileList.push({id:t.imgid,imgURL:t.imgurl})})}).catch(function(e){t.$message.error("图片加载失败")}),d()({method:"get",url:t.$store.state.defaultHttp+"getContractById.do?cId="+t.$store.state.iscId+"&contractId="+this.detailData.id}).then(function(a){t.agreementdetail=a.data,t.agreementdetail.discount?t.cusdiscount=a.data.discount:t.cusdiscount="100",t.agreementdetail.taxRate?t.custaxRate=a.data.taxRate:t.custaxRate="0";var s={checkStatus:a.data.checkStatus,recordId:a.data.examineRecordId,pId:t.$store.state.ispId};d()({method:"post",url:t.$store.state.defaultHttp+"examineRecord/queryExamineRecordList.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){t.examineList=e.data.steps,t.examineList.forEach(function(e,a){if(e.userLength=e.userList.length,1==e.userLength?e.type_style="width:50px;":2==e.userLength?e.type_style="width:75px;":3==e.userLength?e.type_style="width:100px;":4==e.userLength?e.type_style="width:125px;":5==e.userLength&&(e.type_style="width:150px;"),0==a&&(e.userList[0].img?e.headPortrait=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.userList[0].img:e.headPortrait=t.$store.state.systemHttp+"/upload/staticImg/avatar.jpg"),2==e.stepType)for(var s=0;s<e.userList.length;s++){if(e.userList[s].img&&0!==e.userList[s].examineStatus){e.headPortrait=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.userList[s].img;break}if(!e.userList[s].img&&0!==e.userList[s].examineStatus){e.headPortrait=t.$store.state.systemHttp+"/upload/staticImg/avatar.jpg";break}if(e.userList[s].img&&0==e.userList[s].examineStatus){e.headPortrait=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.userList[s].img;break}if(!e.userList[s].img&&0==e.userList[s].examineStatus){e.headPortrait=t.$store.state.systemHttp+"/upload/staticImg/avatar.jpg";break}}3==e.stepType&&e.userList.forEach(function(e,a){e.img?e.headPortrait=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.img:e.headPortrait=t.$store.state.systemHttp+"/upload/staticImg/avatar.jpg"})}),t.hasCheck=e.data.isCheck,t.hasRecheck=e.data.isRecheck}).catch(function(t){}),d()({method:"get",url:t.$store.state.defaultHttp+"examineLog/queryExamineLogList.do?cId="+t.$store.state.iscId+"&recordId="+t.agreementdetail.examineRecordId}).then(function(e){t.examineLog=e.data}).catch(function(t){}),t.$options.methods.loadfollow.bind(t)()}).catch(function(t){}),d()({method:"post",url:t.$store.state.defaultHttp+"field/information.do?cId="+t.$store.state.iscId,data:e.stringify(i)}).then(function(e){t.fieldData=e.data}).catch(function(t){}),d()({method:"get",url:t.$store.state.defaultHttp+"backPlan/selectBackPlanByContractId.do?cId="+t.$store.state.iscId+"&contract_id="+t.detailData.id}).then(function(e){t.moneyPlanList=e.data}).catch(function(t){}),d()({method:"get",url:t.$store.state.defaultHttp+"back/selectBackByContactId.do?cId="+t.$store.state.iscId+"&contract_id="+t.detailData.id}).then(function(e){var a=e.data;a.forEach(function(t){2==t.checkStatus&&(t.disabledBtn=!0)}),t.moneyBackList=a}).catch(function(t){}),t.$options.methods.loadProduct.bind(t)()},loadfollow:function(){var t=this,e=a("1nuA"),s={page:1,limit:1e5};d()({method:"get",url:t.$store.state.defaultHttp+"getFollowByOpportunityIdOrContractId.do?cId="+t.$store.state.iscId+"&contract_id="+t.detailData.id}).then(function(e){t.record=e.data.map.success,t.record.forEach(function(e){e.showdelico=!1;var a=Date.parse(e.createTime),s=(new Date).getTime()-a;s<72e5&&(e.showdelico=!0),s>72e5&&(e.showdelico=!1),e.userImagName&&(e.imgUrl=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.userImagName),e.userImagName&&null!=e.userImagName||(e.imgUrl=t.$store.state.systemHttp+"/upload/staticImg/avatar.jpg"),e.imgName&&null!==e.imgName&&(e.picture_detail=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.imgName),e.enclosureName&&null!==e.enclosureName&&(e.enclosureUrl=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.enclosureName),e.followContent=e.followContent.replace(/\n/g,"<br/>")})}).catch(function(t){}),d()({method:"post",url:t.$store.state.defaultHttp+"customerpool/getPoolContacts.do?cId="+t.$store.state.iscId+"&customerpool_id="+t.agreementdetail.customerpool_id,data:e.stringify(s)}).then(function(e){t.contactData=e.data.map.success,t.followform.contactsId=e.data.map.success[0].id}).catch(function(t){})},loadFieldHead:function(){var t=this,e=a("1nuA"),s={label:7,pId:this.$store.state.ispId},i={label:8,pId:this.$store.state.ispId};d()({method:"post",url:t.$store.state.defaultHttp+"field/queryListHead.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){t.planFieldData=e.data}).catch(function(t){}),d()({method:"post",url:t.$store.state.defaultHttp+"field/queryListHead.do?cId="+t.$store.state.iscId,data:e.stringify(i)}).then(function(e){t.backFieldData=e.data}).catch(function(t){})},loadfield:function(t){var e=this,s=a("1nuA"),i=null,l=null;this.backMoneyData.id&&(i=this.backMoneyData.id,l=this.backMoneyData.batch_id);var o={label:t,id:i,batch_id:l};d()({method:"post",url:e.$store.state.defaultHttp+"field/queryField.do?cId="+e.$store.state.iscId,data:s.stringify(o)}).then(function(t){var a=t.data;a.forEach(function(t,a){t.displayVal="",e.backMoneyData.id?(t.default_value=t.value,"user"!=t.formType&&"structure"!=t.formType||(t.displayVal=t.deptOrUserName,t.default_value=parseInt(t.value))):"checkbox"!==t.formType&&null!==t.value&&(t.default_value=t.value),1==t.is_null&&(e.rules[t.field_name]=[{required:!0,message:" ",trigger:"blur"}])}),e.previewData=a}).catch(function(t){})},loadUserandDept:function(){var t=this,e=a("1nuA"),s={page:1,limit:"9999"};d()({method:"post",url:t.$store.state.defaultHttp+"getPrivateUserAll.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){t.userData=e.data.map.success}).catch(function(t){}),d()({method:"get",url:t.$store.state.defaultHttp+"dept/getDeptNodeTree.do?cId="+t.$store.state.iscId}).then(function(e){t.deptData=e.data.map.success}).catch(function(t){})},reloadData:function(){var t=this,e=a("1nuA"),s={type:"销售订单详情"},i={type:"销售订单详情",state:1};d()({method:"post",url:t.$store.state.defaultHttp+"userPageInfo/getAllUserPage.do?cId="+t.$store.state.iscId+"&pId="+t.$store.state.ispId,data:e.stringify(s)}).then(function(e){t.filterList=e.data}).catch(function(t){}),d()({method:"post",url:t.$store.state.defaultHttp+"userPageInfo/getUserPage.do?cId="+t.$store.state.iscId+"&pId="+t.$store.state.ispId,data:e.stringify(i)}).then(function(e){t.checklist=e.data}).catch(function(t){})},hangleChange:function(t,e){var s=this,i=a("1nuA"),l={};l.pageInfoId=e.pageInfoId,l.state=1==t?1:0,d()({method:"post",url:s.$store.state.defaultHttp+"userPageInfo/updateUserPageByid.do?cId="+s.$store.state.iscId+"&pId="+s.$store.state.ispId,data:i.stringify(l)}).then(function(t){t.data&&"success"==t.data&&s.$options.methods.reloadData.bind(s)(!0)}).catch(function(t){s.$message.error("提交失败，请重新提交")})},showImg:function(t,e){this.dialogImageUrl2=this.$store.state.systemHttp+"/upload/"+this.$store.state.iscId+"/"+e.imgName,this.dialogVisible2=!0},loadProduct:function(){var t=this,e=a("1nuA"),s={};s.contract_id=t.detailData.id,d()({method:"post",url:t.$store.state.defaultHttp+"order/selectById.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){t.productData=e.data,t.updateData=e.data.orderDetails,t.updateData.forEach(function(e){e.image?e.productImg=t.$store.state.systemHttp+"product/"+t.$store.state.iscId+"/"+e.image:e.productImg="../../../../static/img/noProduct.png"}),t.updateData.length?t.$options.methods.getItem.bind(t)():t.itemData=[{id:10,productImg:null,amountOfMoney:null,commitTime:null,brand:null,discount:null,discountAfter:null,discountAmount:null,tbGoods:{goodsName:"",describe:""},num:null,price:null,taxAfter:null,taxAmount:null,taxRate:null,unit:null,edit:!1,remarks1:null,remarks2:null}]}).catch(function(t){})},tirggerFile:function(t){var e=this,a=t.target.files[0],s=new FormData;s.append("file",a,a.name);d.a.post(this.$store.state.defaultHttp+"contractUpload.do?cId="+this.$store.state.iscId+"&pId="+this.$store.state.ispId+"&contractid="+this.detailData.id,s,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){"success"==t.data?(e.$message({message:"上传成功",type:"success"}),e.$options.methods.loadIMG.bind(e)(!0)):e.$message({message:t.data,type:"error"})})},getSummaries:function(t){var e=t.columns,a=t.data,s=[];return e.forEach(function(t,e){if(0!==e){var i=a.map(function(e){return Number(e[t.property])});if("price"==t.property){s[e]=i.reduce(function(t,e){return e+t},0),s[e]=s[e].toFixed(2);var l=n()(s[e]).toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"),o=".00",r=s[e].split(".");2===r.length?1===(o=r[1].toString()).length?s[e]=l+"."+o+"0":s[e]=l+"."+o:s[e]=l+o,s[e]+=" 元"}else s[e]=""}else s[e]="总价"}),s}},l()(s,"showImg",function(t,e){this.dialogImageUrl=e.imgURL,this.dialogVisible=!0}),l()(s,"delImg",function(t,e){var s=this,i=this,l=a("1nuA"),o=[];o.id=e.id,i.$confirm("是否确认删除该图片？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){t.value;d()({method:"post",url:i.$store.state.defaultHttp+"imgInfo/delImgInfoById.do?cId="+i.$store.state.iscId,data:l.stringify(o)}).then(function(t){t.data.code&&"200"==t.data.code?(i.$message({message:"删除成功",type:"success"}),i.$options.methods.loadIMG.bind(i)(!0)):i.$message({message:t.data.msg,type:"error"})}).catch(function(t){i.$message.error("删除失败,请重新操作")})}).catch(function(){s.$message({type:"info",message:"取消删除"})})}),l()(s,"mouseenterdiv",function(t){this.imgshow=!0}),l()(s,"mouseleavediv",function(t){this.imgshow=!1}),l()(s,"retract",function(){this.thisshow=!this.thisshow,this.retracts=!this.retracts}),l()(s,"showexamine",function(t){this.exaform.status=t,this.dialogVisibleexa=!0}),l()(s,"handlecheck",function(t,e){this.previewData.forEach(function(a){a.id==e.id&&(a.displayVal=t.deptname,a.default_value=t.deptid)})}),l()(s,"beforeUpload",function(t){if(!(t.size/1024/1024<5))return this.$message.warning("文件大小不能超过 5MB!"),!1}),l()(s,"uploadSuccess",function(t,e,a){this.previewData.forEach(function(e){"file"==e.formType&&(e.default_value=t)})}),l()(s,"addplan",function(){var t=0,e=this.agreementdetail.amount;this.moneyPlanList.forEach(function(e){e.price&&(t+=e.price)});var a=e-t;this.dialogVisible3=!0,this.moneyPlan={id:null,batch_id:null,amount:e,restamount:a,date:null,price:null,stage:null,remarks:null,remind_date:null,contract_id:this.agreementdetail.contract_id,customerpool_id:this.agreementdetail.customerpool_id},this.backMoneyData={},this.loadfield(8)}),l()(s,"editplan",function(t,e){var a=0,s=this.agreementdetail.amount;this.moneyPlanList.forEach(function(t){t.price&&(a+=t.price)});var i=s-a+e.price;this.dialogVisible3=!0,this.moneyPlan={id:e.id,batch_id:e.batch_id,amount:s,restamount:i,date:e.date,price:e.price,stage:e.stage,remarks:e.remarks,remind_date:e.remind_date,contract_id:this.agreementdetail.contract_id,customerpool_id:this.agreementdetail.customerpool_id},this.backMoneyData={id:e.id,batch_id:e.batch_id},this.loadfield(7)}),l()(s,"planSubmit",function(){var t=this,e=t.previewData,a={id:this.moneyPlan.id,batch_id:this.moneyPlan.batch_id,date:this.moneyPlan.date,price:this.moneyPlan.price,stage:this.moneyPlan.stage,contract_id:this.moneyPlan.contract_id,customerpool_id:this.moneyPlan.customerpool_id,remarks:this.moneyPlan.remarks,remind_date:this.moneyPlan.remind_date,pId:this.$store.state.ispId},s=!1;if(a.date||(t.$message({message:"预计回款时间不能为空",type:"error"}),s=!0),a.stage||(t.$message({message:"回款阶段不能为空",type:"error"}),s=!0),a.price||(t.$message({message:"预计回款金额不能为空",type:"error"}),s=!0),a.price>this.moneyPlan.restamount&&(t.$message({message:"预计回款金额不能超过"+this.moneyPlan.restamount+"元",type:"error"}),s=!0),e.forEach(function(e){"checkbox"==e.formType?e.value=e.default_value.join(","):"user"==e.formType||"structure"==e.formType?e.default_value&&(e.value=e.default_value.toString()):e.value=e.default_value,1!=e.is_null||e.value||(t.$message({message:e.name+"不能为空",type:"error"}),s=!0)}),!s){var i={entity:a,field:e};d()({method:"post",url:t.$store.state.defaultHttp+"backPlan/saveOrUpdateBackPlan.do?cId="+t.$store.state.iscId,data:i}).then(function(e){e.data.code&&"200"==e.data.code?(t.$message({message:"操作成功",type:"success"}),t.dialogVisible3=!1,t.$options.methods.loadIMG.bind(t)(!0)):t.$message({message:e.data.msg,type:"error"})}).catch(function(e){t.$message.error("操作失败,请重新操作")})}}),l()(s,"delplan",function(t,e){var s=this,i=this,l=a("1nuA"),o=[];o.id=e.id,i.$confirm("是否确认删除该回款计划？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){t.value;d()({method:"post",url:i.$store.state.defaultHttp+"backPlan/delete.do?cId="+i.$store.state.iscId,data:l.stringify(o)}).then(function(t){t.data.code&&"200"==t.data.code?(i.$message({message:"删除成功",type:"success"}),i.$options.methods.loadIMG.bind(i)(!0)):i.$message({message:t.data.msg,type:"error"})}).catch(function(t){i.$message.error("删除失败,请重新操作")})}).catch(function(){s.$message({type:"info",message:"取消删除"})})}),l()(s,"addback",function(){var t=0,e=this.agreementdetail.amount;this.moneyBackList.forEach(function(e){e.price&&(t+=e.price)});var a=e-t;this.dialogVisible4=!0,this.$store.commit("getNowDate"),this.moneyBack={id:null,batch_id:null,price:null,back_plan_id:null,remarks:null,pay_type_id:null,amount:e,restamount:a,backNo:null,createTime:this.$store.state.nowdate,contract_id:this.agreementdetail.contract_id,customerpool_id:this.agreementdetail.customerpool_id},this.backMoneyData={},this.loadfield(7)}),l()(s,"editback",function(t,e){var a=0,s=this.agreementdetail.amount;this.moneyBackList.forEach(function(t){t.price&&(a+=t.price)});var i=s-a+e.price;this.dialogVisible4=!0,this.moneyBack={id:e.id,batch_id:e.batch_id,backNo:e.backNo,price:e.price,back_plan_id:e.back_plan_id,remarks:e.remarks,pay_type_id:e.pay_type_id,amount:s,restamount:i,createTime:e.createTime,contract_id:this.agreementdetail.contract_id,customerpool_id:this.agreementdetail.customerpool_id},this.backMoneyData={id:e.id,batch_id:e.batch_id},this.loadfield(7)}),l()(s,"backSubmit",function(){var t=this,e=t.previewData,a={id:this.moneyBack.id,batch_id:this.moneyBack.batch_id,createTime:this.moneyBack.createTime,price:this.moneyBack.price,backNo:this.moneyBack.backNo,back_plan_id:this.moneyBack.back_plan_id,contract_id:this.moneyBack.contract_id,customerpool_id:this.moneyBack.customerpool_id,remarks:this.moneyBack.remarks,pay_type_id:this.moneyBack.pay_type_id,pId:this.$store.state.ispId,secondid:this.$store.state.deptid,deptid:this.$store.state.insid,type:"合同"},s=!1;if(a.createTime||(t.$message({message:"回款时间不能为空",type:"error"}),s=!0),a.price||(t.$message({message:"回款金额不能为空",type:"error"}),s=!0),a.pay_type_id||(t.$message({message:"收款方式不能为空",type:"error"}),s=!0),a.back_plan_id||(t.$message({message:"回款阶段不能为空",type:"error"}),s=!0),a.price>this.moneyBack.restamount&&(t.$message({message:"回款金额不能超过"+this.moneyBack.restamount+"元",type:"error"}),s=!0),e.forEach(function(e){"checkbox"==e.formType?e.value=e.default_value.join(","):"user"==e.formType||"structure"==e.formType?e.default_value&&(e.value=e.default_value.toString()):e.value=e.default_value,1!=e.is_null||e.value||(t.$message({message:e.name+"不能为空",type:"error"}),s=!0)}),!s){var i={entity:a,field:e};console.log(i),d()({method:"post",url:t.$store.state.defaultHttp+"back/saveOrUpdateBack.do?cId="+t.$store.state.iscId,data:i}).then(function(e){e.data.code&&"200"==e.data.code?(t.$message({message:"操作成功",type:"success"}),t.dialogVisible4=!1,t.$options.methods.loadIMG.bind(t)(!0)):t.$message({message:e.data.msg,type:"error"})}).catch(function(e){t.$message.error("操作失败,请重新操作")})}}),l()(s,"delback",function(t,e){var s=this,i=this,l=a("1nuA"),o=[];o.id=e.id,i.$confirm("是否确认删除该回款信息？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){t.value;d()({method:"post",url:i.$store.state.defaultHttp+"back/delete.do?cId="+i.$store.state.iscId,data:l.stringify(o)}).then(function(t){t.data.code&&"200"==t.data.code?(i.$message({message:"删除成功",type:"success"}),i.$options.methods.loadIMG.bind(i)(!0)):i.$message({message:t.data.msg,type:"error"})}).catch(function(t){i.$message.error("删除失败,请重新操作")})}).catch(function(){s.$message({type:"info",message:"取消删除"})})}),l()(s,"toexamine",function(){var t=this,e=a("1nuA"),s={};s.id=this.detailData.id,s.recordId=this.agreementdetail.examineRecordId,s.pId=this.$store.state.ispId,s.status=this.exaform.status,s.remarks=this.exaform.remarks;var i=!1;s.remarks||(t.$message({message:"审核意见不能为空",type:"error"}),i=!0),i||d()({method:"post",url:t.$store.state.defaultHttp+"examineRecord/auditExamine.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){e.data.code&&"200"==e.data.code?(t.$message({message:"操作成功",type:"success"}),t.dialogVisibleexa=!1,t.exaform.status=null,t.exaform.remarks=null,t.$options.methods.loadIMG.bind(t)()):t.$message({message:e.data.msg,type:"error"})}).catch(function(e){t.$message.error("审核失败，请稍后再试")})}),l()(s,"getList",function(){var t=this,e=a("1nuA"),s={page:1,limit:1e6};d()({method:"post",url:t.$store.state.defaultHttp+"goods/search.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){var a=e.data.map.goods;a.forEach(function(e){for(var a in e.aaa=JSON.parse(e.spec),e.goodspec=[],e.aaa)"null"!==a&&"undefined"!==a&&e.goodspec.push({label:a,value:e.aaa[a]});e.image?e.productImg=t.$store.state.systemHttp+"product/"+t.$store.state.iscId+"/"+e.image:e.productImg="../../../../static/img/noProduct.png"}),t.list=a.map(function(e){return t.$set(e,"edit",!1),e}),t.$options.methods.getSelect.bind(t)()}).catch(function(t){})}),l()(s,"getItem",function(){var t=this;this.itemData=[],0!==this.updateData.length?this.updateData.forEach(function(e,a){for(var s in e.aaa=JSON.parse(e.spec),e.goodspec=[],e.aaa)"null"!==s&&"undefined"!==s&&e.goodspec.push({label:s,value:e.aaa[s]});t.itemData.push({productImg:e.productImg,amountOfMoney:e.amountOfMoney,brand:e.brand,discount:e.discount,discountAfter:e.discountAfter,discountAmount:e.discountAmount,goodsId:e.goodsId,tbGoods:{goodsName:e.goodsName,describe:e.describe},id:e.itemId,itemId:e.itemId,num:e.num,price:e.price,taxAfter:e.taxAfter,taxAmount:e.taxAmount,taxRate:e.taxRate,goodspec:e.goodspec,unit:e.unit,edit:!1,remarks1:e.remarks1,remarks2:e.remarks2})}):void 0==this.updateData&&(_this.itemData=[{id:10,productImg:null,amountOfMoney:null,commitTime:null,brand:null,discount:null,discountAfter:null,discountAmount:null,tbGoods:{goodsName:"",describe:""},num:null,price:null,taxAfter:null,taxAmount:null,taxRate:null,unit:null,edit:!1,remarks1:null,remarks2:null}])}),l()(s,"getData",function(){var t=this,e=a("1nuA"),s={page:1,limit:1e6};s.classification_id=this.classification_id,s.searchName=this.goodsName,d()({method:"post",url:t.$store.state.defaultHttp+"goods/search.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){var a=e.data.map.goods;a.map(function(e){return t.$set(e,"edit",!1),e}),a.forEach(function(e){for(var a in e.aaa=JSON.parse(e.spec),e.goodspec=[],e.aaa)"null"!==a&&"undefined"!==a&&e.goodspec.push({label:a,value:e.aaa[a]});e.image?e.productImg=t.$store.state.systemHttp+"product/"+t.$store.state.iscId+"/"+e.image:e.productImg="../../../../static/img/noProduct.png"}),t.tableData=a}).catch(function(t){})}),l()(s,"getSelect",function(){var t=this;this.itemData.forEach(function(e,a){t.list.forEach(function(a,s){a.id==e.id&&t.list.splice(s,1)})}),this.selectData=this.list}),l()(s,"handleAdd",function(){this.itemData.push({productImg:null,amountOfMoney:null,commitTime:null,brand:null,discount:null,discountAfter:null,discountAmount:null,tbGoods:{goodsName:"",describe:""},num:null,price:null,taxAfter:null,taxAmount:null,taxRate:null,unit:null,edit:!1,remarks1:null,remarks2:null})}),l()(s,"getSummary",function(t){var e=t.columns,a=t.data,s=[];return e.forEach(function(t,e){if(0!==e){var i=a.map(function(e){return Number(e[t.property])});if("amountOfMoney"==t.property||"discountAmount"==t.property||"discountAfter"==t.property||"taxAmount"==t.property||"taxAfter"==t.property){s[e]=i.reduce(function(t,e){return e+t},0),s[e]=s[e].toFixed(2);var l=n()(s[e]).toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"),o=".00",r=s[e].split(".");2===r.length?1===(o=r[1].toString()).length?s[e]=l+"."+o+"0":s[e]=l+"."+o:s[e]=l+o,s[e]+=" 元"}else"num"==t.property?(s[e]=i.reduce(function(t,e){return e+t},0),s[e]):s[e]=""}else s[e]="合计"}),s}),l()(s,"cellClick",function(t,e,a,s){var i=this;t.edit=!1,"操作"!==e.label&&(t.edit=!0,this.itemData.forEach(function(e,a){t.id==e.id&&(i.scopeIndex=a)}))}),l()(s,"handleFoces",function(t,e){this.scopeIndex=t}),l()(s,"handleFilter",function(t){var e=this;this.selectData=[],this.list.forEach(function(a){-1!=a.tbGoods.goodsName.indexOf(t)&&e.selectData.push(a)})}),l()(s,"currentChange",function(t){var e=this;this.itemData.forEach(function(a,s){s==e.scopeIndex&&t&&(t.edit=!0,t.price=t.tbGoods.price,t.discount=e.cusdiscount,t.taxRate=e.custaxRate,t.num=1,e.itemData.splice(s,1,t),e.OKdisabled=!1,e.$options.methods.handleinput(1,s,t))}),this.list.forEach(function(a,s){t&&t.id==a.id&&e.list.splice(s,1)}),this.selectData=this.list}),l()(s,"handleinput",function(t,e,a,s){if(a.num&&a.price){var i=parseInt(a.num)*parseFloat(a.price);a.amountOfMoney=i.toFixed(2)}if(a.amountOfMoney&&a.discount&&"discount"==s){var l=parseFloat(a.amountOfMoney)*parseFloat(a.discount)/100,o=parseFloat(a.amountOfMoney)-l;a.discountAmount=o.toFixed(2),a.discountAfter=l.toFixed(2)}else if(a.amountOfMoney&&a.discountAmount&&"discountAmount"==s){var n=parseFloat(a.amountOfMoney)-parseFloat(a.discountAmount),r=n/parseFloat(a.amountOfMoney)*100;a.discount=r.toFixed(2),a.discountAfter=n.toFixed(2)}else if(a.amountOfMoney&&a.discount){var c=parseFloat(a.amountOfMoney)*parseFloat(a.discount)/100,d=parseFloat(a.amountOfMoney)-c;a.discountAmount=d.toFixed(2),a.discountAfter=c.toFixed(2)}else a.discountAmount=0,a.discountAfter=a.amountOfMoney;if(a.amountOfMoney&&a.taxRate)if(a.discountAfter){var u=parseFloat(a.discountAfter)*parseFloat(a.taxRate)/100,m=parseFloat(a.discountAfter)+u;a.taxAmount=u.toFixed(2),a.taxAfter=m.toFixed(2)}else{var p=parseFloat(a.amountOfMoney)*parseFloat(a.taxRate)/100,f=parseFloat(a.amountOfMoney)+p;a.taxAmount=p.toFixed(2),a.taxAfter=f.toFixed(2)}else a.taxAmount=0,a.taxAfter=a.discountAfter}),l()(s,"showDialog",function(){this.dialogVisible1=!0,this.$options.methods.getData.bind(this)()}),l()(s,"handleNodeClick",function(t){this.classification_id=t.id,0==t.next.length&&(this.nodeChange=!0,this.$options.methods.getData.bind(this)())}),l()(s,"addInput",function(t){this.goodsName=t,this.$options.methods.getData.bind(this)()}),l()(s,"selectInfo",function(t){this.itemList=[],this.multipleSelection=t;var e=t,a=new Array;e.forEach(function(t){0!=t.id&&a.push(t.id)}),this.idArr=a,this.itemList=t}),l()(s,"handleSubmit",function(){var t=this,e=[];this.itemData.forEach(function(a,s){a.goodsId&&e.push(a),t.itemList.length&&t.itemList.forEach(function(e,s){e.edit=!0,a.id==e.id&&t.itemList.splice(s,1)})}),this.itemData=e.concat(this.itemList),this.itemData.forEach(function(e,a){t.list.forEach(function(s,i){s.id==e.id&&(e.price=s.tbGoods.price,e.discount=t.cusdiscount,e.taxRate=t.custaxRate,e.num=1,t.list.splice(i,1),t.$options.methods.handleinput(1,a,e))})}),this.selectData=this.list,this.dialogVisible1=!1}),l()(s,"confirmEdit",function(t){t.edit=!1,this.$message({message:"本地保存成功",type:"success"})}),l()(s,"handleDelete",function(t,e){var a=this;this.itemData.forEach(function(e,s){s==t&&a.itemData.splice(s,1)}),this.$options.methods.getList.bind(this)()}),l()(s,"onSubmit",function(){var t=this,e=0,a=new Array;this.itemData.forEach(function(t){(t.goodsId||t.itemId)&&(e+=parseFloat(t.taxAfter),a.push({price:t.price,num:t.num,itemId:t.id,amountOfMoney:t.amountOfMoney,discount:t.discount,discountAmount:t.discountAmount,discountAfter:t.discountAfter,taxRate:t.taxRate,taxAmount:t.taxAmount,taxAfter:t.taxAfter,remarks1:t.remarks2,remarks2:t.remarks2}))});var s={id:this.productData.id,contract_id:t.detailData.id,customerpoolId:this.agreementdetail.customerpool_id,totalSum:e,ascriptionId:this.agreementdetail.pId,secondid:this.agreementdetail.secondid,deptid:this.agreementdetail.deptid,orderDetails:a,pId:parseInt(this.$store.state.ispId)};this.isDisable=!0,d()({method:"post",url:t.$store.state.defaultHttp+"order/saveOrUpdateFromOpportunityOrContract.do?cId="+t.$store.state.iscId,data:s}).then(function(e){e.data.code&&"200"==e.data.code?(t.$message({message:"操作成功",type:"success"}),t.itemData.forEach(function(t){t.edit=!1}),t.$options.methods.loadProduct.bind(t)()):t.$message({message:e.data.msg,type:"error"}),t.isDisable=!1}).catch(function(e){t.isDisable=!1})}),l()(s,"beforeUploadimg",function(t,e){this.imgfile=t.raw;var a="jpg"===t.name.split(".")[1],s="png"===t.name.split(".")[1],i="jpeg"===t.name.split(".")[1],l=t.size/1024/1024<5;return a||s||i?l?(this.imgName=t.name,void this.imgList.push({name:t.name})):(this.$message.warning("图片大小不能超过 500KB!"),!1):(this.$message.warning("图片只能是 jpg、png、jpeg格式!"),!1)}),l()(s,"beforeUploadfile",function(t,e){this.files=t.raw;var a="xls"===t.name.split(".")[1],s="xlsx"===t.name.split(".")[1],i="doc"===t.name.split(".")[1],l="docx"===t.name.split(".")[1],o=t.size/1024/1024<5;return a||s||i||l?o?(this.filesName=t.name,void this.filesList.push({name:t.name})):(this.$message.warning("附件大小不能超过 5MB!"),!1):(this.$message.warning("附件只能是 xls、xlsx、doc、docx格式!"),!1)}),l()(s,"Submitfollowform",function(){var t=this,e=(a("1nuA"),new FormData);e.append("contract_id",this.detailData.id),e.append("followType",this.followform.followType),e.append("contactTime",this.followform.contactTime),e.append("followContent",this.followform.followContent),e.append("contactsId",this.followform.contactsId),e.append("customerpool_id",this.agreementdetail.customerpool_id),e.append("deptid",this.$store.state.insid),e.append("secondid",this.$store.state.deptid),e.append("imgNames",this.imgfile),e.append("enclosureNames",this.files),this.followform.followContent?this.followform.contactsId?d()({method:"get",url:t.$store.state.defaultHttp+"customerJurisdiction/follow.do"}).then(function(a){a.data.msg&&"error"==a.data.msg?t.$message({message:"对不起，您没有该权限，请联系管理员开通",type:"error"}):d()({method:"post",url:t.$store.state.defaultHttp+"addFollow.do?cId="+t.$store.state.iscId+"&pId="+t.$store.state.ispId,headers:{"Content-Type":"multipart/form-data"},data:e}).then(function(e){e.data.msg&&"success"==e.data.msg?t.$message({message:"提交成功",type:"success"}):t.$message({message:e.data.msg,type:"error"}),t.followform.contactTime="",t.followform.followContent="",t.followform.imgName="",t.followform.enclosureName="",t.filesList=[],t.imgList=[],t.imgfile=null,t.files=null,t.$options.methods.loadfollow.bind(t)(!0)}).catch(function(e){t.$message.error("提交失败,请重新提交")})}).catch(function(t){}):t.$message({message:"联系人不能为空",type:"error"}):t.$message({message:"跟进内容不能为空",type:"error"})}),l()(s,"getRow",function(t,e){this.$store.state.agreedetailsData.submitData={id:e.contract_id},this.idArr.contractId=e.contract_id,this.$options.methods.loadIMG.bind(this)(!0)}),l()(s,"search",function(){this.$options.methods.loadData.bind(this)()}),l()(s,"handleSizeChange",function(t){this.limit=t,this.$options.methods.loadData.bind(this)()}),l()(s,"handleCurrentChange",function(t){this.page=t,this.$options.methods.loadData.bind(this)()}),s)}),m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticClass:"agrdetcontent",attrs:{gutter:10}},[a("el-col",{attrs:{span:18}},[a("div",{staticClass:"top"},[a("el-card",{staticClass:"box-card",model:{value:t.agreementdetail,callback:function(e){t.agreementdetail=e},expression:"agreementdetail"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"bold_span"},[t._v(t._s(t.agreementdetail.poolName))]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.retracts,expression:"retracts"}],staticClass:"info-btn",staticStyle:{float:"right","margin-left":"10px"},attrs:{size:"mini"},on:{click:function(e){t.retract()}}},[t._v("收起")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.retracts,expression:"!retracts"}],staticClass:"info-btn",staticStyle:{float:"right","margin-left":"10px"},attrs:{size:"mini"},on:{click:function(e){t.retract()}}},[t._v("显示")])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.thisshow,expression:"thisshow"}],staticClass:"text item"},[a("ul",[a("li",[t._v("合同代码："),a("span",[t._v(t._s(t.agreementdetail.contract_number))])]),t._v(" "),a("li",[t._v("合同名称："),a("span",[t._v(t._s(t.agreementdetail.contract_name))])]),t._v(" "),a("li",[t._v("商机名称："),a("span",[t._v(t._s(t.agreementdetail.opportunity_name))])]),t._v(" "),a("li",[t._v("合同金额："),a("span",{staticClass:"bold_span"},[t._v(t._s(t._f("commaing")(t.agreementdetail.amount))+" 元")])]),t._v(" "),a("li",[t._v("合同类型："),a("span",[t._v(t._s(t.agreementdetail.contract_type))])]),t._v(" "),a("li",[t._v("客户签约人："),a("span",[t._v(t._s(t.agreementdetail.signatories))])]),t._v(" "),a("li",[t._v("我方签约人："),a("span",[t._v(t._s(t.agreementdetail.our_signatories))])]),t._v(" "),a("li",[t._v("签约时间："),a("span",[t._v(t._s(t.agreementdetail.start_date))])]),t._v(" "),a("li",[t._v("到期时间："),a("span",[t._v(t._s(t.agreementdetail.end_date))])]),t._v(" "),a("li",[t._v("剩余天数："),a("span",[t._v(t._s(t.agreementdetail.due_time))])]),t._v(" "),t._l(t.fieldData,function(e,s){return a("li",{key:s},[t._v("\n                            "+t._s(e.name)+"："),a("span",[t._v(t._s(e.value))])])})],2),t._v(" "),1==t.agreementdetail.checkStatus?a("div",{staticClass:"agreeaudited"},[a("img",{staticClass:"audited_img",attrs:{src:t.auditing,alt:"审核中"}})]):t._e(),t._v(" "),2==t.agreementdetail.checkStatus?a("div",{staticClass:"agreeaudited"},[a("img",{staticClass:"audited_img",attrs:{src:t.audited,alt:"已审核"}})]):t._e(),t._v(" "),3==t.agreementdetail.checkStatus?a("div",{staticClass:"agreeaudited"},[a("img",{staticClass:"audited_img",attrs:{src:t.noaudit,alt:"未通过"}})]):t._e()]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.thisshow,expression:"!thisshow"}]})])],1),t._v(" "),a("div",{staticClass:"top"},[a("el-card",{staticClass:"box-card",model:{value:t.agreementdetail,callback:function(e){t.agreementdetail=e},expression:"agreementdetail"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-popover",{attrs:{placement:"right-start",width:"220",trigger:"click"}},[a("div",{staticStyle:{"max-height":"400px","overflow-y":"overlay"}},t._l(t.examineLog,function(e,s){return a("div",{key:s,staticClass:"examine_popover"},[a("span",{staticClass:"examine_ico"},[0==e.examineStatus?a("i",{staticClass:"el-icon-time",staticStyle:{"font-size":"20px"}}):t._e(),t._v(" "),1==e.examineStatus?a("i",{staticClass:"el-icon-circle-check-outline",staticStyle:{color:"#67c23a","font-size":"20px"}}):t._e(),t._v(" "),2==e.examineStatus?a("i",{staticClass:"el-icon-circle-close-outline",staticStyle:{color:"#f56c6c","font-size":"20px"}}):t._e(),t._v(" "),3==e.examineStatus?a("i",{staticClass:"el-icon-time",staticStyle:{color:"#e6a23c","font-size":"20px"}}):t._e(),t._v(" "),5==e.examineStatus?a("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{color:"#67c23a","font-size":"20px"}}):t._e()]),t._v(" "),a("div",{staticClass:"examint_msg"},[a("p",{staticStyle:{"font-size":"13px",color:"#aaaaaa"}},[t._v(t._s(e.examineTime))]),t._v(" "),1==e.examineStatus?a("p",[t._v(t._s(e.realname+" 已审核"))]):t._e(),t._v(" "),2==e.examineStatus?a("p",[t._v(t._s(e.realname+" 已拒绝"))]):t._e(),t._v(" "),a("div",{staticClass:"examint_remark"},[a("p",[t._v(t._s(e.remarks))])])])])})),t._v(" "),a("span",{staticStyle:{"font-size":"14px","text-decoration":"underline"},attrs:{slot:"reference"},slot:"reference"},[t._v("查看审核历史")])]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.hasCheck&&2!==t.agreementdetail.checkStatus,expression:"hasCheck && agreementdetail.checkStatus !== 2"}],staticClass:"info-btn",staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(e){t.showexamine(1)}}},[t._v("通过")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.hasCheck&&2!==t.agreementdetail.checkStatus,expression:"hasCheck && agreementdetail.checkStatus !== 2"}],staticClass:"info-btn",staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(e){t.showexamine(2)}}},[t._v("拒绝")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.hasCheck,expression:"hasCheck"}],staticClass:"info-btn",staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(e){t.showexamine(4)}}},[t._v("驳回")])],1),t._v(" "),a("div",{staticClass:"text item"},[a("div",{staticClass:"examine_c"},t._l(t.examineList,function(e,s){return a("div",{key:s,staticClass:"examine_item"},[a("el-popover",{staticClass:"examine_cont",attrs:{placement:"bottom",width:"220",trigger:"hover"}},[t._l(e.userList,function(e,s){return a("div",{key:s,staticClass:"examine_popover"},[a("span",{staticClass:"examine_ico"},[0==e.examineStatus?a("i",{staticClass:"el-icon-time",staticStyle:{"font-size":"20px"}}):t._e(),t._v(" "),1==e.examineStatus?a("i",{staticClass:"el-icon-success",staticStyle:{color:"#67c23a","font-size":"18px"}}):t._e(),t._v(" "),2==e.examineStatus?a("i",{staticClass:"el-icon-circle-close",staticStyle:{color:"#f56c6c","font-size":"20px"}}):t._e(),t._v(" "),3==e.examineStatus?a("i",{staticClass:"el-icon-time",staticStyle:{color:"#e6a23c","font-size":"20px"}}):t._e(),t._v(" "),5==e.examineStatus?a("i",{staticClass:"el-icon-circle-plus",staticStyle:{color:"#67c23a","font-size":"20px"}}):t._e()]),t._v(" "),a("div",{staticClass:"examint_msg"},[a("p",{staticStyle:{"font-size":"13px",color:"#aaaaaa"}},[t._v(t._s(e.examineTime))]),t._v(" "),a("span",[t._v(t._s(e.realname+"("+e.phone+")"))]),t._v(" "),0==e.examineStatus?a("p",[t._v("未审核此申请")]):t._e(),t._v(" "),1==e.examineStatus?a("p",[t._v("通过此申请")]):t._e(),t._v(" "),2==e.examineStatus?a("p",[t._v("拒绝此申请")]):t._e(),t._v(" "),5==e.examineStatus?a("p",[t._v("创建此申请")]):t._e()])])}),t._v(" "),a("div",{staticStyle:{width:"100%"},attrs:{slot:"reference"},slot:"reference"},[5==e.examineStatus||4==e.examineStatus?a("span",{staticClass:"examine_po"},[a("img",{staticClass:"examine_img",attrs:{src:e.headPortrait,width:"50",height:"50"}})]):t._e(),t._v(" "),2==e.stepType?a("span",{staticClass:"examine_po1"},[a("img",{staticClass:"examine_img",class:{mohu:1!==e.examineStatus},attrs:{src:e.headPortrait,width:"50",height:"50"}})]):t._e(),t._v(" "),3==e.stepType?a("div",{staticStyle:{display:"inline-block",margin:"0 15px"},style:e.type_style},t._l(e.userList,function(t,e){return a("span",{key:e,staticClass:"examine_po2"},[a("img",{staticClass:"examine_img",class:{mohu:0==t.examineStatus},attrs:{src:t.headPortrait,width:"50",height:"50"}})])})):t._e(),t._v(" "),a("br"),t._v(" "),e.examineUserName?a("span",{staticClass:"examine_type"},[t._v(t._s(e.examineUserName))]):t._e(),t._v(" "),2==e.stepType?a("span",{staticClass:"examine_type"},[t._v(t._s(e.userLength+"人或签"))]):t._e(),t._v(" "),3==e.stepType?a("span",{staticClass:"examine_type"},[t._v(t._s(e.userLength+"人会签"))]):t._e(),t._v(" "),a("br"),t._v(" "),0==e.examineStatus&&1==s?a("span",{staticClass:"examine_status"},[t._v("一级审核")]):t._e(),t._v(" "),0==e.examineStatus&&2==s?a("span",{staticClass:"examine_status"},[t._v("二级审核")]):t._e(),t._v(" "),0==e.examineStatus&&3==s?a("span",{staticClass:"examine_status"},[t._v("三级审核")]):t._e(),t._v(" "),0==e.examineStatus&&4==s?a("span",{staticClass:"examine_status"},[t._v("四级审核")]):t._e(),t._v(" "),0==e.examineStatus&&5==s?a("span",{staticClass:"examine_status"},[t._v("五级审核")]):t._e(),t._v(" "),0==e.examineStatus&&6==s?a("span",{staticClass:"examine_status"},[t._v("六级审核")]):t._e(),t._v(" "),1==e.examineStatus?a("span",{staticClass:"examine_status"},[a("i",{staticClass:"el-icon-success",staticStyle:{color:"#67c23a","font-size":"15px"}}),t._v(" 已审核")]):t._e(),t._v(" "),2==e.examineStatus?a("span",{staticClass:"examine_status"},[a("i",{staticClass:"el-icon-circle-close",staticStyle:{color:"#f56c6c","font-size":"18px"}}),t._v(" 未通过")]):t._e(),t._v(" "),3==e.examineStatus?a("span",{staticClass:"examine_status"},[a("i",{staticClass:"el-icon-time",staticStyle:{color:"#e6a23c","font-size":"18px"}}),t._v(" 审核中")]):t._e(),t._v(" "),5==e.examineStatus?a("span",{staticClass:"examine_status"},[a("i",{staticClass:"el-icon-circle-plus",staticStyle:{color:"#67c23a","font-size":"18px"}}),t._v(" 发起")]):t._e()])],2),t._v(" "),s!==t.examineList.length-1?a("span",{staticClass:"examine_next"},[a("i",{staticClass:"el-icon-arrow-right"})]):t._e()],1)}))])])],1),t._v(" "),a("div",{staticClass:"bottom"},[a("el-tabs",{attrs:{type:"card"},model:{value:t.activeName2,callback:function(e){t.activeName2=e},expression:"activeName2"}},[a("el-tab-pane",{attrs:{label:"跟进记录",name:"first"}},[a("el-form",{ref:"followform",staticClass:"followform",attrs:{rules:t.rules,model:t.followform}},[a("el-form-item",{attrs:{prop:"followContent"}},[a("el-input",{attrs:{type:"textarea",placeholder:"添加跟进内容"},model:{value:t.followform.followContent,callback:function(e){t.$set(t.followform,"followContent",e)},expression:"followform.followContent"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"联系方式",prop:"followType"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:t.followform.followType,callback:function(e){t.$set(t.followform,"followType",e)},expression:"followform.followType"}},t._l(t.followTypes,function(t){return a("el-option",{key:t.value,attrs:{value:t.label,label:t.label}})}))],1),t._v(" "),a("el-form-item",{staticStyle:{width:"290px"},attrs:{label:"联系人",prop:"contactsId"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:t.followform.contactsId,callback:function(e){t.$set(t.followform,"contactsId",e)},expression:"followform.contactsId"}},t._l(t.contactData,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"下次联系时间"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"12:00:00","picker-options":t.pickerOptions,placeholder:"选择日期时间"},model:{value:t.followform.contactTime,callback:function(e){t.$set(t.followform,"contactTime",e)},expression:"followform.contactTime"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"快捷沟通"}},t._l(t.fastcontactList,function(e){return a("el-radio",{key:e.id,attrs:{label:e.content},model:{value:t.followform.followContent,callback:function(e){t.$set(t.followform,"followContent",e)},expression:"followform.followContent"}},[t._v(t._s(e.typeName))])})),t._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"上传图片"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"file-list":t.imgList,action:"","auto-upload":!1,"on-change":t.beforeUploadimg}},[a("el-button",{staticClass:"info-btn",attrs:{size:"mini"}},[t._v("上传图片")])],1)],1),t._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"上传附件"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"file-list":t.filesList,action:"","auto-upload":!1,"on-change":t.beforeUploadfile}},[a("el-button",{staticClass:"info-btn",attrs:{size:"mini"}},[t._v("上传附件")])],1)],1),t._v(" "),a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{staticStyle:{"margin-top":"6px"},attrs:{type:"primary",size:"mini"},on:{click:t.Submitfollowform}},[t._v("立即提交")])],1)],1),t._v(" "),a("div",{staticStyle:{width:"100%",height:"10px"}}),t._v(" "),t._l(t.record,function(e){return a("ul",{key:e.followId,staticClass:"followrecord"},[a("li",{staticClass:"recordicon"},[a("img",{staticClass:"detail_portrait",attrs:{src:e.imgUrl,alt:"头像"}})]),t._v(" "),a("li",{staticClass:"verticalline"}),t._v(" "),a("li",{staticClass:"recordcontent"},[a("div",{staticClass:"left_more"},[a("p",[a("span",{staticClass:"de_span_2"},[t._v(t._s(e.contacts[0].name))]),t._v(" "),a("span",{staticClass:"de_span_1"},[t._v(" | ")]),t._v(" "),a("span",{staticClass:"de_span_1"},[t._v(t._s(e.createTime))]),t._v(" "),e.contactTime?a("span",{staticClass:"de_span_1"},[t._v("  --  ")]):t._e(),t._v(" "),a("span",{staticClass:"de_span_1"},[t._v(t._s(e.contactTime))]),t._v("\n                                      \n                                    "),a("span",{staticClass:"de_span_3"},[t._v("  "+t._s(e.followType)+"  ")])]),t._v(" "),a("div",{staticStyle:{"margin-top":"15px","margin-bottom":"15px"},domProps:{innerHTML:t._s(e.followContent)}}),t._v(" "),e.imgName?a("div",{staticClass:"imgbox_two"},[a("img",{attrs:{src:e.picture_detail,alt:"图片",width:"80",height:"80"},on:{click:function(a){t.showImg(a,e)}}})]):t._e(),t._v(" "),e.enclosureName?a("div",[a("a",{attrs:{href:e.enclosureUrl,download:""}},[t._v(t._s(e.enclosureOldName))])]):t._e(),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible2},on:{"update:visible":function(e){t.dialogVisible2=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl2,alt:""}})])],1)])])})],2),t._v(" "),a("el-tab-pane",{attrs:{label:"合同详情",name:"second"}},[a("div",{staticClass:"uploadBOX"},[t._l(t.fileList,function(e){return a("div",{key:e.id,staticClass:"imgbox",on:{mouseenter:function(a){t.mouseenterdiv(e)},mouseleave:function(a){t.mouseleavediv(e)}}},[a("img",{attrs:{src:e.imgURL,alt:"图片"},on:{click:function(a){t.showImg(a,e)}}}),t._v(" "),t.imgshow?a("i",{staticClass:"el-icon-circle-close-outline imgdel",on:{click:function(a){t.delImg(a,e)}}}):t._e()])}),t._v(" "),a("div",{staticClass:"filebox"},[a("span",{staticClass:"upload"},[a("input",{attrs:{type:"file",name:"file"},on:{change:function(e){t.tirggerFile(e)}}})])]),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],2),t._v(" "),a("div",{staticClass:"text",staticStyle:{height:"150px"}},[a("ul",[a("li",[t._v(" ")]),a("li",[t._v(" ")]),a("li",[t._v(" ")]),t._v(" "),a("li",[t._v("创建人："),a("span",[t._v(t._s(t.agreementdetail.private_employee))])]),t._v(" "),a("li",[t._v("创建人部门："),a("span",[t._v(t._s(t.agreementdetail.deptname))])]),t._v(" "),a("li",[t._v("创建人机构："),a("span",[t._v(t._s(t.agreementdetail.parentname))])]),t._v(" "),a("li",[t._v("创建时间："),a("span",[t._v(t._s(t.agreementdetail.create_time))])]),t._v(" "),a("li",[t._v("修改时间："),a("span",[t._v(t._s(t.agreementdetail.update_time))])])])])]),t._v(" "),a("el-tab-pane",{attrs:{label:"回款计划",name:"third"}},[a("div",{staticClass:"entry"},[a("el-button",{staticClass:"btn info-btn",attrs:{size:"mini"},on:{click:function(e){t.addplan()}}},[t._v("新增计划")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.moneyPlanList,border:"",stripe:"","summary-method":t.getSummaries,"show-summary":""}},[a("el-table-column",{attrs:{label:"期数",fixed:"","header-align":"center",align:"center",type:"index",width:"60"}}),t._v(" "),a("el-table-column",{attrs:{label:"公司名称",prop:"customerName","min-width":"200"}}),t._v(" "),a("el-table-column",{attrs:{label:"合同编号",prop:"contract_number","min-width":"150"}}),t._v(" "),a("el-table-column",{attrs:{label:"回款阶段",prop:"stage","min-width":"110"}}),t._v(" "),a("el-table-column",{attrs:{label:"预计回款金额",prop:"price","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                                "+t._s(t._f("commaing")(e.row.price))+"\n                            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"预计日期",prop:"date","min-width":"110"}}),t._v(" "),a("el-table-column",{attrs:{label:"提醒时间",prop:"remind_date","min-width":"150"}}),t._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"remarks","min-width":"180"}}),t._v(" "),t._l(t.backFieldData,function(t){return a("el-table-column",{key:t.field_name,attrs:{label:t.name,prop:t.field_name,"min-width":"130",sortable:""}})}),t._v(" "),t.moneyBackList.length?t._e():a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.editplan(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.delplan(e.$index,e.row)}}},[t._v("删除")])]}}])})],2),t._v(" "),a("br"),a("br"),t._v(" "),a("div",{staticClass:"entry"},[a("el-button",{staticClass:"btn info-btn",attrs:{size:"mini"},on:{click:function(e){t.addback()}}},[t._v("新增回款")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.moneyBackList,border:"",stripe:"","summary-method":t.getSummaries,"show-summary":""}},[a("el-table-column",{attrs:{label:"期数",fixed:"","header-align":"center",align:"center",type:"index",width:"60"}}),t._v(" "),a("el-table-column",{attrs:{label:"公司名称",prop:"customerName","min-width":"200"}}),t._v(" "),a("el-table-column",{attrs:{label:"合同编号",prop:"contract_number","min-width":"150"}}),t._v(" "),a("el-table-column",{attrs:{label:"回款阶段",prop:"back_plan","min-width":"110"}}),t._v(" "),a("el-table-column",{attrs:{label:"回款金额",prop:"price","min-width":"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                                "+t._s(t._f("commaing")(e.row.price))+"\n                            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"回款日期",prop:"createTime","min-width":"110"}}),t._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"remarks","min-width":"180"}}),t._v(" "),t._l(t.planFieldData,function(t){return a("el-table-column",{key:t.field_name,attrs:{label:t.name,prop:t.field_name,"min-width":"130",sortable:""}})}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",disabled:e.row.disabledBtn},on:{click:function(a){t.editback(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",disabled:e.row.disabledBtn,type:"danger"},on:{click:function(a){t.delback(e.$index,e.row)}}},[t._v("删除")])]}}])})],2)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"产品订单",name:"fourth"}},[a("div",{staticClass:"entry"},[a("el-button",{staticClass:"btn info-btn",attrs:{size:"mini",icon:"el-icon-circle-plus-outline"},on:{click:t.handleAdd}}),t._v(" "),a("el-popover",{attrs:{placement:"bottom",width:"100",trigger:"click"}},[a("el-checkbox-group",{staticClass:"checklist",staticStyle:{"max-height":"600px","overflow-y":"overlay","overflow-x":"hidden"},model:{value:t.checklist,callback:function(e){t.checklist=e},expression:"checklist"}},t._l(t.filterList,function(e){return a("el-checkbox",{key:e.id,staticClass:"checkone",attrs:{label:e.name,value:e.state},on:{change:function(a){t.hangleChange(a,e)}}})})),t._v(" "),a("el-button",{staticClass:"info-btn screen",attrs:{slot:"reference",icon:"el-icon-more",type:"mini"},slot:"reference"})],1)],1),t._v(" "),a("el-table",{attrs:{data:t.itemData,border:"","highlight-current-row":"","show-summary":"","summary-method":t.getSummary},on:{"cell-click":t.cellClick}},[a("el-table-column",{attrs:{"header-align":"center",fixed:"",align:"center",type:"index",width:"45"}}),t._v(" "),t._l(t.filterList,function(e,s){return a("div",{key:s},["goodsName"==e.prop&&1==e.state?a("el-table-column",{attrs:{label:"产品名称",prop:"tbGoods.goodsName","min-width":"280",fixed:""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?[a("el-select",{attrs:{placeholder:"请选择",filterable:"","filter-method":t.handleFilter},on:{focus:function(a){t.handleFoces(e.$index,e.row)}},model:{value:e.row.tbGoods.goodsName,callback:function(a){t.$set(e.row.tbGoods,"goodsName",a)},expression:"scope.row.tbGoods.goodsName"}},[a("el-option",{staticClass:"droplist",attrs:{value:e.row.tbGoods.goodsName}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.selectData,border:""},on:{"current-change":t.currentChange}},[a("el-table-column",{attrs:{"header-align":"center",type:"index","min-width":"45"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tbGoods.goodsName",label:"产品名称",width:"130"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tbGoods.describe","show-overflow-tooltip":"",label:"描述",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"goodspec",label:"规格属性","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.goodspec,function(e,s){return a("span",{key:s},[t._v(t._s(e.label+"："+e.value))])})}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"unit",label:"单位","min-width":"90"}})],1)],1)],1),t._v(" "),a("el-button",{staticClass:"btn info-btn",staticStyle:{width:"30px",height:"28px",padding:"0"},attrs:{size:"mini",icon:"el-icon-more"},on:{click:function(e){t.showDialog()}}})]:a("span",[t._v(t._s(e.row.tbGoods.goodsName))])]}}])}):t._e(),t._v(" "),"image"==e.prop&&1==e.state?a("el-table-column",{attrs:{label:"主图",prop:"productImg",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"right",width:"200",trigger:"hover"}},[a("img",{attrs:{src:e.row.productImg,alt:"",width:"200",height:"200"}}),t._v(" "),a("img",{attrs:{slot:"reference",src:e.row.productImg,alt:"",width:"80",height:"80"},slot:"reference"})])]}}])}):t._e(),t._v(" "),"describe"==e.prop&&1==e.state?a("el-table-column",{attrs:{label:"规格描述",prop:"tbGoods.describe","min-width":"120"}}):t._e(),t._v(" "),"spec"==e.prop&&1==e.state?a("el-table-column",{attrs:{label:"规格属性",prop:"goodspec","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.goodspec,function(e,s){return a("span",{key:s},[t._v(t._s(e.value+"/"))])})}}])}):t._e(),t._v(" "),"unit"==e.prop&&1==e.state?a("el-table-column",{attrs:{label:"单位",prop:"unit","min-width":"50"}}):t._e(),t._v(" "),"num"==e.prop&&1==e.state?a("el-table-column",{attrs:{prop:"num","min-width":"100",label:"数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?[a("el-input",{staticClass:"edit-input",attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'')",size:"small"},on:{input:function(a){t.handleinput(a,e.$index,e.row)}},model:{value:e.row.num,callback:function(a){t.$set(e.row,"num",a)},expression:"scope.row.num"}})]:a("span",[t._v(t._s(e.row.num))])]}}])}):t._e(),t._v(" "),"price"==e.prop&&1==e.state?a("el-table-column",{attrs:{prop:"price","min-width":"120",label:"单价"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?[a("el-input",{staticClass:"edit-input",attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'.')",size:"small"},on:{input:function(a){t.handleinput(a,e.$index,e.row)}},model:{value:e.row.price,callback:function(a){t.$set(e.row,"price",a)},expression:"scope.row.price"}})]:a("span",[t._v(t._s(e.row.price))])]}}])}):t._e(),t._v(" "),"amountOfMoney"==e.prop&&1==e.state?a("el-table-column",{attrs:{prop:"amountOfMoney","min-width":"120",label:"金额"}}):t._e(),t._v(" "),"discount"==e.prop&&1==e.state?a("el-table-column",{attrs:{prop:"discount","min-width":"90",label:"折扣"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?[a("el-input",{staticClass:"edit-input",attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'.')",size:"small"},on:{input:function(a){t.handleinput(a,e.$index,e.row,"discount")}},model:{value:e.row.discount,callback:function(a){t.$set(e.row,"discount",a)},expression:"scope.row.discount"}},[a("span",{staticStyle:{"margin-right":"5px","line-height":"34px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v("%")])])]:e.row.discount?a("span",[t._v(t._s(e.row.discount+" %"))]):t._e()]}}])}):t._e(),t._v(" "),"discountAmount"==e.prop&&1==e.state?a("el-table-column",{attrs:{prop:"discountAmount","min-width":"120",label:"折扣额"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?[a("el-input",{staticClass:"edit-input",attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'.')",size:"small"},on:{input:function(a){t.handleinput(a,e.$index,e.row,"discountAmount")}},model:{value:e.row.discountAmount,callback:function(a){t.$set(e.row,"discountAmount",a)},expression:"scope.row.discountAmount"}})]:a("span",[t._v(t._s(e.row.discountAmount))])]}}])}):t._e(),t._v(" "),"discountAfter"==e.prop&&1==e.state?a("el-table-column",{attrs:{prop:"discountAfter","min-width":"120",label:"折后金额"}}):t._e(),t._v(" "),"taxRate"==e.prop&&1==e.state?a("el-table-column",{attrs:{prop:"taxRate","min-width":"90",label:"税率"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?[a("el-input",{staticClass:"edit-input",attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'.')",size:"small"},on:{input:function(a){t.handleinput(a,e.$index,e.row)}},model:{value:e.row.taxRate,callback:function(a){t.$set(e.row,"taxRate",a)},expression:"scope.row.taxRate"}},[a("span",{staticStyle:{"margin-right":"5px","line-height":"34px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v("%")])])]:a("span",[t._v(t._s(e.row.taxRate))])]}}])}):t._e(),t._v(" "),"taxAmount"==e.prop&&1==e.state?a("el-table-column",{attrs:{prop:"taxAmount","min-width":"120",label:"税额"}}):t._e(),t._v(" "),"taxAfter"==e.prop&&1==e.state?a("el-table-column",{attrs:{prop:"taxAfter","min-width":"120",label:"税后金额"}}):t._e(),t._v(" "),"commitTime"==e.prop&&1==e.state?a("el-table-column",{attrs:{label:"交货日期",prop:"commitTime",width:"90"}}):t._e(),t._v(" "),"brand"==e.prop&&1==e.state?a("el-table-column",{attrs:{prop:"brand","min-width":"80",label:"产品品牌"}}):t._e(),t._v(" "),"remark"==e.prop&&1==e.state?a("el-table-column",{attrs:{label:"产品备注",prop:"tbGoods.remark",width:"120"}}):t._e(),t._v(" "),"remarks1"==e.prop&&1==e.state?a("el-table-column",{attrs:{label:"备注1",prop:"remarks1","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?[a("el-input",{staticClass:"edit-input",attrs:{size:"small"},model:{value:e.row.remarks1,callback:function(a){t.$set(e.row,"remarks1",a)},expression:"scope.row.remarks1"}})]:a("span",[t._v(t._s(e.row.remarks1))])]}}])}):t._e(),t._v(" "),"remarks2"==e.prop&&1==e.state?a("el-table-column",{attrs:{label:"备注2",prop:"remarks2","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?[a("el-input",{staticClass:"edit-input",attrs:{size:"small"},model:{value:e.row.remarks2,callback:function(a){t.$set(e.row,"remarks2",a)},expression:"scope.row.remarks2"}})]:a("span",[t._v(t._s(e.row.remarks2))])]}}])}):t._e()],1)}),t._v(" "),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作","min-width":"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{width:"30px",height:"30px",padding:"0"},attrs:{type:"success",plain:"",disabled:!e.row.edit,icon:"el-icon-circle-check-outline"},on:{click:function(a){t.confirmEdit(e.row)}}}),t._v(" "),a("el-button",{staticStyle:{width:"30px",height:"30px",padding:"0"},attrs:{type:"danger",plain:"",icon:"el-icon-delete"},on:{click:function(a){t.handleDelete(e.$index,e.row)}}})]}}])})],2),t._v(" "),a("div",{staticClass:"pro_sub_btn"},[a("el-button",{attrs:{type:"primary",disabled:t.isDisable},on:{click:t.onSubmit}},[t._v("立即提交")])],1)],1)],1)],1)]),t._v(" "),a("el-col",{staticClass:"right",staticStyle:{padding:"10px","min-height":"635px"},attrs:{span:6}},[a("div",{staticClass:"searchList",staticStyle:{width:"100%"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入公司名称"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.search(e):null}},model:{value:t.searchList.keyword,callback:function(e){t.$set(t.searchList,"keyword",e)},expression:"searchList.keyword"}}),t._v(" "),a("el-button",{attrs:{icon:"el-icon-search",type:"primary",size:"mini"},on:{click:function(e){t.search()}}})],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableDatas}},[a("el-table-column",{attrs:{label:"公司名称",prop:"poolName"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{on:{click:function(a){t.getRow(e.$index,e.row)}}},[t._v("\n                    "+t._s(e.row.poolName)+"\n                ")])]}}])})],1),t._v(" "),a("div",{staticClass:"block numberPage number"},[a("el-pagination",{attrs:{"current-page":t.page,"page-sizes":[20,30,50,100],"page-size":20,layout:"total, sizes, prev, next",total:t.tableNumber},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),a("el-dialog",{staticClass:"orderDialog",attrs:{title:"选择产品",visible:t.dialogVisible1,"close-on-click-modal":!1,width:"80%",center:""},on:{"update:visible":function(e){t.dialogVisible1=e}}},[a("div",{staticClass:"otherleftcontent"},[a("el-tree",{attrs:{"node-key":"id","highlight-current":"",accordion:"","expand-on-click-node":"",data:t.datalist,props:t.defaultProps,"default-expanded-keys":t.defaultkeys},on:{"node-click":t.handleNodeClick}})],1),t._v(" "),a("div",{staticClass:"otherightcontent"},[a("span",[t._v("产品名称：")]),a("el-input",{staticStyle:{width:"200px"},on:{input:t.addInput},model:{value:t.goodsName,callback:function(e){t.goodsName=e},expression:"goodsName"}}),t._v(" "),a("br"),a("br"),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",fit:""},on:{"selection-change":t.selectInfo}},[a("el-table-column",{attrs:{"header-align":"center",align:"center",type:"selection","min-width":"45"},on:{"selection-change":t.selectInfo}}),t._v(" "),a("el-table-column",{attrs:{prop:"tbGoods.goodsName",label:"产品名称",width:"130"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tbGoods.describe","show-overflow-tooltip":"",label:"描述",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"goodspec",label:"规格属性","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.goodspec,function(e,s){return a("span",{key:s},[t._v(t._s(e.label+"："+e.value))])})}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"unit",label:"单位",width:"90"}}),t._v(" "),a("el-table-column",{attrs:{prop:"brand",label:"品牌",width:"90"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer order_foot",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible1=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit()}}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"审核意见",visible:t.dialogVisibleexa,"close-on-click-modal":!1,width:"40%"},on:{"update:visible":function(e){t.dialogVisibleexa=e}}},[a("el-form",{ref:"exaform",attrs:{model:t.exaform,rules:t.rules}},[a("el-form-item",{attrs:{prop:"remarks"}},[a("el-input",{attrs:{type:"textarea",rows:"5",placeholder:"请输入审核意见（必填）"},model:{value:t.exaform.remarks,callback:function(e){t.$set(t.exaform,"remarks",e)},expression:"exaform.remarks"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisibleexa=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.toexamine()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"回款计划",visible:t.dialogVisible3,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(e){t.dialogVisible3=e}}},[a("el-form",{ref:"moneyPlan",attrs:{model:t.moneyPlan,rules:t.rules,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"总金额"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.moneyPlan.amount,callback:function(e){t.$set(t.moneyPlan,"amount",e)},expression:"moneyPlan.amount"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"剩余预计回款金额"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.moneyPlan.restamount,callback:function(e){t.$set(t.moneyPlan,"restamount",e)},expression:"moneyPlan.restamount"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!t.moneyPlan.id,expression:"!moneyPlan.id"}],attrs:{prop:"stage",label:"回款阶段"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择回款阶段"},model:{value:t.moneyPlan.stage,callback:function(e){t.$set(t.moneyPlan,"stage",e)},expression:"moneyPlan.stage"}},[a("el-option",{directives:[{name:"show",rawName:"v-show",value:t.moneyPlanList.length<1,expression:"moneyPlanList.length < 1"}],attrs:{value:"首笔款"}},[t._v("首笔款")]),t._v(" "),a("el-option",{attrs:{value:"阶段款"}},[t._v("阶段款")]),t._v(" "),a("el-option",{attrs:{value:"尾笔款"}},[t._v("尾笔款")])],1)],1),t._v(" "),a("el-form-item",{attrs:{prop:"price",label:"预计回款金额"}},[a("el-input",{attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'.')"},model:{value:t.moneyPlan.price,callback:function(e){t.$set(t.moneyPlan,"price",e)},expression:"moneyPlan.price"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"date",label:"预计回款时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},model:{value:t.moneyPlan.date,callback:function(e){t.$set(t.moneyPlan,"date",e)},expression:"moneyPlan.date"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"提醒时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"12:00:00",size:"small"},model:{value:t.moneyPlan.remind_date,callback:function(e){t.$set(t.moneyPlan,"remind_date",e)},expression:"moneyPlan.remind_date"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:t.moneyPlan.remarks,callback:function(e){t.$set(t.moneyPlan,"remarks",e)},expression:"moneyPlan.remarks"}})],1),t._v(" "),t._l(t.previewData,function(e){return a("el-form-item",{key:e.id,attrs:{label:e.name,prop:e.field_name,"label-width":"130px"}},["text"==e.formType||"email"==e.formType?a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}}):"textarea"==e.formType?a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",maxlength:e.max_length,placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}}):"number"==e.formType?a("el-input",{staticStyle:{width:"100%"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'')",placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}}):"floatnumber"==e.formType?a("el-input",{staticStyle:{width:"100%"},attrs:{onkeyup:"value=value.replace(/^\\D*(\\d*(?:\\.\\d{0,2})?).*$/g, '$1')",placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}}):"mobile"==e.formType?a("el-input",{staticStyle:{width:"100%"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'')",maxlength:11,placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}}):"select"==e.formType?a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}},t._l(e.setting,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})):"checkbox"==e.formType?a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}},t._l(e.setting,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})):"user"==e.formType?a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}},t._l(t.userData,function(t){return a("el-option",{key:t.private_id,attrs:{label:t.private_employee,value:t.private_id}})})):"structure"==e.formType?a("el-select",{staticClass:"noPadding_select",staticStyle:{width:"100%"},attrs:{placeholder:e.input_tips},model:{value:e.displayVal,callback:function(a){t.$set(e,"displayVal",a)},expression:"item.displayVal"}},[a("el-option",{staticClass:"droplist nopadding_option",attrs:{value:e.displayVal}},[a("el-tree",{ref:"tree",refInFor:!0,attrs:{"node-key":"deptid","highlight-current":"","default-expand-all":"","expand-on-click-node":!1,data:t.deptData,props:t.defaultProps},on:{"node-click":function(a){t.handlecheck(a,e)}}})],1)],1):"date"==e.formType?a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:e.input_tips,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}}):"datetime"==e.formType?a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:e.input_tips,format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}}):"file"==e.formType?a("el-upload",{staticClass:"upload-demo",attrs:{action:t.doUpload,"on-success":t.uploadSuccess,"before-upload":t.beforeUpload}},[a("el-button",{attrs:{size:"mini",type:"info-btn"}},[t._v("上传")]),t._v(" "),a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"-20px"},attrs:{slot:"tip"},slot:"tip"},[t._v(t._s(e.input_tips))])],1):t._e()],1)})],2),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible3=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.planSubmit()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"回款信息",visible:t.dialogVisible4,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(e){t.dialogVisible4=e}}},[a("el-form",{ref:"moneyBack",attrs:{model:t.moneyBack,rules:t.rules,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"预计回款金额"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.moneyBack.amount,callback:function(e){t.$set(t.moneyBack,"amount",e)},expression:"moneyBack.amount"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"剩余预计回款金额"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.moneyBack.restamount,callback:function(e){t.$set(t.moneyBack,"restamount",e)},expression:"moneyBack.restamount"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"back_plan_id",label:"回款阶段"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择回款阶段"},model:{value:t.moneyBack.back_plan_id,callback:function(e){t.$set(t.moneyBack,"back_plan_id",e)},expression:"moneyBack.back_plan_id"}},t._l(t.moneyPlanList,function(e){return a("el-option",{key:e.id,attrs:{label:e.stage,value:e.id}},[t._v(t._s(e.stage))])}))],1),t._v(" "),a("el-form-item",{attrs:{prop:"prices",label:"回款金额"}},[a("el-input",{attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'.')"},model:{value:t.moneyBack.price,callback:function(e){t.$set(t.moneyBack,"price",e)},expression:"moneyBack.price"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"createTime",label:"回款时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},model:{value:t.moneyBack.createTime,callback:function(e){t.$set(t.moneyBack,"createTime",e)},expression:"moneyBack.createTime"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"pay_type_id",label:"收款方式"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择收款方式"},model:{value:t.moneyBack.pay_type_id,callback:function(e){t.$set(t.moneyBack,"pay_type_id",e)},expression:"moneyBack.pay_type_id"}},t._l(t.payList,function(e){return a("el-option",{key:e.id,attrs:{label:e.typeName,value:e.id}},[t._v(t._s(e.typeName))])}))],1),t._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:t.moneyBack.remarks,callback:function(e){t.$set(t.moneyBack,"remarks",e)},expression:"moneyBack.remarks"}})],1),t._v(" "),t._l(t.previewData,function(e){return a("el-form-item",{key:e.id,attrs:{label:e.name,prop:e.field_name,"label-width":"130px"}},["text"==e.formType||"email"==e.formType?a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}}):"textarea"==e.formType?a("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",maxlength:e.max_length,placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}}):"number"==e.formType?a("el-input",{staticStyle:{width:"100%"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'')",placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}}):"floatnumber"==e.formType?a("el-input",{staticStyle:{width:"100%"},attrs:{onkeyup:"value=value.replace(/^\\D*(\\d*(?:\\.\\d{0,2})?).*$/g, '$1')",placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}}):"mobile"==e.formType?a("el-input",{staticStyle:{width:"100%"},attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'')",maxlength:11,placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}}):"select"==e.formType?a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}},t._l(e.setting,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})):"checkbox"==e.formType?a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}},t._l(e.setting,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})):"user"==e.formType?a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.input_tips},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}},t._l(t.userData,function(t){return a("el-option",{key:t.private_id,attrs:{label:t.private_employee,value:t.private_id}})})):"structure"==e.formType?a("el-select",{staticClass:"noPadding_select",staticStyle:{width:"100%"},attrs:{placeholder:e.input_tips},model:{value:e.displayVal,callback:function(a){t.$set(e,"displayVal",a)},expression:"item.displayVal"}},[a("el-option",{staticClass:"droplist nopadding_option",attrs:{value:e.displayVal}},[a("el-tree",{ref:"tree",refInFor:!0,attrs:{"node-key":"deptid","highlight-current":"","default-expand-all":"","expand-on-click-node":!1,data:t.deptData,props:t.defaultProps},on:{"node-click":function(a){t.handlecheck(a,e)}}})],1)],1):"date"==e.formType?a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:e.input_tips,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}}):"datetime"==e.formType?a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:e.input_tips,format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.default_value,callback:function(a){t.$set(e,"default_value",a)},expression:"item.default_value"}}):"file"==e.formType?a("el-upload",{staticClass:"upload-demo",attrs:{action:t.doUpload,"on-success":t.uploadSuccess,"before-upload":t.beforeUpload}},[a("el-button",{attrs:{size:"mini",type:"info-btn"}},[t._v("上传")]),t._v(" "),a("div",{staticClass:"el-upload__tip",staticStyle:{"margin-top":"-20px"},attrs:{slot:"tip"},slot:"tip"},[t._v(t._s(e.input_tips))])],1):t._e()],1)})],2),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible4=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.backSubmit()}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var p=a("VU/8")(u,m,!1,function(t){a("Vns1")},null,null);e.default=p.exports},Vns1:function(t,e){}});