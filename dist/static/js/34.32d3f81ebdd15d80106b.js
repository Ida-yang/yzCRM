webpackJsonp([34],{"4c8o":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("wtEF"),o=a("mtWM"),i=a.n(o),l=a("9igS"),n=(a("mw3O"),{name:"clueDetails",store:s.a,data:function(){return{detailData:null,pickerOptions:{disabledDate:function(t){return t.getTime()<Date.now()-864e5}},SMSform:{templateId:null},templateList:null,followform:{followType:"电话",contactTime:"",contactsId:"",followContent:"",state:"",imgName:null,enclosureName:null},newform:{},rules:{followContent:[{required:!0,message:"请输入跟进内容",trigger:"blur"}],contactsId:[{required:!0,message:"请选择联系人",trigger:"blur"}],followType:[{required:!0,message:"请选择联系方式",trigger:"blur"}],state:[{required:!0,message:"请选择状态",trigger:"blur"}],name:[{required:!0,message:"联系人名称不能为空",trigger:"blur"}],phone:[{required:!0,message:"手机号码不能为空",trigger:"blur"}]},followTypes:[{label:"电话",value:"1"},{label:"微信",value:"2"},{label:"QQ",value:"3"},{label:"邮箱",value:"4"},{label:"拜访",value:"5"}],stateList:null,searchList:{keyword:null},cluedetail:{},fieldData:[],contacts:{},record:null,fastcontactList:null,contactList:null,activeName2:"first",tableData:null,tableNumber:null,page:1,limit:20,thisshow:!0,idArr:{id:null},retracts:!0,priconList:null,contacts_id:null,countryId:null,Provinces:null,businessList:null,showbusiness:!1,showloading:!1,files:null,filesName:null,imgfile:null,imgName:null,fileList:[],imgList:[],website:"",dialogVisible2:!1,dialogImageUrl2:null,Enclosureclue:[],contactdialog:!1}},beforeRouteLeave:function(t,e,a){l.a.$off("clue"),a()},activated:function(){this.loadData(),this.loadCountry(),this.reload(),this.loadTemplate()},methods:{reload:function(){var t=this;l.a.$on("clue",function(e){e&&(t.$options.methods.loadData.bind(t)(),t.$options.methods.loadCountry.bind(t)())})},loadData:function(){this.detailData=this.$store.state.cluedetailsData.submitData,this.idArr.id=this.$store.state.cluedetailsData.submitData.id;var t=this,e=a("1nuA"),s={};s.page=this.page,s.limit=this.limit;var o={type:"快捷方式"},l={label:1,id:this.detailData.id};i()({method:"post",url:t.$store.state.defaultHttp+"typeInfo/getTypeInfoGroupByType.do?cId="+t.$store.state.iscId,data:e.stringify(o)}).then(function(e){t.fastcontactList=e.data}).catch(function(t){}),i()({method:"post",url:t.$store.state.defaultHttp+"customerTwo/getUserByClue.do?cId="+t.$store.state.iscId+"&pId="+t.$store.state.ispId,data:e.stringify(s)}).then(function(e){t.tableData=e.data.map.success,t.tableNumber=e.data.count}).catch(function(t){}),i()({method:"get",url:t.$store.state.defaultHttp+"getFollowStaff.do?cId="+t.$store.state.iscId+"&customertwoId="+this.detailData.id}).then(function(e){t.record=e.data.map.success,t.record.forEach(function(e){e.showdelico=!1;var a=Date.parse(e.createTime),s=(new Date).getTime()-a;s<72e5&&(e.showdelico=!0),s>72e5&&(e.showdelico=!1),e.userImagName&&(e.imgUrl=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.userImagName),e.userImagName&&null!=e.userImagName||(e.imgUrl=t.$store.state.systemHttp+"/upload/staticImg/avatar.jpg"),e.imgName&&null!==e.imgName&&(e.picture_detail=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.imgName),e.enclosureName&&null!==e.enclosureName&&(e.enclosureUrl=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.enclosureName),e.followContent=e.followContent.replace(/\n/g,"<br/>")}),t.record[0]?(t.followform.state=t.record[0].state,t.loadState()):t.loadState()}).catch(function(t){}),i()({method:"get",url:t.$store.state.defaultHttp+"customerTwo/selectByPrimaryKey.do?cId="+t.$store.state.iscId+"&id="+this.detailData.id}).then(function(e){t.cluedetail=e.data,t.contacts=e.data.contacts[0],t.showbusiness=!1}).catch(function(t){}),i()({method:"post",url:t.$store.state.defaultHttp+"field/information.do?cId="+t.$store.state.iscId,data:e.stringify(l)}).then(function(e){t.fieldData=e.data}).catch(function(t){}),t.$options.methods.loadContact.bind(t)()},loadContact:function(){var t=this,e=a("1nuA"),s={};s.page=this.page,s.limit=this.limit,i()({method:"post",url:t.$store.state.defaultHttp+"customerTwo/getClueContacts.do?cId="+t.$store.state.iscId+"&customeroneId="+this.detailData.id,data:e.stringify(s)}).then(function(e){t.contactList=e.data.map.success,t.priconList=e.data.map.success,t.followform.contactsId=e.data.map.success[0].id}).catch(function(t){})},loadState:function(){var t=this,e=a("1nuA"),s={type:"线索状态"};i()({method:"post",url:t.$store.state.defaultHttp+"typeInfo/getTypeInfoGroupByType.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){t.stateList=e.data.slice(1),t.stateList.forEach(function(e){t.followform.state==e.typeName&&(t.followform.state=e.id)})}).catch(function(t){})},loadTemplate:function(){var t=this,e=a("1nuA"),s={type:"线索",genre:"营销类",status:"2"};i()({method:"post",url:t.$store.state.defaultHttp+"template/selectTemplate.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){t.templateList=e.data.map.templates}).catch(function(t){})},loadCountry:function(){var t=this;i()({method:"get",url:t.$store.state.defaultHttp+"address/getAddress.do?id="}).then(function(e){t.Provinces=e.data}).catch(function(t){})},choosePri:function(t){var e=this,s=a("1nuA"),o={};o.contacts_id=t,i()({method:"post",url:e.$store.state.defaultHttp+"contacts/updateFirst.do?cId="+e.$store.state.iscId+"&customeroneId="+this.detailData.id,data:s.stringify(o)}).then(function(t){t.data.msg&&"success"==t.data.msg?e.$options.methods.loadData.bind(e)():e.$message({message:"可能出了点什么问题，再看看",type:"error"})}).catch(function(t){})},retract:function(){this.thisshow=!this.thisshow,this.retracts=!this.retracts},getRow:function(t,e){this.$store.state.cluedetailsData.submitData={id:e.id},this.idArr.id=e.id,this.countryId=null,this.$options.methods.loadData.bind(this)(!0)},cluePool:function(){var t=this,e=a("1nuA"),s=[];s.id=this.idArr.id,i()({method:"post",url:t.$store.state.defaultHttp+"customerTwo/updateState.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){e.data&&"success"==e.data?(t.$message({message:"转移成功",type:"success"}),t.closeTag()):e.data.msg&&"error"==e.data.msg?t.$message({message:"对不起，您没有该权限，请联系管理员开通",type:"error"}):t.$message({message:e.data,type:"error"})}).catch(function(e){t.$message.error("转移失败,请重新转移")})},customerSwitching:function(){var t=this,e=a("1nuA"),s=[];s.id=this.idArr.id,s.shift(),s.secondid=this.$store.state.deptid,i()({method:"post",url:t.$store.state.defaultHttp+"customerTwo/insert.do?cId="+t.$store.state.iscId+"&pId="+t.$store.state.ispId,data:e.stringify(s)}).then(function(e){e.data.code&&200==e.data.code?(t.$message({message:"转换成功",type:"success"}),t.closeTag()):e.data.msg&&"error"==e.data.msg?t.$message({message:"对不起，您没有该权限，请联系管理员开通",type:"error"}):t.$message({message:e.data,type:"error"})}).catch(function(e){t.$message.error("转移失败,请重新转移")})},deletefollow:function(t){var e=this,s=a("1nuA"),o={};o.followId=this.record[t].followId,i()({method:"post",url:e.$store.state.defaultHttp+"delFollow.do?cId="+e.$store.state.iscId,data:s.stringify(o)}).then(function(t){t.data&&"1"==t.data?(e.$message({message:"删除成功",type:"success"}),e.$store.state.cluedetailsData.submitData={id:e.detailData.id},e.$options.methods.loadData.bind(e)(!0)):e.$message({message:t.data,type:"error"})}).catch(function(t){e.$message.error("删除失败,请重新删除")})},searchBusiness:function(t){this.showloading=!0;var e=this,s=a("1nuA"),o={};o.name=this.cluedetail.name,o.countryId=this.countryId,i()({method:"post",url:e.$store.state.defaultHttp+"businessData/getBusinessData.do",data:s.stringify(o)}).then(function(t){t.data.code&&"200"==t.data.code&&t.data.map.businessDatas?(e.businessList=t.data.map.businessDatas[0],e.showloading=!1,e.showbusiness=!0,i()({method:"post",url:e.$store.state.defaultHttp+"businessData/insertBusinessData.do",data:s.stringify(o)}).then(function(t){}).catch(function(t){})):e.$message({message:"没有匹配的信息",type:"error"})}).catch(function(t){e.$message.error("服务器开小差了,请稍候重试")})},clickRefresh:function(){var t=this,e=a("1nuA"),s={};s.id=this.businessList.id,s.customeroneId=this.detailData.id,s.countryId=this.countryId,this.cluedetail.name==this.businessList.screenName?i()({method:"post",url:t.$store.state.defaultHttp+"customerTwo/updateBusinessData.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){e.data.code&&"200"==e.data.code?(t.$message({message:"更新成功",type:"success"}),t.$options.methods.loadData.bind(t)(!0)):t.$message({message:e.data.msg,type:"error"})}).catch(function(e){t.$message.error("更新失败,请重新更新")}):t.$message({message:"该公司与匹配的公司名称不一致，无法更新",type:"error"})},showImg:function(t,e){this.dialogImageUrl2=this.$store.state.systemHttp+"/upload/"+this.$store.state.iscId+"/"+e.imgName,this.dialogVisible2=!0},changeState:function(t){var e=this,s=a("1nuA"),o={};o.id=t.id,o.status=t.status,i()({method:"post",url:e.$store.state.defaultHttp+"contacts/updateStatus.do?cId="+e.$store.state.iscId,data:s.stringify(o)}).then(function(t){t.data.code&&"200"==t.data.code?e.$options.methods.loadData.bind(e)():e.$message({message:"可能出了点什么问题，再看看",type:"error"})}).catch(function(t){})},changePrimary:function(t){var e=this,s=a("1nuA"),o={};o.id=t.id,o.isCrux=t.isCrux,i()({method:"post",url:e.$store.state.defaultHttp+"contacts/updateIsCrux.do?cId="+e.$store.state.iscId,data:s.stringify(o)}).then(function(t){t.data.code&&"200"==t.data.code?e.$options.methods.loadData.bind(e)():e.$message({message:"可能出了点什么问题，再看看",type:"error"})}).catch(function(t){})},addcontact:function(){var t=this;i()({method:"get",url:t.$store.state.defaultHttp+"contactsJurisdiction/insert.do"}).then(function(e){e.data.msg&&"error"==e.data.msg?t.$message({message:"对不起，您没有该权限，请联系管理员开通",type:"error"}):(t.contactdialog=!0,t.newform={pName:t.cluedetail.name,name:null,phone:null,telephone:null,qq:null,email:null,weChat:null,sex:null,birthday:null,identity:null,remark:null})}).catch(function(t){})},submitcontact:function(){var t=this,e=a("1nuA"),s={poolName:this.cluedetail.name,customeroneId:this.cluedetail.id,name:this.newform.name,phone:this.newform.phone,telephone:this.newform.telephone,qq:this.newform.qq,email:this.newform.email,weChat:this.newform.weChat,sex:this.newform.sex,birthday:this.newform.birthday,identity:this.newform.identity,remark:this.newform.remark,pId:this.$store.state.ispId,secondid:this.$store.state.deptid,deptid:this.$store.state.insid},o=!1;s.name||(t.$message({message:"联系人名称不能为空",type:"error"}),o=!0),s.phone||(t.$message({message:"手机号码不能为空",type:"error"}),o=!0),o||i()({method:"post",url:t.$store.state.defaultHttp+"insertContacts.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){e.data.code&&"200"==e.data.code?(t.$message({message:"添加成功",type:"success"}),t.contactdialog=!1,t.$options.methods.loadContact.bind(t)()):t.$message({message:e.data.msg,type:"error"})}).catch(function(t){})},tabClick:function(t){var e=this;2==t.index&&(this.website="http://"+this.cluedetail.url),3==t.index&&(this.Enclosureclue=[],this.record.forEach(function(t){t.enclosureName&&e.Enclosureclue.push({name:t.enclosureOldName,src:e.$store.state.systemHttp+"upload/"+e.$store.state.iscId+"/"+t.enclosureName,uploads:t.private_employee,uploadTime:t.createTime})}))},beforeUploadimg:function(t,e){this.imgfile=t.raw;var a="jpg"===t.name.split(".")[1],s="png"===t.name.split(".")[1],o="jpeg"===t.name.split(".")[1],i=t.size/1024/1024<.5;return a||s||o?i?(this.imgName=t.name,void this.imgList.push({name:t.name})):(this.$message.warning("图片大小不能超过 500KB!"),!1):(this.$message.warning("图片只能是 jpg、png、jpeg格式!"),!1)},beforeUploadfile:function(t,e){this.files=t.raw;var a="xls"===t.name.split(".")[1],s="xlsx"===t.name.split(".")[1],o="doc"===t.name.split(".")[1],i="docx"===t.name.split(".")[1],l=t.size/1024/1024<5;return a||s||o||i?l?(this.filesName=t.name,void this.fileList.push({name:t.name})):(this.$message.warning("附件大小不能超过 5MB!"),!1):(this.$message.warning("附件只能是 xls、xlsx、doc、docx格式!"),!1)},Submitfollowform:function(){var t=this,e=(a("1nuA"),new FormData);e.append("followType",this.followform.followType),e.append("contactTime",this.followform.contactTime),e.append("followContent",this.followform.followContent),e.append("contactsId",this.followform.contactsId),e.append("follow_state",this.followform.state),e.append("customertwo_id",this.detailData.id),e.append("deptid",this.$store.state.insid),e.append("secondid",this.$store.state.deptid),e.append("imgNames",this.imgfile),e.append("enclosureNames",this.files),this.followform.followContent?this.followform.state?i()({method:"get",url:t.$store.state.defaultHttp+"clueJurisdiction/follow.do"}).then(function(a){a.data.msg&&"error"==a.data.msg?t.$message({message:"对不起，您没有该权限，请联系管理员开通",type:"error"}):i()({method:"post",url:t.$store.state.defaultHttp+"addFollow.do?cId="+t.$store.state.iscId+"&pId="+t.$store.state.ispId,headers:{"Content-Type":"multipart/form-data"},data:e}).then(function(e){e.data.msg&&"success"==e.data.msg?t.$message({message:"提交成功",type:"success"}):t.$message({message:e.data.msg,type:"error"}),t.followform.contactTime="",t.followform.followContent="",t.followform.imgName="",t.followform.enclosureName="",t.fileList=[],t.imgList=[],t.imgfile=null,t.files=null,t.$store.state.cluedetailsData.submitData={id:t.detailData.id},t.$options.methods.loadData.bind(t)(!0)}).catch(function(e){t.$message.error("提交失败,请重新提交")})}).catch(function(t){}):t.$message({message:"跟进状态不能为空",type:"error"}):t.$message({message:"跟进内容不能为空",type:"error"})},closeTag:function(){var t=this,e=void 0;this.$store.state.tagsList.forEach(function(a,s){a.name==t.$options.name&&(e=s)});var a=this.$store.state.tagsList.splice(e,1)[0];(this.$store.state.tagsList[e]?this.$store.state.tagsList[e]:this.$store.state.tagsList[e-1])?a.path===this.$route.fullPath&&this.$router.push("/clue"):this.$router.push("/index")},search:function(){var t=this,e=a("1nuA"),s={};s.searchName=this.searchList.keyword,s.page=this.page,s.limit=this.limit,i()({method:"post",url:t.$store.state.defaultHttp+"customerTwo/getUserByClue.do?cId="+t.$store.state.iscId+"&pId="+t.$store.state.ispId,data:e.stringify(s)}).then(function(e){t.tableData=e.data.map.success,t.tableNumber=e.data.count}).catch(function(t){})},handleSizeChange:function(t){this.limit=t,this.$options.methods.loadData.bind(this)()},handleCurrentChange:function(t){this.page=t,this.$options.methods.loadData.bind(this)()},sendSMS:function(){var t=this,e=a("1nuA"),s={};s.names=[this.cluedetail.name],s.phones=[this.contacts.phone],s.contacts=[this.contacts.coName],s.templateId=this.SMSform.templateId,i()({method:"get",url:t.$store.state.defaultHttp+"clueJurisdiction/send.do"}).then(function(a){a.data.msg&&"error"==a.data.msg?t.$message({message:"对不起，您没有该权限，请联系管理员开通",type:"error"}):i()({method:"post",url:t.$store.state.defaultHttp+"message/sendMarketingMsg.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){e.data.code&&"200"==e.data.code?(t.$message({message:"发送成功",type:"success"}),t.$options.methods.addSMSsended.bind(t)()):t.$message({message:e.data.msg,type:"error"})}).catch(function(t){})}).catch(function(t){})},addSMSsended:function(){var t=this,e=a("1nuA"),s={type:"线索"};s.ids=[this.cluedetail.id],s.names=[this.cluedetail.name],s.phones=[this.contacts.phone],s.contacts=[this.contacts.coName],s.templateId=this.SMSform.templateId,s.pId=this.$store.state.ispId,s.secondid=this.$store.state.deptid,s.deptid=this.$store.state.insid,i()({method:"post",url:t.$store.state.defaultHttp+"sendRecord/insertSendRecord.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){e.data.code&&"200"==e.data.code?t.$message({message:"发送成功",type:"success"}):t.$message({message:e.data.msg,type:"error"})}).catch(function(t){})}}}),r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticClass:"cluedetcontent",attrs:{gutter:10}},[a("el-col",{attrs:{span:18}},[a("div",{staticClass:"top"},[a("el-card",{staticClass:"box-card",model:{value:t.cluedetail,callback:function(e){t.cluedetail=e},expression:"cluedetail"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"bold_span"},[t._v(t._s(t.cluedetail.name))]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.retracts,expression:"retracts"}],staticClass:"info-btn",staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(e){t.retract()}}},[t._v("显示")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.retracts,expression:"!retracts"}],staticClass:"info-btn",staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(e){t.retract()}}},[t._v("收起")]),t._v(" "),a("el-popover",{attrs:{placement:"bottom",width:"100",trigger:"click"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.SMSform.templateId,callback:function(e){t.$set(t.SMSform,"templateId",e)},expression:"SMSform.templateId"}},t._l(t.templateList,function(t){return a("el-option",{key:t.templateId,attrs:{label:t.title,value:t.templateId}})})),t._v(" "),a("br"),a("br"),a("br"),t._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.sendSMS()}}},[t._v("确定")])],1),t._v(" "),a("el-button",{staticClass:"info-btn",staticStyle:{float:"right"},attrs:{slot:"reference",type:"mini"},slot:"reference"},[t._v("发送短信")])],1),t._v(" "),a("el-button",{staticClass:"info-btn",staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(e){t.cluePool()}}},[t._v("转移至线索池")]),t._v(" "),a("el-button",{staticClass:"info-btn",staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(e){t.customerSwitching()}}},[t._v("转移至客户")])],1),t._v(" "),a("div",{staticClass:"text item"},[a("ul",[a("li",[t._v("姓名："),a("span",[t._v(t._s(t.contacts.coName))])]),t._v(" "),a("li",[t._v("手机："),a("span",[t._v(t._s(t.contacts.phone))])]),t._v(" "),a("li",[t._v("电话："),a("span",[t._v(t._s(t.contacts.telephone))])]),t._v(" "),a("li",[t._v("邮箱："),a("span",[t._v(t._s(t.contacts.email))])]),t._v(" "),a("li",[t._v("QQ："),a("span",[t._v(t._s(t.contacts.qq))])]),t._v(" "),a("li",[t._v("微信："),a("span",[t._v(t._s(t.contacts.wechat))])]),t._v(" "),a("li",[t._v("职务："),a("span",[t._v(t._s(t.contacts.identity))])]),t._v(" "),a("li",[t._v("性别："),a("span",[t._v(t._s(t.contacts.sex))])]),t._v(" "),a("li",[t._v("网址："),a("span",[t._v(t._s(t.cluedetail.url))])]),t._v(" "),a("li",[t._v("地址："),a("span",[t._v(t._s(t.cluedetail.address))])]),t._v(" "),a("li",[t._v("备注："),a("span",[t._v(t._s(t.cluedetail.remark))])]),t._v(" "),t._l(t.fieldData,function(e,s){return a("li",{key:s},[t._v("\n                            "+t._s(e.name)+"："),a("span",[t._v(t._s(e.value))])])})],2)])])],1),t._v(" "),a("div",{staticClass:"top"},[a("el-card",{directives:[{name:"show",rawName:"v-show",value:!t.thisshow,expression:"!thisshow"}],staticClass:"box-card",model:{value:t.cluedetail,callback:function(e){t.cluedetail=e},expression:"cluedetail"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("辅助信息")]),t._v(" "),a("el-popover",{attrs:{placement:"left",width:"350",trigger:"click"}},[a("div",{staticStyle:{padding:"5px",color:"red"}},[t._v("智能补全必须选择客户所在省份")]),t._v(" "),a("el-select",{staticStyle:{width:"90%"},on:{change:t.searchBusiness},model:{value:t.countryId,callback:function(e){t.countryId=e},expression:"countryId"}},t._l(t.Provinces,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id,placeholder:"请选择省份"}})})),t._v(" "),t.showloading?a("div",{staticClass:"load_icon"},[a("span",[a("i",{staticClass:"el-icon-loading"}),t._v("加载中，请稍候...")])]):t._e(),t._v(" "),t.showbusiness?a("ul",{staticClass:"ul_business"},[a("li",[a("span",[t._v("匹配公司：")]),t._v(t._s(t.businessList.screenName||"无"))]),t._v(" "),a("li",[a("span",[t._v("公司地址：")]),t._v(t._s(t.businessList.address||"无"))]),t._v(" "),a("li",[a("span",[t._v("法人代表：")]),t._v(t._s(t.businessList.legalRepresentative||"无"))]),t._v(" "),a("li",[a("span",[t._v("营业状态：")]),t._v(t._s(t.businessList.businessStatus||"无"))]),t._v(" "),a("li",[a("span",[t._v("登记机关：")]),t._v(t._s(t.businessList.aicBureau||"无"))]),t._v(" "),a("li",[a("span",[t._v("社会信用代码：")]),t._v(t._s(t.businessList.creditCode||"无"))]),t._v(" "),a("li",[a("span",[t._v("注册号：")]),t._v(t._s(t.businessList.licenseNo||"无"))]),t._v(" "),a("li",[a("span",[t._v("组织机构代码：")]),t._v(t._s(t.businessList.orgCode||"无"))]),t._v(" "),a("li",[a("span",[t._v("成立时间：")]),t._v(t._s(t.businessList.startupDate||"无"))])]):t._e(),t._v(" "),t.showbusiness?a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:t.clickRefresh}},[t._v("确定")]):t._e(),t._v(" "),a("el-button",{staticClass:"btn_refresh",attrs:{slot:"reference",size:"mini"},slot:"reference"},[t._v("智能补全")])],1)],1),t._v(" "),a("div",{staticClass:"text item"},[a("ul",[a("br"),t._v(" "),a("li",[t._v("法人代表："),a("span",[t._v(t._s(t.cluedetail.representative))])]),t._v(" "),a("li",[t._v("行业："),a("span",[t._v(t._s(t.cluedetail.industryType))])]),t._v(" "),a("li",[t._v("社会信用代码："),a("span",[t._v(t._s(t.cluedetail.creditCode))])]),t._v(" "),a("li",[t._v("公司类型："),a("span",[t._v(t._s(t.cluedetail.companyType))])]),t._v(" "),a("li",[t._v("企业规模："),a("span",[t._v(t._s(t.cluedetail.enterpriseScale))])]),t._v(" "),a("li",[t._v("注册号："),a("span",[t._v(t._s(t.cluedetail.registrationNumber))])]),t._v(" "),a("li",[t._v("融资状态："),a("span",[t._v(t._s(t.cluedetail.financingState))])]),t._v(" "),a("li",[t._v("营业状态："),a("span",[t._v(t._s(t.cluedetail.operatingState))])]),t._v(" "),a("li",[t._v("组织机构代码："),a("span",[t._v(t._s(t.cluedetail.organizationCode))])]),t._v(" "),a("li",[t._v("注册资金："),a("span",[t._v(t._s(t.cluedetail.capital))])]),t._v(" "),a("li",[t._v("登记机关："),a("span",[t._v(t._s(t.cluedetail.registrationAuthority))])]),t._v(" "),a("li",[t._v("成立时间："),a("span",[t._v(t._s(t.cluedetail.date))])])])])])],1),t._v(" "),a("div",{staticClass:"bottom"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.tabClick},model:{value:t.activeName2,callback:function(e){t.activeName2=e},expression:"activeName2"}},[a("el-tab-pane",{attrs:{label:"跟进记录",name:"first"}},[a("el-form",{ref:"followform",staticClass:"followform",attrs:{rules:t.rules,model:t.followform}},[a("el-form-item",{attrs:{prop:"followContent"}},[a("el-input",{attrs:{type:"textarea",placeholder:"添加跟进内容"},model:{value:t.followform.followContent,callback:function(e){t.$set(t.followform,"followContent",e)},expression:"followform.followContent"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"联系方式",prop:"followType"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:t.followform.followType,callback:function(e){t.$set(t.followform,"followType",e)},expression:"followform.followType"}},t._l(t.followTypes,function(t){return a("el-option",{key:t.value,attrs:{value:t.label,label:t.label}})}))],1),t._v(" "),a("el-form-item",{staticStyle:{width:"290px"},attrs:{label:"联系人",prop:"contactsId"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:t.followform.contactsId,callback:function(e){t.$set(t.followform,"contactsId",e)},expression:"followform.contactsId"}},t._l(t.contactList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-form-item",{staticStyle:{width:"275px"},attrs:{label:"状态",prop:"state"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:t.followform.state,callback:function(e){t.$set(t.followform,"state",e)},expression:"followform.state"}},t._l(t.stateList,function(t){return a("el-option",{key:t.id,attrs:{label:t.typeName,value:t.id}})}))],1),t._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"下次联系时间"}},[a("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"12:00:00","picker-options":t.pickerOptions,placeholder:"选择日期时间"},model:{value:t.followform.contactTime,callback:function(e){t.$set(t.followform,"contactTime",e)},expression:"followform.contactTime"}})],1),t._v(" "),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"快捷沟通"}},t._l(t.fastcontactList,function(e){return a("el-radio",{key:e.id,attrs:{label:e.content},model:{value:t.followform.followContent,callback:function(e){t.$set(t.followform,"followContent",e)},expression:"followform.followContent"}},[t._v(t._s(e.typeName))])})),t._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"上传图片"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"file-list":t.imgList,action:"","auto-upload":!1,"on-change":t.beforeUploadimg}},[a("el-button",{staticClass:"info-btn",attrs:{size:"mini"}},[t._v("上传图片")])],1)],1),t._v(" "),a("el-form-item",{staticStyle:{width:"300px"},attrs:{label:"上传附件"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"file-list":t.fileList,action:"","auto-upload":!1,"on-change":t.beforeUploadfile}},[a("el-button",{staticClass:"info-btn",attrs:{size:"mini"}},[t._v("上传附件")])],1)],1),t._v(" "),a("el-button",{staticStyle:{"margin-top":"6px",float:"right"},attrs:{type:"primary",size:"mini"},on:{click:t.Submitfollowform}},[t._v("立即提交")])],1),t._v(" "),a("div",{staticStyle:{width:"100%",height:"10px"}}),t._v(" "),t._l(t.record,function(e,s){return a("ul",{key:e.followId,staticClass:"followrecord"},[a("li",{staticClass:"recordicon"},[a("img",{staticClass:"detail_portrait",attrs:{src:e.imgUrl,alt:e.private_employee,title:e.private_employee}})]),t._v(" "),a("li",{staticClass:"verticalline"}),t._v(" "),a("li",{staticClass:"recordcontent"},[a("div",{staticClass:"left_more"},[a("p",[a("span",{staticClass:"de_span_2"},[t._v(t._s(e.contacts[0].name))]),t._v(" "),a("span",{staticClass:"de_span_1"},[t._v(" | ")]),t._v(" "),a("span",{staticClass:"de_span_1"},[t._v(t._s(e.createTime))]),t._v(" "),e.contactTime?a("span",{staticClass:"de_span_1"},[t._v("  --  ")]):t._e(),t._v(" "),a("span",{staticClass:"de_span_1"},[t._v(t._s(e.contactTime))]),t._v("\n                                      \n                                    "),a("span",{staticClass:"de_span_2"},[t._v(t._s(e.state))]),t._v("\n                                      \n                                    "),a("span",{staticClass:"de_span_3"},[t._v("  "+t._s(e.followType)+"  ")])]),t._v(" "),a("div",{staticStyle:{"margin-top":"15px","margin-bottom":"15px"},domProps:{innerHTML:t._s(e.followContent)}}),t._v(" "),e.imgName?a("div",{staticClass:"imgbox_two"},[a("img",{attrs:{src:e.picture_detail,alt:"图片",width:"80",height:"80"},on:{click:function(a){t.showImg(a,e)}}})]):t._e(),t._v(" "),e.enclosureName?a("div",[a("a",{attrs:{href:e.enclosureUrl,download:""}},[t._v(t._s(e.enclosureOldName))])]):t._e(),t._v(" "),a("p",{staticClass:"de_span_1"},[t._v(t._s(e.inputType))]),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible2},on:{"update:visible":function(e){t.dialogVisible2=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl2,alt:""}})])],1),t._v(" "),e.showdelico?a("div",{staticClass:"right_more"},[a("el-dropdown",{staticClass:"clue_drop",attrs:{trigger:"click"},on:{command:function(e){t.deletefollow(s)}}},[a("span",{staticClass:"el-dropdown-link"},[t._v("更多"),a("i",{staticClass:"el-icon-caret-bottom"})]),t._v(" "),a("el-dropdown-menu",{staticClass:"drop_item",attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"del"}},[t._v("删除")])],1)],1)],1):t._e()])])})],2),t._v(" "),a("el-tab-pane",{attrs:{label:"联系人",name:"second"}},[a("div",{staticClass:"entry"},[a("el-button",{staticClass:"btn info-btn",attrs:{size:"mini"},on:{click:function(e){t.addcontact()}}},[t._v("新增联系人")]),t._v(" "),a("div",{staticClass:"screen"},[a("span",{staticStyle:{"font-size":"14px"}},[t._v("首要联系人")]),t._v(" "),a("el-select",{staticClass:"pricon_sel",attrs:{placeholder:"请选择"},on:{change:t.choosePri},model:{value:t.contacts_id,callback:function(e){t.contacts_id=e},expression:"contacts_id"}},t._l(t.priconList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.contactList,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"联系人名称","min-width":"120",prop:"name"}}),t._v(" "),a("el-table-column",{attrs:{label:"手机","min-width":"110",prop:"phone"}}),t._v(" "),a("el-table-column",{attrs:{label:"固话","min-width":"110",prop:"telephone"}}),t._v(" "),a("el-table-column",{attrs:{label:"邮箱","min-width":"130",prop:"email"}}),t._v(" "),a("el-table-column",{attrs:{label:"QQ","min-width":"110",prop:"qq"}}),t._v(" "),a("el-table-column",{attrs:{label:"微信","min-width":"110",prop:"wechat"}}),t._v(" "),a("el-table-column",{attrs:{label:"地址",prop:"address","min-width":"200","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{label:"职务","min-width":"90",prop:"identity"}}),t._v(" "),a("el-table-column",{attrs:{label:"性别","min-width":"90",prop:"sex"}}),t._v(" "),a("el-table-column",{attrs:{label:"是否在职","min-width":"110",prop:"status"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{attrs:{content:e.row.status,placement:"right"}},[a("el-switch",{attrs:{"active-value":"在职","inactive-value":"离职","active-color":"#13ce66","inactive-color":"#bbbbbb"},on:{change:function(a){t.changeState(e.row)}},model:{value:e.row.status,callback:function(a){t.$set(e.row,"status",a)},expression:"scope.row.status"}})],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"是否为关键人","min-width":"110",prop:"isCrux"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{attrs:{content:e.row.isCrux,placement:"right"}},[a("el-switch",{attrs:{"active-value":"是","inactive-value":"否","active-color":"#13ce66","inactive-color":"#bbbbbb"},on:{change:function(a){t.changePrimary(e.row)}},model:{value:e.row.isCrux,callback:function(a){t.$set(e.row,"isCrux",a)},expression:"scope.row.isCrux"}})],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"备注","min-width":"180",prop:"remark"}})],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"官网",name:"third"}},[a("iframe",{staticClass:"tab_iframe",attrs:{src:t.website}})]),t._v(" "),a("el-tab-pane",{attrs:{label:"附件",name:"fourth"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.Enclosureclue,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"附件名称",prop:"name","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{attrs:{href:e.row.src,download:""}},[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"上传者",prop:"uploads","min-width":"110"}}),t._v(" "),a("el-table-column",{attrs:{label:"上传时间",prop:"uploadTime","min-width":"150"}})],1)],1)],1)],1)]),t._v(" "),a("el-col",{staticClass:"right",staticStyle:{padding:"10px","min-height":"560px"},attrs:{span:6}},[a("div",{staticClass:"searchList",staticStyle:{width:"100%"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入公司名称"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.search(e):null}},model:{value:t.searchList.keyword,callback:function(e){t.$set(t.searchList,"keyword",e)},expression:"searchList.keyword"}}),t._v(" "),a("el-button",{attrs:{icon:"el-icon-search",type:"primary",size:"mini"},on:{click:function(e){t.search()}}})],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{prop:"name",label:"公司名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{on:{click:function(a){t.getRow(e.$index,e.row)}}},[t._v("\n                    "+t._s(e.row.name)+"\n                ")])]}}])})],1),t._v(" "),a("div",{staticClass:"block numberPage number"},[a("el-pagination",{attrs:{small:"","current-page":t.page,"page-sizes":[20,30,50,100],"page-size":20,layout:"total, sizes, prev, next",total:t.tableNumber},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"新增联系人",visible:t.contactdialog,width:"50%","close-on-click-modal":!1},on:{"update:visible":function(e){t.contactdialog=e}}},[a("el-form",{ref:"newform",staticStyle:{"padding-right":"30px"},attrs:{model:t.newform,"label-width":"80px",rules:t.rules}},[a("el-form-item",{attrs:{label:"公司名称"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.newform.pName,callback:function(e){t.$set(t.newform,"pName",e)},expression:"newform.pName"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"name",label:"联系人"}},[a("el-input",{model:{value:t.newform.name,callback:function(e){t.$set(t.newform,"name",e)},expression:"newform.name"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"phone",label:"手机"}},[a("el-input",{attrs:{onkeyup:"value=value.replace(/[^\\d]/g,'')"},model:{value:t.newform.phone,callback:function(e){t.$set(t.newform,"phone",e)},expression:"newform.phone"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"电话"}},[a("el-input",{model:{value:t.newform.telephone,callback:function(e){t.$set(t.newform,"telephone",e)},expression:"newform.telephone"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"QQ"}},[a("el-input",{model:{value:t.newform.qq,callback:function(e){t.$set(t.newform,"qq",e)},expression:"newform.qq"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"邮箱"}},[a("el-input",{model:{value:t.newform.email,callback:function(e){t.$set(t.newform,"email",e)},expression:"newform.email"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"微信"}},[a("el-input",{model:{value:t.newform.weChat,callback:function(e){t.$set(t.newform,"weChat",e)},expression:"newform.weChat"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("el-radio",{attrs:{label:"男"},model:{value:t.newform.sex,callback:function(e){t.$set(t.newform,"sex",e)},expression:"newform.sex"}},[t._v("男")]),t._v(" "),a("el-radio",{attrs:{label:"女"},model:{value:t.newform.sex,callback:function(e){t.$set(t.newform,"sex",e)},expression:"newform.sex"}},[t._v("女")])],1),t._v(" "),a("el-form-item",{attrs:{label:"生日"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","default-value":"1985-06-15",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.newform.birthday,callback:function(e){t.$set(t.newform,"birthday",e)},expression:"newform.birthday"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"职务"}},[a("el-input",{model:{value:t.newform.identity,callback:function(e){t.$set(t.newform,"identity",e)},expression:"newform.identity"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"explain",label:"备注"}},[a("el-input",{attrs:{type:"textarea",rows:"5",placeholder:"请输入备注"},model:{value:t.newform.remark,callback:function(e){t.$set(t.newform,"remark",e)},expression:"newform.remark"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.contactdialog=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.submitcontact}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(n,r,!1,function(t){a("g8TU")},null,null);e.default=c.exports},g8TU:function(t,e){}});