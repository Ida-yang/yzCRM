webpackJsonp([47],{to94:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("wtEF"),s=a("mtWM"),n=a.n(s),r=(a("mw3O"),a("Icdr"));a("GbHy"),a("5/bM"),a("Oq2I"),a("miEh");var o={name:"analysisReport",store:i.a,data:function(){return{showTitle:!0,nameList:[{index:1,name:"合同报表",id:"chart401",isActive:!1},{index:2,name:"商机报表",id:"chart402",isActive:!1},{index:3,name:"部门业绩排行榜",id:"chart403",isActive:!1},{index:4,name:"个人业绩排行榜",id:"chart404",isActive:!1}],index:"",bar_style:{width:"",height:""},searchList:{mechanism:null,department:null,year:null,yearMonth:null,startTime:null,endTime:null,yearrange:""},mechanismData:[],deptnameData:[],monthList:[],agreeReportList:[],agreeData:["10200","15021","13201","18452"],agreeData2:["10000","15000","12000","15000"],agreeList:["财务部","市场部","销售一部","销售二部"],agreecolList:[{index:2,name:"目标合同份数",col:"parentname",width:"150"},{index:3,name:"目标合同金额",col:"deptname",width:"150"},{index:4,name:"完成合同数量",col:"contractNum",width:"150"},{index:5,name:"完成合同金额",col:"amount",width:"150"},{index:6,name:"增差数量",col:"amount",width:"100"},{index:7,name:"增差金额",col:"amount",width:"100"},{index:8,name:"数量达成率",col:"amount",width:"130"},{index:9,name:"金额达成率",col:"amount",width:"130"},{index:10,name:"上月合同数量增长率",col:"amount",width:"200"},{index:11,name:"上月合同金额增长率",col:"amount",width:"200"},{index:12,name:"平均客单价",col:"amount",width:"130"}],oppReportList:[],oppData:[],oppcolList:[],deptrankList:[],deptData:[],deptList:[],deptcolList:[{index:1,name:"排行",col:"sort",width:"80"},{index:2,name:"部门",col:"deptname",width:"80"},{index:3,name:"机构",col:"parentname",width:"80"},{index:4,name:"合同数量",col:"contractNum",width:"90"},{index:5,name:"合同金额",col:"amount",width:"90"},{index:6,name:"平均金额",col:"avg",width:"90"}],personrankList:[],personData:[],personList:[],personcolList:[{index:1,name:"排行",col:"sort",width:"80"},{index:2,name:"职员",col:"private_employee",width:"80"},{index:3,name:"部门",col:"deptname",width:"80"},{index:4,name:"机构",col:"parentname",width:"80"},{index:5,name:"合同数量",col:"contractNum",width:"90"},{index:6,name:"合同金额",col:"amount",width:"90"},{index:7,name:"平均金额",col:"avg",width:"90"}],tableData:[],colList:[],yeardisabled:!1,rangedisabled:!1}},mounted:function(){this.loadwidth(),this.loadmechanism()},activated:function(){},methods:{loadwidth:function(){var t=document.documentElement.offsetWidth||document.body.offsetWidth,e=document.documentElement.offsetHeight||document.body.offsetHeight;this.bar_style.width=.7*t+"px",this.bar_style.height=.6*e+"px"},loadmechanism:function(){var t=this;n()({method:"get",url:t.$store.state.defaultHttp+"dept/selectAllMechanism.do?cId="+t.$store.state.iscId}).then(function(e){t.mechanismData=e.data.map.success}).catch(function(t){})},loadagreeReport:function(){a("1nuA");var t={};t.year=this.searchList.year,this.searchList.year&&this.searchList.yearMonth&&(t.yearMonth=this.searchList.year+this.searchList.yearMonth),t.startTime=this.searchList.startTime,t.endTime=this.searchList.endTime,t.deptid=this.searchList.mechanism,t.secondid=this.searchList.department,this.tableData=this.agreeReportList,this.colList=this.agreecolList,this.drawLine1()},loadoppReport:function(){var t=this,e=a("1nuA"),i={};i.year=this.searchList.year,this.searchList.year&&this.searchList.yearMonth&&(i.yearMonth=this.searchList.year+this.searchList.yearMonth),i.startTime=this.searchList.startTime,i.endTime=this.searchList.endTime,i.deptid=this.searchList.mechanism,i.secondid=this.searchList.department,n()({method:"post",url:t.$store.state.defaultHttp+"addstep/selectAddstepState.do?cId="+t.$store.state.iscId,data:e.stringify(i)}).then(function(e){var a=e.data;t.oppcolList=[{index:-5,name:"职员",col:"private_employee"},{index:-4,name:"部门",col:"deptname"},{index:-3,name:"机构",col:"parentname"},{index:-2,name:"客户数量",col:"customerNum"}],t.oppData=[],a.forEach(function(e){t.oppcolList.push({index:e.sort,name:e.step_name,col:e.col}),t.oppData.push({name:e.step_name,value:e.count})}),t.drawLine2()}).catch(function(t){}),n()({method:"post",url:t.$store.state.defaultHttp+"opportunity/getOpportunityReportForm.do?cId="+t.$store.state.iscId,data:e.stringify(i)}).then(function(e){t.oppReportList=e.data.map.opportunitys,t.tableData=t.oppReportList,t.colList=t.oppcolList}).catch(function(t){})},loaddeptrank:function(){var t=this,e=a("1nuA"),i={};i.year=this.searchList.year,this.searchList.year&&this.searchList.yearMonth&&(i.yearMonth=this.searchList.year+this.searchList.yearMonth),i.startTime=this.searchList.startTime,i.endTime=this.searchList.endTime,i.deptid=this.searchList.mechanism,i.secondid=this.searchList.department,n()({method:"post",url:t.$store.state.defaultHttp+"getContractByDept.do?cId="+t.$store.state.iscId,data:e.stringify(i)}).then(function(e){t.deptData=[],t.deptList=[],t.deptrankList=e.data.map.contracts,t.tableData=t.deptrankList,t.colList=t.deptcolList,t.deptrankList.forEach(function(e){t.deptData.push(e.amount),t.deptList.push(e.deptname)}),t.drawLine3()}).catch(function(t){})},loadpersonrank:function(){var t=this,e=a("1nuA"),i={};i.year=this.searchList.year,this.searchList.year&&this.searchList.yearMonth&&(i.yearMonth=this.searchList.year+this.searchList.yearMonth),i.startTime=this.searchList.startTime,i.endTime=this.searchList.endTime,i.deptid=this.searchList.mechanism,i.secondid=this.searchList.department,n()({method:"post",url:t.$store.state.defaultHttp+"getContractByPersonal.do?cId="+t.$store.state.iscId,data:e.stringify(i)}).then(function(e){t.personData=[],t.personList=[],t.personrankList=e.data.map.contracts,t.tableData=t.personrankList,t.colList=t.personcolList,t.personrankList.forEach(function(e){t.personData.push(e.amount),t.personList.push(e.private_employee)}),t.drawLine4()}).catch(function(t){})},showTableval:function(t){var e=this,a=t.index;this.index=t.index,this.searchList={mechanism:null,department:null,year:null,yearMonth:null,startTime:null,endTime:null,yearrange:""},this.yeardisabled=!1,this.rangedisabled=!1,this.monthList=[],this.deptnameData=[],this.nameList.forEach(function(t){t.isActive=!1}),1==a?n()({method:"get",url:e.$store.state.defaultHttp+"reportFormJurisdiction/contract.do"}).then(function(a){a.data.msg&&"error"==a.data.msg?e.$message({message:"对不起，您没有该权限，请联系管理员开通",type:"error"}):(e.showTitle=!1,t.isActive=!t.isActive,e.$options.methods.loadagreeReport.bind(e)())}).catch(function(t){}):2==a?n()({method:"get",url:e.$store.state.defaultHttp+"reportFormJurisdiction/opportunity.do"}).then(function(a){a.data.msg&&"error"==a.data.msg?e.$message({message:"对不起，您没有该权限，请联系管理员开通",type:"error"}):(e.showTitle=!1,t.isActive=!t.isActive,e.$options.methods.loadoppReport.bind(e)())}).catch(function(t){}):3==a?n()({method:"get",url:e.$store.state.defaultHttp+"reportFormJurisdiction/dept.do"}).then(function(a){a.data.msg&&"error"==a.data.msg?e.$message({message:"对不起，您没有该权限，请联系管理员开通",type:"error"}):(e.showTitle=!1,t.isActive=!t.isActive,e.$options.methods.loaddeptrank.bind(e)())}).catch(function(t){}):4==a&&n()({method:"get",url:e.$store.state.defaultHttp+"reportFormJurisdiction/user.do"}).then(function(a){a.data.msg&&"error"==a.data.msg?e.$message({message:"对不起，您没有该权限，请联系管理员开通",type:"error"}):(e.showTitle=!1,t.isActive=!t.isActive,e.$options.methods.loadpersonrank.bind(e)())}).catch(function(t){})},drawLine1:function(){r.init(document.getElementById("chart401")).setOption({title:{text:"合同报表",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:60,containLabel:!0},xAxis:{bottom:20,type:"category",data:this.agreeList},yAxis:{type:"value"},series:[{name:"目标金额",type:"bar",data:this.agreeData2},{name:"实际金额",type:"bar",data:this.agreeData}]})},drawLine2:function(){r.init(document.getElementById("chart402")).setOption({title:{text:"商机漏斗",left:"center"},tooltip:{trigger:"item",formatter:"{b}<br>{a}：{c}"},calculable:!0,emphasis:{label:{fontSize:20}},series:[{name:"金额",type:"funnel",minSize:"10%",sort:"none",data:this.oppData}]})},drawLine3:function(){r.init(document.getElementById("chart403")).setOption({title:{text:"部门业绩排行榜",left:"center"},tooltip:{trigger:"item",formatter:"{b} <br/> 业绩：{c}"},grid:{left:60,containLabel:!0},xAxis:{bottom:20,type:"category",data:this.deptList},yAxis:{type:"value"},series:[{name:"合同金额",type:"bar",data:this.deptData}]})},drawLine4:function(){r.init(document.getElementById("chart404")).setOption({title:{text:"个人业绩排行榜",left:"center"},tooltip:{trigger:"item",formatter:"{b} <br/> 业绩：{c}"},grid:{left:60,containLabel:!0},xAxis:{bottom:20,type:"category",data:this.personList},yAxis:{type:"value",boundaryGap:[0,.01]},series:[{name:"合同金额",type:"bar",data:this.personData}]})},loaddeptList:function(){var t=this,e=a("1nuA"),i={};i.deptid=this.searchList.mechanism,n()({method:"post",url:t.$store.state.defaultHttp+"dept/getChildrenByMechanism.do?cId="+t.$store.state.iscId,data:e.stringify(i)}).then(function(e){var a=e.data.map.success;t.deptnameData=[{deptid:"",deptname:"全部"}],a.forEach(function(e){t.deptnameData.push({deptid:e.deptid,deptname:e.deptname})})}).catch(function(t){})},search:function(){!this.searchList.department&&this.searchList.mechanism&&this.$options.methods.loaddeptList.bind(this)(),!this.searchList.yearMonth&&this.searchList.year&&(this.rangedisabled=!0,this.monthList=[{id:"-01",label:"一月"},{id:"-02",label:"二月"},{id:"-03",label:"三月"},{id:"-04",label:"四月"},{id:"-05",label:"五月"},{id:"-06",label:"六月"},{id:"-07",label:"七月"},{id:"-08",label:"八月"},{id:"-09",label:"九月"},{id:"-10",label:"十月"},{id:"-11",label:"十一月"},{id:"-12",label:"十二月"}]),this.$options.methods.searchtwo.bind(this)()},searchtwo:function(){1==this.index?this.$options.methods.loadagreeReport.bind(this)():2==this.index?this.$options.methods.loadoppReport.bind(this)():3==this.index?this.$options.methods.loaddeptrank.bind(this)():4==this.index&&this.$options.methods.loadpersonrank.bind(this)()},reset:function(){this.searchList={mechanism:null,department:null,year:null,yearMonth:null,startTime:null,endTime:null,yearrange:""},this.yeardisabled=!1,this.rangedisabled=!1,this.monthList=[],this.deptnameData=[]},datepick:function(t){this.yeardisabled=!0,t?(this.searchList.startTime=t[0],this.searchList.endTime=t[1]):(this.searchList.startTime="",this.searchList.endTime=""),this.$options.methods.searchtwo.bind(this)()}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contentall"},[a("div",{staticClass:"setleftcontent"},[a("ul",{staticClass:"namecontent"},t._l(t.nameList,function(e){return a("li",{key:e.index,class:{actived:e.isActive},attrs:{value:e.name},on:{click:function(a){t.showTableval(e)}}},[t._v(t._s(e.name))])}))]),t._v(" "),a("div",{staticClass:"centercontent"}),t._v(" "),t._l(t.nameList,function(e){return a("div",{directives:[{name:"show",rawName:"v-show",value:e.isActive,expression:"item.isActive"}],key:e.index,staticClass:"setrightcontent"},[a("div",{staticClass:"searchList",staticStyle:{width:"100%"}},[a("span",{staticClass:"nameList"},[t._v("年份：")]),t._v(" "),a("el-date-picker",{attrs:{disabled:t.yeardisabled,type:"year",format:"yyyy","value-format":"yyyy",placeholder:"选择年份"},on:{change:t.search},model:{value:t.searchList.year,callback:function(e){t.$set(t.searchList,"year",e)},expression:"searchList.year"}}),t._v(" "),a("span",{staticClass:"nameList"},[t._v("时间段：")]),t._v(" "),a("el-date-picker",{attrs:{disabled:t.rangedisabled,type:"daterange",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.datepick},model:{value:t.searchList.yearrange,callback:function(e){t.$set(t.searchList,"yearrange",e)},expression:"searchList.yearrange"}})],1),t._v(" "),a("div",{staticClass:"radioList report_radio"},[a("el-radio-group",{model:{value:t.searchList.yearMonth,callback:function(e){t.$set(t.searchList,"yearMonth",e)},expression:"searchList.yearMonth"}},t._l(t.monthList,function(e){return a("el-radio",{key:e.id,attrs:{label:e.id},on:{change:t.search}},[t._v(t._s(e.label))])}))],1),t._v(" "),a("div",{staticClass:"searchList",staticStyle:{width:"100%"}},[a("span",{staticClass:"nameList"},[t._v("机构：")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.search},model:{value:t.searchList.mechanism,callback:function(e){t.$set(t.searchList,"mechanism",e)},expression:"searchList.mechanism"}},t._l(t.mechanismData,function(t){return a("el-option",{key:t.deptid,attrs:{label:t.deptname,value:t.deptid}})})),t._v(" "),a("el-button",{staticClass:"clear_btn",attrs:{icon:"el-icon-circle-close-outline",size:"mini"},on:{click:function(e){t.reset()}}},[t._v("清空")])],1),t._v(" "),a("div",{staticClass:"radioList report_radio"},[a("el-radio-group",{model:{value:t.searchList.department,callback:function(e){t.$set(t.searchList,"department",e)},expression:"searchList.department"}},t._l(t.deptnameData,function(e){return a("el-radio",{key:e.deptid,attrs:{label:e.deptid},on:{change:t.search}},[t._v(t._s(e.deptname))])})),t._v(" "),a("div",{staticStyle:{width:"100%",height:"20px"}})],1),t._v(" "),a("div",{staticClass:"report_c"},[a("div",{style:t.bar_style,attrs:{id:e.id}})]),t._v(" "),a("div",{staticClass:"report_b"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:""}},[t._l(t.colList,function(t){return[a("el-table-column",{key:t.index,attrs:{label:t.name,prop:t.col,"show-overflow-tooltip":"","min-width":t.width}})]})],2)],1)])}),t._v(" "),t.showTitle?a("div",{staticClass:"null_c"},[a("span",[t._v("请点击左边菜单栏查看报表")])]):t._e()],2)},staticRenderFns:[]};var c=a("VU/8")(o,d,!1,function(t){a("y56Y")},null,null);e.default=c.exports},y56Y:function(t,e){}});