webpackJsonp([25],{Fz8H:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("wtEF"),i=s("mtWM"),n=s.n(i),o=(s("mw3O"),s("PQp9")),r={name:"experienceBase",store:a.a,components:{UE:o.a},computed:{experienceBaseList:function(){return a.a.state.experienceBaseList},tableNumber:function(){return a.a.state.experienceBaseListnumber}},data:function(){return{msg:"经验库",classData:[],defaultProps:{label:"name",children:"next"},defaultkeys:[1],page:1,limit:20,searchList:{searchName:null,type:null,typeName:null},addDialog:!1,editDialog:!1,myform:{id:null,title:null,describe:null,service_type_id:null,service_type_name:null},rules:{},defaultMsg:"",config:{initialFrameWidth:"",initialFrameHeight:500,toolbars:[["undo","redo","|","bold","italic","underline","strikethrough","forecolor","backcolor","|","formatmatch","autotypeset","insertorderedlist","insertunorderedlist","|","justifyleft","justifycenter","justifyright","justifyjustify","|","customstyle","paragraph","fontfamily","fontsize","|","insertimage","attachment","spechars","snapscreen","|","imagenone","imageleft","imageright","imagecenter"]],elementPathEnabled:!1,wordCount:!1}}},mounted:function(){this.loadTree(),this.loadData()},activated:function(){this.loadData()},methods:{loadTree:function(){var e=this;n()({method:"get",url:e.$store.state.defaultHttp+"serviceType/getServiceTypeNodeTree.do?cId="+e.$store.state.iscId}).then(function(t){e.classData=t.data.map.success}).catch(function(e){})},loadData:function(){var e=this,t=s("1nuA"),a={};a.page=this.page,a.limit=this.limit,a.searchName=this.searchList.searchName,a.type=this.searchList.type,n()({method:"post",url:e.$store.state.defaultHttp+"knowledgeBase/queryForList.do?cId="+e.$store.state.iscId,data:t.stringify(a)}).then(function(t){var s=t.data.map.success;s.forEach(function(t){t.img?t.portrait=e.$store.state.systemHttp+"upload/"+e.$store.state.iscId+"/"+t.img:t.portrait=e.$store.state.systemHttp+"/upload/staticImg/avatar.jpg"}),e.$store.state.experienceBaseList=s,e.$store.state.experienceBaseListnumber=t.data.count}).catch(function(e){})},handleNodeClick:function(e){e.next.length?this.$message({message:"该分类下该有明细分类，不可添加",type:"error"}):(this.searchList.type=e.id,this.searchList.typeName=e.name,this.$options.methods.loadData.bind(this)())},opendetials:function(e){this.$store.state.expBasedetailData=e,this.$router.push({path:"/experienceBasedetail"})},handleAdd:function(){this.searchList.type?(this.addDialog=!0,this.myform={id:null,title:null,describe:null,service_type_id:this.searchList.type,service_type_name:this.searchList.typeName,pId:this.$store.state.ispId},this.$refs.ue&&(this.$refs.ue.editor.body.textContent="")):this.$message({message:"请先选择工单分类",type:"error"})},delOrEdit:function(e,t){var a=this,i=this,o=s("1nuA");if("edit"==e)this.addDialog=!0,this.myform={id:t.id,title:t.title,describe:t.describe,service_type_id:t.service_type_id,service_type_name:t.service_type_name,pId:t.pId};else if("del"==e){var r={};r.id=t.id,i.$confirm("是否确认删除["+t.title+"]？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(e){e.value;n()({method:"post",url:i.$store.state.defaultHttp+"knowledgeBase/delete.do?cId="+i.$store.state.iscId,data:o.stringify(r)}).then(function(e){e.data.code&&"200"==e.data.code?(i.$message({message:"删除成功",type:"success"}),i.$options.methods.loadData.bind(i)()):e.data.msg&&"error"==e.data.msg?i.$message({message:"对不起，您没有该权限，请联系管理员开通",type:"error"}):i.$message({message:e.data.msg,type:"error"})}).catch(function(e){i.$message.error("删除失败,请重新删除")})}).catch(function(){a.$message({type:"info",message:"取消删除【"+row.name+"】"})})}},addSubmit:function(){var e=this,t=this.$refs.ue.getUEContent(),a=s("1nuA"),i={};i.id=this.myform.id,i.service_type_id=this.myform.service_type_id,i.title=this.myform.title,i.describe=t,i.pId=this.myform.pId;var o=!1;i.title||(e.$message({message:"标题不能为空",type:"error"}),o=!0),o||n()({method:"post",url:e.$store.state.defaultHttp+"knowledgeBase/saveOrUpdate.do?cId="+e.$store.state.iscId,data:a.stringify(i)}).then(function(t){t.data.code&&"200"==t.data.code?(e.$message({message:"操作成功",type:"success"}),e.addDialog=!1,e.$options.methods.loadData.bind(e)()):e.$message({message:t.data.msg,type:"error"})}).catch(function(e){})},handleSizeChange:function(e){this.limit=e,this.$options.methods.loadData.bind(this)()},handleCurrentChange:function(e){this.page=e,this.$options.methods.loadData.bind(this)()}}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"contentall"},[s("div",{staticClass:"otherleftcontent"},[s("el-tree",{attrs:{"node-key":"id","highlight-current":"","default-expand-all":"",data:e.classData,props:e.defaultProps,"expand-on-click-node":!1},on:{"node-click":e.handleNodeClick}})],1),e._v(" "),s("div",{staticClass:"otherightcontent"},[s("div",{staticClass:"entry"},[s("el-button",{staticClass:"btn info-btn",attrs:{size:"mini"},on:{click:function(t){e.handleAdd()}}},[e._v("新增")]),e._v(" "),s("div",{staticClass:"totalnum_head"},[e._v("共 "),s("span",{staticClass:"bold_span"},[e._v(e._s(e.tableNumber))]),e._v(" 条")])],1),e._v(" "),s("div",{staticClass:"eb_content"},e._l(e.experienceBaseList,function(t){return s("ul",{key:t.id,staticClass:"ed_ul"},[s("li",{staticClass:"ed_li_1",on:{click:function(s){e.opendetials(t)}}},[s("img",{staticStyle:{"border-radius":"25px"},attrs:{src:t.portrait,width:"50",height:"50"}})]),e._v(" "),s("li",{staticClass:"ed_li_2"},[s("p",{staticClass:"ed_p_1",on:{click:function(s){e.opendetials(t)}}},[e._v(e._s(t.title)),s("span",{staticClass:"ed_p_span"},[e._v(e._s(t.createTime))])]),e._v(" "),s("div",{staticClass:"ed_p_2"},[s("span",{staticClass:"ed_span_1",on:{click:function(s){e.opendetials(t)}}},[e._v("创建人："+e._s(t.private_employee))]),e._v(" "),s("el-dropdown",{staticClass:"ed_drop",attrs:{trigger:"click"},on:{command:function(s){e.delOrEdit(s,t)}}},[s("span",{staticClass:"el-dropdown-link"},[e._v("更多"),s("i",{staticClass:"el-icon-caret-bottom"})]),e._v(" "),s("el-dropdown-menu",{staticClass:"drop_item",attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"edit"}},[e._v("编辑")]),e._v(" "),s("el-dropdown-item",{attrs:{command:"del"}},[e._v("删除")])],1)],1)],1)])])})),e._v(" "),s("div",{staticClass:"block numberPage"},[s("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[20,50,100,500],"page-size":20,layout:"total, sizes, prev, pager, next, jumper",total:e.tableNumber},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),s("el-dialog",{attrs:{title:"新增/编辑",visible:e.addDialog,"close-on-click-modal":!1,width:"60%"},on:{"update:visible":function(t){e.addDialog=t}}},[s("el-form",{ref:"myform",staticStyle:{"padding-right":"30px"},attrs:{model:e.myform,"label-width":"80px",rules:e.rules}},[s("el-form-item",{attrs:{label:"工单分类"}},[s("el-input",{attrs:{disabled:!0},model:{value:e.myform.service_type_name,callback:function(t){e.$set(e.myform,"service_type_name",t)},expression:"myform.service_type_name"}})],1),e._v(" "),s("el-form-item",{attrs:{prop:"title",label:"标题"}},[s("el-input",{model:{value:e.myform.title,callback:function(t){e.$set(e.myform,"title",t)},expression:"myform.title"}})],1),e._v(" "),s("el-form-item",{attrs:{prop:"describe",label:"描述"}},[s("div",{staticClass:"editor-container editor_head"},[s("UE",{ref:"ue",attrs:{defaultMsg:e.myform.describe,config:e.config}})],1)])],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.addDialog=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.addSubmit}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var d=s("VU/8")(r,l,!1,function(e){s("MRMK")},null,null);t.default=d.exports},MRMK:function(e,t){}});