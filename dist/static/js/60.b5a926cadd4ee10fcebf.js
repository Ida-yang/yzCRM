webpackJsonp([60],{H9MT:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("wtEF"),n=a("mtWM"),i=a.n(n),o=(a("mw3O"),{name:"approvalProcess",store:s.a,computed:{tableData:function(){return s.a.state.approvalProcessList},tableNumber:function(){return s.a.state.approvalProcessListnumber}},data:function(){return{page:1,limit:20,keyType:"1",workApprovalId:null,searchList:[{index:"1",name:"合同流程设置",isActive:!0},{index:"2",name:"销售订单流程设置",isActive:!1},{index:"3",name:"合同回款流程设置",isActive:!1},{index:"4",name:"办公流程设置",isActive:!1},{index:"5",name:"外勤流程设置",isActive:!1},{index:"6",name:"订单收款流程设置",isActive:!1}],workList:[],workApproval:!1}},activated:function(){this.loadTable(),this.loadworkApproval()},mounted:function(){this.loadTable(),this.loadWorkLavel()},methods:{loadTable:function(){var t=this,e=a("1nuA"),s={};s.page=this.page,s.limit=this.limit,s.keyType=this.keyType,i()({method:"post",url:t.$store.state.defaultHttp+"examine/queryAllExamine.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){var a=e.data.map.list;a.forEach(function(t){1==t.status?t.statusname="启用":0==t.status&&(t.statusname="禁用")}),t.$store.state.approvalProcessList=a,t.$store.state.approvalProcessListnumber=e.data.count,t.workApproval=!1}).catch(function(t){})},loadWorkLavel:function(){var t=this;i()({method:"get",url:t.$store.state.defaultHttp+"oaExamineCategoryType/selectList.do?cId="+t.$store.state.iscId}).then(function(e){var a=e.data;a.forEach(function(t,e){var a=e+100;t.index=a.toString()}),t.workList=a}).catch(function(t){})},loadworkApproval:function(){var t=this,e=a("1nuA"),s={};s.page=this.page,s.limit=this.limit,s.type=this.workApprovalId,s.secondid=this.$store.state.deptid,i()({method:"post",url:t.$store.state.defaultHttp+"oaExamineCategory/selectList.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){var a=e.data.map.success;t.$store.state.approvalProcessList=a,t.$store.state.approvalProcessListnumber=e.data.count,t.workApproval=!0}).catch(function(t){})},showTableval:function(t){this.keyType=t,this.$options.methods.loadTable.bind(this)()},showWorkleval:function(t){this.workApprovalId=t.id,this.$options.methods.loadworkApproval.bind(this)()},handleAdd:function(){this.$store.state.approvaladdOrUpdateData=null,this.$router.push({path:"/approvalProcessaddorupdate"})},handleEdit:function(t,e){e.levelList=[],e.stepList.forEach(function(t){t.checkUserId=[],t.userList.forEach(function(e){t.checkUserId.push(e.userId)}),e.levelList.push({index:t.stepNum,stepType:t.stepType,name:"第 "+t.stepNum+" 级",checkUserId:t.checkUserId,remarks:t.remarks,del:!1})}),this.$store.state.approvaladdOrUpdateData=e,this.$router.push({path:"/approvalProcessaddorupdate"})},handleDelete:function(t,e){var s=this,n=this,o=a("1nuA"),l={};l.id=e.id,l.status=2,l.pId=this.$store.state.ispId,n.$confirm("是否确认删除【"+e.name+"】？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){t.value;i()({method:"post",url:n.$store.state.defaultHttp+"examine/updateStatus.do?cId="+n.$store.state.iscId,data:o.stringify(l)}).then(function(t){t.data.code&&"200"==t.data.code?(n.$message({message:"删除成功",type:"success"}),n.$options.methods.loadTable.bind(n)()):n.$message({message:t.data.msg,type:"error"})}).catch(function(t){n.$message.error("删除失败,请重新删除")})}).catch(function(){s.$message({type:"info",message:"取消删除【"+e.name+"】"})})},handleSizeChange:function(t){this.limit=t,this.$options.methods.loadTable.bind(this)(!1)},handleCurrentChange:function(t){this.page=t,this.$options.methods.loadTable.bind(this)(!1)}}}),l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contentall"},[a("div",{staticClass:"setleftcontent"},[a("el-menu",{staticClass:"el-menu-vertical-demo base_menu",attrs:{"default-active":"1"}},[a("el-menu-item",{attrs:{index:"1"},on:{click:function(e){t.showTableval("1")}}},[t._v("合同流程设置")]),t._v(" "),a("el-menu-item",{attrs:{index:"2"},on:{click:function(e){t.showTableval("2")}}},[t._v("销售订单流程设置")]),t._v(" "),a("el-menu-item",{attrs:{index:"3"},on:{click:function(e){t.showTableval("3")}}},[t._v("合同回款流程设置")]),t._v(" "),a("el-submenu",{attrs:{index:"4"}},[a("span",{attrs:{slot:"title"},slot:"title"},[t._v("办公流程设置")]),t._v(" "),t._l(t.workList,function(e){return a("el-menu-item",{key:e.id,attrs:{index:e.index},on:{click:function(a){t.showWorkleval(e)}}},[t._v(t._s(e.name))])})],2),t._v(" "),a("el-menu-item",{attrs:{index:"5"},on:{click:function(e){t.showTableval("5")}}},[t._v("外勤流程设置")]),t._v(" "),a("el-menu-item",{attrs:{index:"6"},on:{click:function(e){t.showTableval("6")}}},[t._v("订单收款流程设置")])],1)],1),t._v(" "),a("div",{staticClass:"centercontent"}),t._v(" "),a("div",{staticClass:"setrightcontent"},[a("div",{staticClass:"entry"},[a("el-button",{staticClass:"btn info-btn",attrs:{size:"mini"},on:{click:function(e){t.handleAdd()}}},[t._v("新增")]),t._v(" "),a("div",{staticClass:"totalnum_head"},[t._v("共 "),a("span",{staticClass:"bold_span"},[t._v(t._s(t.tableNumber))]),t._v(" 条")])],1),t._v(" "),a("el-table",{directives:[{name:"show",rawName:"v-show",value:!t.workApproval,expression:"!workApproval"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"审核流程",prop:"name",fixed:"","min-width":"110",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"关联对象",prop:"categoryTypeName","min-width":"110",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"应用部门",prop:"deptIdLs","min-width":"150",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.deptIdLs,function(e,s){return a("span",{key:e.id},[0!==s?a("span",[t._v("，")]):t._e(),t._v(t._s(e.name))])})}}])}),t._v(" "),a("el-table-column",{attrs:{label:"最后修改人",prop:"updateUserName","min-width":"120",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime","min-width":"150",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"remarks","min-width":"180",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.handleEdit(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){t.handleDelete(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-table",{directives:[{name:"show",rawName:"v-show",value:t.workApproval,expression:"workApproval"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"审核流程",prop:"title",fixed:"","min-width":"110",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"应用部门",prop:"deptIdLs","min-width":"150",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.deptIdLs,function(e,s){return a("span",{key:e.id},[0!==s?a("span",[t._v("，")]):t._e(),t._v(t._s(e.name))])})}}])}),t._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime","min-width":"150",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"备注",prop:"remarks","min-width":"180",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"150","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.handleEdit(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){t.handleDelete(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("div",{staticClass:"block numberPage"},[a("el-pagination",{attrs:{"current-page":t.page,"page-sizes":[20,50,100,500],"page-size":20,layout:"total, sizes, prev, pager, next, jumper",total:t.tableNumber},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)])},staticRenderFns:[]};var r=a("VU/8")(o,l,!1,function(t){a("UFxT")},null,null);e.default=r.exports},UFxT:function(t,e){}});