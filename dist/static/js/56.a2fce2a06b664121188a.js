webpackJsonp([56],{MNxq:function(t,e){},PrcV:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("INCx"),i=a.n(s),n=a("wtEF"),l=a("mtWM"),r=a.n(l),c=(a("mw3O"),{name:"receivedetail",store:n.a,filters:{commaing:function(t){if(t){var e=i()(t).toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"),a=".00",s=t.toString().split(".");return 2===s.length?1===(a=s[1].toString()).length?e+"."+a+"0":e+"."+a:e+a}}},data:function(){return{msg:"receivedetail.vue",receivdetailData:[],examineList:[],examineLog:[],fieldData:[],hasCheck:null,hasRecheck:null,retracts:!0,thisshow:!0,activeName2:"first",moneyBackLists:[],thisMoneyBack:[],tableData:[],tableNumber:0,page:1,limit:20,searchList:{keyWord:null},dialogVisible2:!1,exaform:{status:null,remarks:null},rules:{},auditing:this.$store.state.systemHttp+"/upload/staticImg/inaudit.png",audited:this.$store.state.systemHttp+"/upload/staticImg/examine.png",noaudit:this.$store.state.systemHttp+"/upload/staticImg/refuse.png"}},activated:function(){this.loadData(),this.loadTable()},methods:{loadData:function(){var t=this,e=this.$store.state.receivdetailData,s=a("1nuA"),i={};i.id=e.id;var n={label:7,id:e.id};r()({method:"post",url:t.$store.state.defaultHttp+"back/selectById.do?cId="+t.$store.state.iscId,data:s.stringify(i)}).then(function(e){t.receivdetailData=e.data,t.receivdetailData.residual_amount=e.data.totalAmount-e.data.amount_of_repayment;var a={checkStatus:e.data.checkStatus,recordId:e.data.examineRecordId,pId:t.$store.state.ispId};r()({method:"post",url:t.$store.state.defaultHttp+"examineRecord/queryExamineRecordList.do?cId="+t.$store.state.iscId,data:s.stringify(a)}).then(function(e){t.examineList=e.data.steps,t.examineList.forEach(function(e,a){if(e.userLength=e.userList.length,1==e.userLength?e.type_style="width:50px;":2==e.userLength?e.type_style="width:75px;":3==e.userLength?e.type_style="width:100px;":4==e.userLength?e.type_style="width:125px;":5==e.userLength&&(e.type_style="width:150px;"),0==a&&(e.userList[0].img?e.headPortrait=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.userList[0].img:e.headPortrait=t.$store.state.systemHttp+"/upload/staticImg/avatar.jpg"),2==e.stepType)for(var s=0;s<e.userList.length;s++){if(e.userList[s].img&&0!==e.userList[s].examineStatus){e.headPortrait=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.userList[s].img;break}if(!e.userList[s].img&&0!==e.userList[s].examineStatus){e.headPortrait=t.$store.state.systemHttp+"/upload/staticImg/avatar.jpg";break}if(e.userList[s].img&&0==e.userList[s].examineStatus){e.headPortrait=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.userList[s].img;break}if(!e.userList[s].img&&0==e.userList[s].examineStatus){e.headPortrait=t.$store.state.systemHttp+"/upload/staticImg/avatar.jpg";break}}3==e.stepType&&e.userList.forEach(function(e,a){e.img?e.headPortrait=t.$store.state.systemHttp+"/upload/"+t.$store.state.iscId+"/"+e.img:e.headPortrait=t.$store.state.systemHttp+"/upload/staticImg/avatar.jpg"})}),t.hasCheck=e.data.isCheck,t.hasRecheck=e.data.isRecheck}).catch(function(t){}),r()({method:"get",url:t.$store.state.defaultHttp+"examineLog/queryExamineLogList.do?cId="+t.$store.state.iscId+"&recordId="+t.receivdetailData.examineRecordId}).then(function(e){t.examineLog=e.data}).catch(function(t){}),r()({method:"get",url:t.$store.state.defaultHttp+"back/selectBackByContactId.do?cId="+t.$store.state.iscId+"&contract_id="+t.receivdetailData.contract_id}).then(function(e){t.moneyBackLists=e.data,t.thisMoneyBack=[],e.data.forEach(function(e,a){e.id==t.receivdetailData.id&&(e.periodsnum=a+1,t.thisMoneyBack.push(e))})}).catch(function(t){})}).catch(function(t){}),r()({method:"post",url:t.$store.state.defaultHttp+"field/information.do?cId="+t.$store.state.iscId,data:s.stringify(n)}).then(function(e){t.fieldData=e.data}).catch(function(t){})},loadTable:function(){var t=this,e=a("1nuA"),s={};s.page=this.page,s.limit=this.limit,s.stateid=0,s.keyWord=this.searchList.keyWord,r()({method:"post",url:t.$store.state.defaultHttp+"back/queryForList.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){t.tableData=e.data.map.success,t.tableNumber=e.data.count}).catch(function(t){})},toexamine:function(){var t=this,e=a("1nuA"),s={};s.id=this.receivdetailData.id,s.recordId=this.receivdetailData.examineRecordId,s.pId=this.$store.state.ispId,s.status=this.exaform.status,s.remarks=this.exaform.remarks;var i=!1;s.remarks||(t.$message({message:"审核意见不能为空",type:"error"}),i=!0),i||r()({method:"post",url:t.$store.state.defaultHttp+"examineRecord/auditExamine.do?cId="+t.$store.state.iscId,data:e.stringify(s)}).then(function(e){e.data.code&&"200"==e.data.code?(t.$message({message:"操作成功",type:"success"}),t.dialogVisible2=!1,t.exaform.status=null,t.exaform.remarks=null,t.$options.methods.loadData.bind(t)()):t.$message({message:e.data.msg,type:"error"})}).catch(function(e){t.$message.error("审核失败，请稍后再试")})},retract:function(){this.thisshow=!this.thisshow,this.retracts=!this.retracts},showexamine:function(t){this.exaform.status=t,this.dialogVisible2=!0},getRow:function(t,e){this.$store.state.receivdetailData={id:e.id},this.$options.methods.loadData.bind(this)(!0)},search:function(){this.$options.methods.loadTable.bind(this)()},handleSizeChange:function(t){this.limit=t,this.$options.methods.loadTable.bind(this)()},handleCurrentChange:function(t){this.page=t,this.$options.methods.loadTable.bind(this)()}}}),o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticClass:"rec_detail",attrs:{gutter:10}},[a("el-col",{attrs:{span:18}},[a("div",{staticClass:"top"},[a("el-card",{staticClass:"box-card",model:{value:t.receivdetailData,callback:function(e){t.receivdetailData=e},expression:"receivdetailData"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"bold_span"},[t._v("合同回款单："+t._s(t.receivdetailData.backNo))]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.retracts,expression:"retracts"}],staticClass:"info-btn",staticStyle:{float:"right","margin-left":"10px"},attrs:{size:"mini"},on:{click:function(e){t.retract()}}},[t._v("收起")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.retracts,expression:"!retracts"}],staticClass:"info-btn",staticStyle:{float:"right","margin-left":"10px"},attrs:{size:"mini"},on:{click:function(e){t.retract()}}},[t._v("显示")])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.thisshow,expression:"thisshow"}],staticClass:"text item"},[a("ul",[a("li",[t._v("公司名称："),a("span",[t._v(t._s(t.receivdetailData.customerName))])]),t._v(" "),a("li",[t._v("回款日期："),a("span",[t._v(t._s(t.receivdetailData.createTime))])]),t._v(" "),a("li",[t._v("结算账户："),a("span",[t._v(t._s(t.receivdetailData.pay_type))])]),t._v(" "),a("li",[t._v("总金额："),a("span",{staticClass:"bold_span"},[t._v(t._s(t._f("commaing")(t.receivdetailData.totalAmount))+" 元")])]),t._v(" "),a("li",[t._v("已回款金额："),a("span",[t._v(t._s(t._f("commaing")(t.receivdetailData.amount_of_repayment)))])]),t._v(" "),a("li",[t._v("本次回款金额："),a("span",[t._v(t._s(t._f("commaing")(t.receivdetailData.price)))])]),t._v(" "),a("li",[t._v("剩余金额："),a("span",[t._v(t._s(t._f("commaing")(t.receivdetailData.residual_amount)))])]),t._v(" "),a("li",[t._v("原单号："),a("span",[t._v(t._s(t.receivdetailData.contract_number))])]),t._v(" "),a("li",[t._v("原单类型："),a("span",[t._v(t._s(t.receivdetailData.type))])]),t._v(" "),t._l(t.fieldData,function(e,s){return a("li",{key:s},[t._v("\n                            "+t._s(e.name)+"："),a("span",[t._v(t._s(e.value))])])})],2),t._v(" "),1==t.receivdetailData.checkStatus?a("div",{staticClass:"receiveaudited"},[a("img",{staticClass:"audited_img",attrs:{src:t.auditing,alt:"审核中"}})]):t._e(),t._v(" "),2==t.receivdetailData.checkStatus?a("div",{staticClass:"receiveaudited"},[a("img",{staticClass:"audited_img",attrs:{src:t.audited,alt:"已审核"}})]):t._e(),t._v(" "),3==t.receivdetailData.checkStatus?a("div",{staticClass:"receiveaudited"},[a("img",{staticClass:"audited_img",attrs:{src:t.noaudit,alt:"未通过"}})]):t._e()]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.thisshow,expression:"!thisshow"}]})])],1),t._v(" "),a("div",{staticClass:"top"},[a("el-card",{staticClass:"box-card",model:{value:t.receivdetailData,callback:function(e){t.receivdetailData=e},expression:"receivdetailData"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-popover",{attrs:{placement:"right-start",width:"220",trigger:"click"}},[a("div",{staticStyle:{"max-height":"400px","overflow-y":"overlay"}},t._l(t.examineLog,function(e,s){return a("div",{key:s,staticClass:"examine_popover"},[a("span",{staticClass:"examine_ico"},[0==e.examineStatus?a("i",{staticClass:"el-icon-time",staticStyle:{"font-size":"20px"}}):t._e(),t._v(" "),1==e.examineStatus?a("i",{staticClass:"el-icon-circle-check-outline",staticStyle:{color:"#67c23a","font-size":"20px"}}):t._e(),t._v(" "),2==e.examineStatus?a("i",{staticClass:"el-icon-circle-close-outline",staticStyle:{color:"#f56c6c","font-size":"20px"}}):t._e(),t._v(" "),3==e.examineStatus?a("i",{staticClass:"el-icon-time",staticStyle:{color:"#e6a23c","font-size":"20px"}}):t._e(),t._v(" "),5==e.examineStatus?a("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{color:"#67c23a","font-size":"20px"}}):t._e()]),t._v(" "),a("div",{staticClass:"examint_msg"},[a("p",{staticStyle:{"font-size":"13px",color:"#aaaaaa"}},[t._v(t._s(e.examineTime))]),t._v(" "),1==e.examineStatus?a("p",[t._v(t._s(e.realname+" 已审核"))]):t._e(),t._v(" "),2==e.examineStatus?a("p",[t._v(t._s(e.realname+" 已拒绝"))]):t._e(),t._v(" "),a("div",{staticClass:"examint_remark"},[a("p",[t._v(t._s(e.remarks))])])])])})),t._v(" "),a("span",{staticStyle:{"font-size":"14px","text-decoration":"underline"},attrs:{slot:"reference"},slot:"reference"},[t._v("查看审核历史")])]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.hasCheck&&2!==t.receivdetailData.checkStatus,expression:"hasCheck && receivdetailData.checkStatus !== 2"}],staticClass:"info-btn",staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(e){t.showexamine(1)}}},[t._v("通过")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.hasCheck&&2!==t.receivdetailData.checkStatus,expression:"hasCheck && receivdetailData.checkStatus !== 2"}],staticClass:"info-btn",staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(e){t.showexamine(2)}}},[t._v("拒绝")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.hasCheck,expression:"hasCheck"}],staticClass:"info-btn",staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:function(e){t.showexamine(4)}}},[t._v("驳回")])],1),t._v(" "),a("div",{staticClass:"text item"},[a("div",{staticClass:"examine_c"},t._l(t.examineList,function(e,s){return a("div",{key:s,staticClass:"examine_item"},[a("el-popover",{staticClass:"examine_cont",attrs:{placement:"bottom",width:"220",trigger:"hover"}},[t._l(e.userList,function(e,s){return a("div",{key:s,staticClass:"examine_popover"},[a("span",{staticClass:"examine_ico"},[0==e.examineStatus?a("i",{staticClass:"el-icon-time",staticStyle:{"font-size":"20px"}}):t._e(),t._v(" "),1==e.examineStatus?a("i",{staticClass:"el-icon-success",staticStyle:{color:"#67c23a","font-size":"18px"}}):t._e(),t._v(" "),2==e.examineStatus?a("i",{staticClass:"el-icon-circle-close",staticStyle:{color:"#f56c6c","font-size":"20px"}}):t._e(),t._v(" "),3==e.examineStatus?a("i",{staticClass:"el-icon-time",staticStyle:{color:"#e6a23c","font-size":"20px"}}):t._e(),t._v(" "),5==e.examineStatus?a("i",{staticClass:"el-icon-circle-plus",staticStyle:{color:"#67c23a","font-size":"20px"}}):t._e()]),t._v(" "),a("div",{staticClass:"examint_msg"},[a("p",{staticStyle:{"font-size":"13px",color:"#aaaaaa"}},[t._v(t._s(e.examineTime))]),t._v(" "),a("span",[t._v(t._s(e.realname+"("+e.phone+")"))]),t._v(" "),0==e.examineStatus?a("p",[t._v("未审核此申请")]):t._e(),t._v(" "),1==e.examineStatus?a("p",[t._v("通过此申请")]):t._e(),t._v(" "),2==e.examineStatus?a("p",[t._v("拒绝此申请")]):t._e(),t._v(" "),5==e.examineStatus?a("p",[t._v("创建此申请")]):t._e()])])}),t._v(" "),a("div",{staticStyle:{width:"100%"},attrs:{slot:"reference"},slot:"reference"},[5==e.examineStatus||4==e.examineStatus?a("span",{staticClass:"examine_po"},[a("img",{staticClass:"examine_img",attrs:{src:e.headPortrait,width:"50",height:"50"}})]):t._e(),t._v(" "),2==e.stepType?a("span",{staticClass:"examine_po1"},[a("img",{staticClass:"examine_img",class:{mohu:1!==e.examineStatus},attrs:{src:e.headPortrait,width:"50",height:"50"}})]):t._e(),t._v(" "),3==e.stepType?a("div",{staticStyle:{display:"inline-block",margin:"0 15px"},style:e.type_style},t._l(e.userList,function(t,e){return a("span",{key:e,staticClass:"examine_po2"},[a("img",{staticClass:"examine_img",class:{mohu:0==t.examineStatus},attrs:{src:t.headPortrait,width:"50",height:"50"}})])})):t._e(),t._v(" "),a("br"),t._v(" "),e.examineUserName?a("span",{staticClass:"examine_type"},[t._v(t._s(e.examineUserName))]):t._e(),t._v(" "),2==e.stepType?a("span",{staticClass:"examine_type"},[t._v(t._s(e.userLength+"人或签"))]):t._e(),t._v(" "),3==e.stepType?a("span",{staticClass:"examine_type"},[t._v(t._s(e.userLength+"人会签"))]):t._e(),t._v(" "),a("br"),t._v(" "),0==e.examineStatus&&1==s?a("span",{staticClass:"examine_status"},[t._v("一级审核")]):t._e(),t._v(" "),0==e.examineStatus&&2==s?a("span",{staticClass:"examine_status"},[t._v("二级审核")]):t._e(),t._v(" "),0==e.examineStatus&&3==s?a("span",{staticClass:"examine_status"},[t._v("三级审核")]):t._e(),t._v(" "),0==e.examineStatus&&4==s?a("span",{staticClass:"examine_status"},[t._v("四级审核")]):t._e(),t._v(" "),0==e.examineStatus&&5==s?a("span",{staticClass:"examine_status"},[t._v("五级审核")]):t._e(),t._v(" "),0==e.examineStatus&&6==s?a("span",{staticClass:"examine_status"},[t._v("六级审核")]):t._e(),t._v(" "),1==e.examineStatus?a("span",{staticClass:"examine_status"},[a("i",{staticClass:"el-icon-success",staticStyle:{color:"#67c23a","font-size":"15px"}}),t._v(" 已审核")]):t._e(),t._v(" "),2==e.examineStatus?a("span",{staticClass:"examine_status"},[a("i",{staticClass:"el-icon-circle-close",staticStyle:{color:"#f56c6c","font-size":"18px"}}),t._v(" 未通过")]):t._e(),t._v(" "),3==e.examineStatus?a("span",{staticClass:"examine_status"},[a("i",{staticClass:"el-icon-time",staticStyle:{color:"#e6a23c","font-size":"18px"}}),t._v(" 审核中")]):t._e(),t._v(" "),5==e.examineStatus?a("span",{staticClass:"examine_status"},[a("i",{staticClass:"el-icon-circle-plus",staticStyle:{color:"#67c23a","font-size":"18px"}}),t._v(" 发起")]):t._e()])],2),t._v(" "),s!==t.examineList.length-1?a("span",{staticClass:"examine_next"},[a("i",{staticClass:"el-icon-arrow-right"})]):t._e()],1)}))])])],1),t._v(" "),a("div",{staticClass:"bottom"},[a("el-tabs",{attrs:{type:"card"},model:{value:t.activeName2,callback:function(e){t.activeName2=e},expression:"activeName2"}},[a("el-tab-pane",{attrs:{label:"回款信息",name:"first"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.thisMoneyBack,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"期数","header-align":"center",fixed:"",align:"center",prop:"periodsnum",width:"90"}}),t._v(" "),a("el-table-column",{attrs:{label:"客户名称","min-width":"200",prop:"customerName"}}),t._v(" "),a("el-table-column",{attrs:{label:"合同编号","min-width":"150",prop:"contract_number"}}),t._v(" "),a("el-table-column",{attrs:{label:"回款阶段","min-width":"110",prop:"back_plan"}}),t._v(" "),a("el-table-column",{attrs:{label:"回款金额","min-width":"110",prop:"price"}}),t._v(" "),a("el-table-column",{attrs:{label:"回款日期","min-width":"110",prop:"createTime"}}),t._v(" "),a("el-table-column",{attrs:{label:"备注","min-width":"110",prop:"remarks"}})],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"已回款信息",name:"second"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.moneyBackLists,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"期数","header-align":"center",fixed:"",align:"center",type:"index",width:"90"}}),t._v(" "),a("el-table-column",{attrs:{label:"客户名称","min-width":"200",prop:"customerName"}}),t._v(" "),a("el-table-column",{attrs:{label:"合同编号","min-width":"150",prop:"contract_number"}}),t._v(" "),a("el-table-column",{attrs:{label:"回款阶段","min-width":"110",prop:"back_plan"}}),t._v(" "),a("el-table-column",{attrs:{label:"回款金额","min-width":"110",prop:"price"}}),t._v(" "),a("el-table-column",{attrs:{label:"回款日期","min-width":"110",prop:"createTime"}}),t._v(" "),a("el-table-column",{attrs:{label:"备注","min-width":"110",prop:"remarks"}})],1)],1)],1)],1)]),t._v(" "),a("el-col",{staticClass:"right",staticStyle:{padding:"10px","min-height":"635px"},attrs:{span:6}},[a("div",{staticClass:"searchList",staticStyle:{width:"100%"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入回款单号"},on:{input:t.search},model:{value:t.searchList.keyword,callback:function(e){t.$set(t.searchList,"keyword",e)},expression:"searchList.keyword"}}),t._v(" "),a("el-button",{attrs:{icon:"el-icon-search",type:"primary",size:"mini"},on:{click:function(e){t.search()}}})],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{label:"回款单号",prop:"backNo"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{on:{click:function(a){t.getRow(e.$index,e.row)}}},[t._v("\n                    "+t._s(e.row.backNo)+"\n                ")])]}}])})],1),t._v(" "),a("div",{staticClass:"block numberPage number"},[a("el-pagination",{attrs:{"current-page":t.page,"page-sizes":[20,30,50,100],"page-size":20,layout:"total, sizes, prev, next",total:t.tableNumber},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"审核意见",visible:t.dialogVisible2,"close-on-click-modal":!1,width:"40%"},on:{"update:visible":function(e){t.dialogVisible2=e}}},[a("el-form",{ref:"exaform",attrs:{model:t.exaform,rules:t.rules}},[a("el-form-item",{attrs:{prop:"remarks"}},[a("el-input",{attrs:{type:"textarea",rows:"5",placeholder:"请输入审核意见（必填）"},model:{value:t.exaform.remarks,callback:function(e){t.$set(t.exaform,"remarks",e)},expression:"exaform.remarks"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible2=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.toexamine()}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(c,o,!1,function(t){a("MNxq")},null,null);e.default=d.exports}});